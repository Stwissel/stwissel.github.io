<!DOCTYPE html>
<html lang="en">
<head>
<title>Development Containers - the fine print - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Development Containers - the fine print" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2024/05/devcontainers-the-fine-print.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Development Containers - the fine print" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Development Containers - the fine print - Development Containers are supposed to liberate your development environment from a specific local installation, like container technology liberated your runtimes (a.k.a YAMLed them into Docker or Kubernetes). Development !&#61; Runtime Containerization for development has some overlap and quite some di" />
<meta name="Keywords"
	content="Container,Docker,Java,NodeJS,WebDevelopment," />
<meta name="Abstract"
	content="Development Containers - the fine print - Development Containers are supposed to liberate your development environment from a specific local installation, like container technology liberated your runtimes (a.k.a YAMLed them into Docker or Kubernetes). Development !&#61; Runtime Containerization for development has some overlap and quite some di" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2024/">2024</a> <span class="divider">/</span></li>
  <li><a href="/blog/2024/05/">May</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/container.html">Container</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/docker.html">Docker</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/java.html">Java</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/nodejs.html">NodeJS</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2024/04/maven-build-with-multiple-java-versions.html"><i class="icon-hand-left"></i>Maven build with multiple Java versions</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2024/06/nosql-schema-design.html">NoSQL schema design<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Development Containers - the fine print</small></h1>
					<hr />
					<div><p><a href="https://containers.dev/">Development Containers</a> are supposed to liberate your development environment from a specific local installation, like <a href="https://opencontainers.org/">container technology</a> liberated your runtimes (a.k.a <a href="https://yaml.org/">YAML</a>ed them into <a href="https://www.docker.com/">Docker</a> or <a href="https://kubernetes.io/">Kubernetes</a>).</p>
<p><img src="/blog/images/2024/MustUseHelmchart.png" alt="Helmchart Pun"></p>
<h3>Development != Runtime</h3>
<p>Containerization for development has some overlap and quite some difference to containerization for production:</p>
<table>
 <thead>
  <tr>
   <th>Topic</th>
   <th>Development</th>
   <th>Production</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>Mutability</td>
   <td>You alter container content</td>
   <td>Container is static</td>
  </tr>
  <tr>
   <td>Network</td>
   <td>Use internal network</td>
   <td>Use internal network</td>
  </tr>
  <tr>
   <td>Access</td>
   <td>Developer tools++</td>
   <td>Browser / App</td>
  </tr>
  <tr>
   <td>Containers</td>
   <td>multiple</td>
   <td>multiple</td>
  </tr>
  <tr>
   <td>Volumes</td>
   <td>primary container binds projectdir<br>
    all others <strong>mount</strong> only</td>
   <td>all: bind or mount</td>
  </tr>
  <tr>
   <td>Configuration</td>
   <td><code>devcontainer.json</code>, <code>docker-compose.yml</code></td>
   <td><code>docker-compose.yml</code>,<code>Helm Chart</code></td>
  </tr>
  <tr>
   <td>Scope</td>
   <td>Runtime &amp; Tooling</td>
   <td>Runtime</td>
  </tr>
  <tr>
   <td>Dockerfile</td>
   <td>Setup development environment</td>
   <td>Configure production</td>
  </tr>
 </tbody>
</table>
<h3>Insights</h3>
<ul>
 <li>There are many <a href="https://containers.dev/overview">getting started</a> resources available: <a href="https://code.visualstudio.com/docs/devcontainers/containers">here</a>, <a href="https://code.visualstudio.com/docs/devcontainers/tutorial">here</a>, <a href="https://www.jetbrains.com/help/idea/connect-to-devcontainer.html">here</a>, <a href="https://www.google.com/search?q=devcontainer+tutorial">here</a> and <a href="https://github.com/0916dhkim/vscode-devcontainer-tutorial">here</a>. They are working examples, commonly strong on what and how, but light on why</li>
 <li>There are <a href="https://containers.dev/templates">plenty of templates</a> to learn by example</li>
 <li>There seem to be substantial differences how it works on different platforms, subtle and annoying</li>
 <li>On macOS (14.4.1) with with the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.remote-containers">devcontainer plugin</a> 0.364.0 mount binds would not work in auxiliary containers, only in the main app</li>
 <li>I couldn't find any descrption which subset of <a href="https://compose-spec.io"><code>docker-compose.yml</code></a> is supported</li>
 <li>The most interesting templates, for now, live on the <a href="https://mcr.microsoft.com/en-us/">Microsoft Artifact Registry</a>, when you know <a href="https://mcr.microsoft.com/en-us/catalog?search=Container%20Images">how to look</a>. Starting with those saves you tons of time and frustration</li>
 <li>You will love <code>code --list-extensions</code> to figure out the extensions you have in your vscode (unless you are a code n00b and don't have any)</li>
</ul><h2>A practical example</h2>
<p>You need some kind of <a href="https://www.docker.com/products/docker-desktop/">Docker</a>, <a href="https://rancherdesktop.io">Rancher</a> or <a href="https://podman-desktop.io">Podman</a> Desktop, <a href="https://code.visualstudio.com">Visual Studio Code</a> and the <a href="https://marketplace.visualstudio.com/items?itemName=ms-vscode-remote.vscode-remote-extensionpack">Remote Development Extension Pack</a>. You know how to install all this.</p>
<h3>Planning</h3>
<p>We need to configure the environment, to make it more ~~powerfull~~ confusing, you can add:</p>
<ul>
 <li>items in the <code>Dockerfile</code></li>
 <li>settings in <code>docker-compose</code> including <code>.env</code> files</li>
 <li>Container <a href="https://containers.dev/features">features</a></li>
 <li>Scripts <a href="https://containers.dev/implementors/spec/">to run</a></li>
 <li>VSCode <a href="https://containers.dev/supporting#visual-studio-code">plugins and settings</a></li>
</ul>
<p>So we have a few places where e.g. <code>npm install</code> could live, or tooling.</p>
<p>We will setup a <code>Dockerfile</code>, a <code>docker-compose.yml</code> and the <code>devcontainer.json</code>, all three located in <code>.devcontainer</code>. Make sure to add this to git, it's kind of the point to share this setup with others, including your future self. Devcontainers are <a href="https://en.wikipedia.org/wiki/Infrastructure_as_code">infrastructure as code</a> for developers. So besides your code and servers, you have your tooling and settings in one place. Let's start with the simple one:</p>
<h3>Dockerfile</h3>
<pre><code class="language-docker">FROM mcr.microsoft.com/devcontainers/javascript-node:dev-20-bookworm
RUN su node -c "npm install -g npm-check-updates nodemon vite"
</code></pre>
<h3>docker-compose.yml</h3>
<p>In the example we have one service (our code)and one NoSQL database.</p>
<pre><code class="language-yaml">services:
  app:
    container_name: nodejs
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ../..:/workspaces:cached
    volumes_from:
      - couchdb:rw
    command: sleep infinity
    network_mode: service:couchdb
    depends_on:
      - couchdb
  couchdb:
    image: couchdb:latest
    container_name: couchdb
    environment:
      COUCHDB_USER: admin
      COUCHDB_PASSWORD: password
    volumes:
      - type: volume
        source: couchdb_etc
        target: /opt/couchdb/etc
      - type: volume
        source: couchdb_data
        target: /opt/couchdb/data
      - type: volume
        source: couchdb_logs
        target: /opt/couchdb/logs
    restart: unless-stopped
volumes:
  couchdb_data:
  couchdb_etc:
  couchdb_logs:
</code></pre>
<ul>
 <li>the volume syntax is <code>../..:/workspaces:cached</code> to mount the workspace</li>
 <li><code>volumes_from</code> is used to get easy access to the couchDB inin configuration</li>
 <li><code>command: sleep infinity</code> is necessary to prevent the container from exiting</li>
 <li><code>network_mode</code> enforces one network setting. To reach it from the outside, you need and entry in devcontainer.json</li>
</ul>
<h3>devcontainer.json</h3>
<pre><code class="language-json">{
  "name": "Node.js &amp; couch",
  "dockerComposeFile": "docker-compose.yml",
  "service": "app",
  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",
  "features" : {
    "ghcr.io/devcontainers/features/common-utils:2" : {},
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers/features/sshd:1": {}
  },
  "postCreateCommand": "yarn install",
  "customizations": {
    "vscode": {
      "extensions": [
        "esbenp.prettier-vscode",
        "msjsdiag.debugger-for-chrome",
        "oderwat.indent-rainbow",
        "visualstudioexptteam.vscodeintellicode",
        "ritwickdey.liveserver",
        "shengchen.vscode-checkstyle",
        "sketchbuch.vsc-quokka-statusbar"
        "WallabyJs.quokka-vscode",
        "WallabyJs.wallaby-vscode"
      ]
    }
  },
  "forwardPorts": [3000, 5984]
}
</code></pre>
<p>In a future post, I'll cover a setup with more than one application / service.</p>
<p>As usual YMMV</p></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 12 May 2024
<span class="divider">|</span>
<a href="/blog/2024/05/devcontainers-the-fine-print.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/container.html">Container</a>  <a href="/blog/categories/docker.html">Docker</a>  <a href="/blog/categories/java.html">Java</a>  <a href="/blog/categories/nodejs.html">NodeJS</a>  <a href="/blog/categories/webdevelopment.html">WebDevelopment</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2024/05/devcontainers-the-fine-print.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_99f119a0-0b87-11ef-b8a5-450dafcfe327" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_99f119a0-0b87-11ef-b8a5-450dafcfe327"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2024/04/maven-build-with-multiple-java-versions.html"><i class="icon-hand-left"></i>Maven build with multiple Java versions</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2024/06/nosql-schema-design.html">NoSQL schema design<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2024/">2024</a> <span class="divider">/</span></li>
  <li><a href="/blog/2024/05/">May</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/container.html">Container</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/docker.html">Docker</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/java.html">Java</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/nodejs.html">NodeJS</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="https://www.stickermule.com/u/43c09fe6343315f">Stickers from Stickermule</a></li>
						<li><a href="https://github.com/Stwissel">GitHub</a></li>
						<li><a href="https://bitbucket.org/stwissel/">Bitbucket</a></li>
						<li><a href="https://bsky.app/profile/stwissel.bsky.social">Bluesky</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2025 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2024/05/devcontainers-the-fine-print.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "99f119a0-0b87-11ef-b8a5-450dafcfe327");
 		};
	</script>

</body>
</html>
