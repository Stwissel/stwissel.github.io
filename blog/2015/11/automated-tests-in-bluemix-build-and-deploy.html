<!DOCTYPE html>
<html lang="en">
<head>
<title>Automated Tests in Bluemix Build and Deploy - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Automated Tests in Bluemix Build and Deploy" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2015/11/automated-tests-in-bluemix-build-and-deploy.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Automated Tests in Bluemix Build and Deploy" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2015,2019 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Automated Tests in Bluemix Build and Deploy - Bluemix is a beautiful environment for agile software development. Its build and deploy capability ensure continious delivery, so you can focus on code. A well run project requires automatic testing (starting with unit tests up to integration testing). You can configure this in the Build and Deploy " />
<meta name="Keywords"
	content="Bluemix," />
<meta name="Abstract"
	content="Automated Tests in Bluemix Build and Deploy - Bluemix is a beautiful environment for agile software development. Its build and deploy capability ensure continious delivery, so you can focus on code. A well run project requires automatic testing (starting with unit tests up to integration testing). You can configure this in the Build and Deploy " />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <script> 
var $buoop = {notify:{e:-0.01,f:-0.01,o:-0.01,s:-0.01,c:-0.01},insecure:true,unsupported:true,api:5}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.min.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script>

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2015/">2015</a> <span class="divider">/</span></li>
  <li><a href="/blog/2015/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/bluemix.html">Bluemix</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2015/11/its-just-html-css-and-javascript-isnt-it.html"><i class="icon-hand-left"></i>It&apos;s just HTML, CSS and JavaScript isn&apos;t it?</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2015/12/mail-archive-with-apache-couchdb-ibm-cloudant-part-1.html">Mail archive with Apache CouchDB / IBM Cloudant - Part 1<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Automated Tests in Bluemix Build and Deploy</small></h1>
					<hr />
					<div>Bluemix is a beautiful environment for 
<a href="http://www.agilemanifesto.org/">agile software development</a>. Its 
<a href="https://hub.jazz.net/docs/deploy/">build and deploy</a> capability ensure continious delivery, so you can focus on code. A well run project requires automatic 
<a href="https://en.wikipedia.org/wiki/Software_testing">testing</a> (starting with 
<a href="https://en.wikipedia.org/wiki/Unit_testing">unit tests</a> up to 
<a href="https://en.wikipedia.org/wiki/Integration_testing">integration testing</a>). 
<br> You can configure this in the 
<i>Build and Deploy</i> pipeline, so your project looks like this: 
<br> 
<img src="/blog/images/2015/FullSuccessFullPipe.png" border="0" alt="A fully working pipeline"> 
<br> While you could argue: " 
<i>I run my tests local</i>", you might encounter the situation where you use the online editor and you then depend on the tests running in Bluemix. Setting up build and deploy is 
<a href="https://hub.jazz.net/docs/deploy/">well documented</a> and straight forward. 
<p style="margin : 5px; padding : 5px; border : 1px solid red"><b>Tip</b>: For Java projects you should use Maven or Gradle build, so your library dependencies are properly resolved. For Node.js projects a "simple" build would suffice, however using <code>npm install</code> would make the stage fail if your <code>package.json</code> has an issue, so you don't run later stages and fail there</p> However the documentation for the test stage simply states: " 
<i>If you want to require that certain conditions are met, include test jobs before or after your build and deploy jobs. Test jobs are highly customizable. For example, you might run tests on your project code and a deployed instance of your app. </i>". That's a little " 
<i>thin</i>". 
<br> Inspecting the test job screen itself, we can learn that we have different testing options 
<br> 
<img src="/blog/images/2015/TestOptions.png" border="0" alt="Choices for testing"> 
<br> I specifically like the 
<a href="https://saucelabs.com/">Sauce labs</a> integration and the ability to run a code, security and vulnerability scan (So a real pipeline might have up to 4 distinct test stages). However the screen for "simple" tests, where unit tests go, isn't particularily helpful: 
<br> 
<img src="/blog/images/2015/EmptyTestOptions.png" border="0" alt="The helpful test screen"> 
<br> So lets shed some light on the inner workings.A test job can include a test report (including notifying SLACK, but that's a story for another time). This report needs to be in XML format, indicated in the default test results pattern. Old dogs will smell rat and conclude: ahhhh 
<a href="http://junit.org/">JUnit</a>. And as a fact of the matter, JUnit report format is what Build &amp; Deploy will process into a nice test result: 
<br> 
<img src="/blog/images/2015/TestReports.png" border="0" alt="Test Reports"> 
<br> Running a JUnit test when you have a Java application is therefore quite simple. For front-end or Node.js applications its a little trickier, since you have 
<a href="http://unitjs.com/">plenty of choices</a>. 
<br> Here is what I found when creating a test for an Ionic/Angular based front-end with an Node.js based backend: 
<ul> 
 <li>The test stage uses the artifacts from build (or the version control). So anything in <code>node_modules</code> or <code>bower_components</code> won't be available yet. Hence you need to run <code>npm install</code> and if you used <a href="http://bower.io/">bower</a>, <code>bower install</code> (for full syntax see below). Bower would need to be listed as dev-dependency in the package.json file. Only with those steps you will be able to run any tests</li> 
 <li>The output directory for your tests must exist, so add <code>mkdir tests</code> to the script</li> 
 <li>You must specify your choosen test framework in the <code>package.json</code> file as dev-dependency. Don't forget to also list all dependencies of your choosen test framework</li> 
 <li>You could specify the tests to run in the scripts section of the package.json or on the command line. In both cases you need to include the path pointing to the node_modules directory</li> 
 <li>You can run multiple tests with different frameworks, just add another line in the script. Only make sure they don't overwrite each other report results</li> 
 <li>To get <a href="https://mochajs.org/">Mocha</a> to output JUnit format you call it with a reports parameter:<br><code>mocha -R xunit &gt; test/TEST-MochaResult.xml</code>. Mocha is well suited for node.js testing and to some extend for angular.js too</li> 
 <li>Using <a href="http://karma-runner.github.io/">Karma</a> requires a report <a href="https://github.com/karma-runner/karma-junit-reporter">karma-junit-reporter plugin</a>, that you need to list in the <code>package.json</code> file. Then you can call it using<br><code>karma start --reporters junit</code></li> 
 <li>Angular's dependency injection approach makes testing a breeze - once you figured it out. I found the least stressful way (a.k.a the one I got to work) was to use <a href="http://karma-runner.github.io/">Karma</a> which provides all the mock injection mechanism I needed.<br> <a href="http://karma-runner.github.io/">Karma</a> allows you to use your favorite test framework for the test description: <a href="http://jasmine.github.io/">Jasmine</a>, <a href="http://mochajs.org/">Mocha</a> or <a href="http://qunitjs.com/">QUnit</a>. How to use those is a story for another time (if you can't wait, <a href="https://docs.angularjs.org/guide/unit-testing">start here</a> for the official documentation or check <a href="http://mcgivery.com/unit-testing-ionic-app/">this tutorial</a>)</li> 
 <li>Testing a front-end application requires a browser. On a desktop machine or in <a href="https://saucelabs.com/">Sauce labs</a>, the tool of choice is <a href="http://www.seleniumhq.org/">Selenium</a>, which launches clean instances of Chrome, IE or Safari (even <a href="https://msdn.microsoft.com/en-us/library/mt188085%28v=vs.85%29.aspx">MS Edge</a>). Your build server has none of them installed (or even a gui shell where they would run), so you need to specify <a href="http://phantomjs.org/">phantom.js</a> as your browser. Test results hence might vary</li> 
</ul> A sample test script as entered into the test job: 
<br> 
<pre class="brush: bash">
#!/bin/bash
npm install
./node_modules/.bin/bower install
mkdir tests
./node_modules/.bin/mocha --reporter xunit &gt; tests/TEST-MochaResults.xml
./node_modules/.bin/karma start --reporters junit
</pre> 
<br> Configuring and coding the various tests is a story for another time. As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 26 November 2015
<span class="divider">|</span>
<a href="/blog/2015/11/automated-tests-in-bluemix-build-and-deploy.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/bluemix.html">Bluemix</a> 

						<div class="shariff" data-lang="en" data-url="https://www.wissel.net/blog/2015/11/automated-tests-in-bluemix-build-and-deploy.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]" data-title="Automated Tests in Bluemix Build and Deploy" data-twitter-via="@notessensei"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2015/11/automated-tests-in-bluemix-build-and-deploy.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_ECC3A5D98C37712148257F09000EFD37" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_ECC3A5D98C37712148257F09000EFD37"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2015/11/its-just-html-css-and-javascript-isnt-it.html"><i class="icon-hand-left"></i>It&apos;s just HTML, CSS and JavaScript isn&apos;t it?</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2015/12/mail-archive-with-apache-couchdb-ibm-cloudant-part-1.html">Mail archive with Apache CouchDB / IBM Cloudant - Part 1<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2015/">2015</a> <span class="divider">/</span></li>
  <li><a href="/blog/2015/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/bluemix.html">Bluemix</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2020 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2015/11/automated-tests-in-bluemix-build-and-deploy.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "ECC3A5D98C37712148257F09000EFD37");
 		};
	</script>

</body>
</html>
