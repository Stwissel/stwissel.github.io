<!DOCTYPE html>
<html lang="en">
<head>
<title>Hyperlinks need to live forever - Blog edition - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Hyperlinks need to live forever - Blog edition" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2012/12/hyperlinks-need-to-live-forever-blog-edition.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Hyperlinks need to live forever - Blog edition" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Hyperlinks need to live forever - Blog edition - THE bummer mistake in any web revamp is a total disregard for page addresses. The maximum to be found is a nice 404 page with a notice that things have been revamped and the invitation to search. What a waste of human time and disregard for a site&#39;s users! The links to the original page live outside" />
<meta name="Keywords"
	content="Blog,Software,WebDevelopment," />
<meta name="Abstract"
	content="Hyperlinks need to live forever - Blog edition - THE bummer mistake in any web revamp is a total disregard for page addresses. The maximum to be found is a nice 404 page with a notice that things have been revamped and the invitation to search. What a waste of human time and disregard for a site&#39;s users! The links to the original page live outside" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/blog.html">Blog</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-92P7K9" title="originally published at /blog/d6plinks/SHWL-92P7K9">SHWL-92P7K9</a>
	</li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/12/whiteboard-selling.html"><i class="icon-hand-left"></i>Whiteboard Selling</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/12/graceful-degradation.html">Graceful degradation<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Hyperlinks need to live forever - Blog edition</small></h1>
					<hr />
					<div><b>THE</b> bummer mistake in any web revamp is a total disregard for page addresses. The maximum to be found is a nice <a href="http://queenofsubtle.com/404/">404</a> page with a notice that things have been revamped and the invitation to search. What a waste of human time and disregard for a site's users! 
<br>
 The links to the original page live outside the sites control and <a href="http://www.useit.com/jakob/">Jacob</a> already stated in 1998 <a href="http://www.useit.com/alertbox/981129.html">Pages need to live forever</a>. So what could you do when <a href="http://geldred.com/2012/12/04/and-so-here-we-are/">swapping blog platforms</a>? 
<br>
 If your new platform runs behind an <a href="http://httpd.apache.org/">Apache HTTP</a> server (also known as <a href="http://www-01.ibm.com/software/webservers/httpservers/">IHS</a>), there is <a href="http://httpd.apache.org/docs/current/mod/mod_rewrite.html">mod_rewrite</a> that allows you to alter incoming addresses (the old links) into the new destinations based on a pattern match ( <a href="http://www.amazon.com/gp/product/1849510865/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=1849510865&amp;linkCode=as2&amp;tag=wissenetblog-20">other http servers</a> <img src="https://www.assoc-amazon.com/e/ir?t=wissenetblog-20&amp;l=as2&amp;o=1&amp;a=1849510865" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;"> have similar functions, but that's a story for another time). 
<br>
 HTTP knows 2 redirection codes: 
<ul>
 <li><a href="http://en.wikipedia.org/wiki/HTTP_302">302</a> for temporary redirections</li>
 <li><a href="http://en.wikipedia.org/wiki/HTTP_301">301</a> for permanent ones.</li>
</ul> You want to use the later, so at least the search engines update their links. 
<br>
 Now your new URL pattern most likely uses a different structure than the old one, so a simple <a href="http://en.wikipedia.org/wiki/Regex">Regex</a> might not help for that transition. E.g. your existing format might be <code>/myblog.nsf/d6plinks/ABCDEF</code> while the new pattern would be <code>/blog/2001/10/is-this-on.html</code>. 
<br>
 For this case mod_rewrite provides the <a href="http://httpd.apache.org/docs/current/mod/mod_rewrite.html#RewriteMap">RewriteMap</a> where you can use your old value (ABCDEF in our case) to find the new URL. Unfortunately mod_rewrite is very close to dark magic. It can be simple from a key/value lookup up to invoking an external program to get the result. For the key/value lookup you need make your key case insensitive, so all the possible case variations work. This is what I figured out: 
<br>
<pre>RewriteEngine on
RewriteMap lowercase int:tolower
RewriteMap blog-map dbm:/var/www/blogmap.map
RewriteRule ^/myblog.nsf/d6plinks/(.*) /blog/${blog-map:${lowercase:$1}} [NC,R=301,L]</pre> Let me pick that into pieces for you: 
<ol>
 <li><b>RewriteEngine on</b><br>
   This switches the rewrite engine on. It requires that mod_rewrite is loaded (check your documentation for that)</li>
 <li><b>RewriteMap lowercase int:tolower</b><br>
   This enabled an internal conversion of the incoming string into its lower case format</li>
 <li><b>RewriteMap blog-map dbm:/var/www/blogmap.map</b><br>
   This defines the actual lookup. The simplest case would be a text file with the key and result in one line separated by a space. However that might not perform well enough for larger numbers of links, so I choose a indexed table format. It is very easy to create, since the tool is included in the Apache install. I generated my translation list as text file and then invoked <code>httxt2dbm -v -i /var/www/blogmap.txt -o /var/www/blogmap.map</code> and the indexed file is created/updated</li>
 <li><b style="color : red">RewriteRule ^/myblog.nsf/d6plinks/(.*) /blog/${blog-map:${lowercase:$1}} [NC,R=301,L]</b><br>
   This is the rewrite rule with a nested set of parameters that first converts the key to lower case and then looks up the new URL. If a key isn't found it redirects to <code>/blog/</code> which suits my needs, you might want to handle things different.<br>
   In detail: 
  <ol>
   <li><b>^/myblog.nsf/d6plinks/(.*)</b> matches all links inside the d6plinks, the () "captures" ABCEDF (from our example), so it can be used in $1</li>
   <li><b>${lowercase:$1}</b> converts ABCDEF into abcdef</li>
   <li><b>${blog-map: ... }</b> finally looks it up in the map file</li>
   <li><b>[NC,R=301,L]</b> are the switched governing the execution of the rewrite rule: 
    <ul>
     <li><b>NC</b> stands for <i>NoCase</i>. It allow to match /MyBlog.nsf/ /MYBLOG.NSF/ /myblog.NSF/ etc. It doesn't however convert the string</li>
     <li><b>R=<a href="http://en.wikipedia.org/wiki/HTTP_301">301</a></b> issues a permanent redirect response (default is 302, temporary)</li>
     <li><b>L</b> stops the evaluation of further redirection rules</li>
    </ul></li>
  </ol></li>
</ol> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 05 December 2012
<span class="divider">|</span>
<a href="/blog/2012/12/hyperlinks-need-to-live-forever-blog-edition.html#comments">Comments (4)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/blog.html">Blog</a>  <a href="/blog/categories/software.html">Software</a>  <a href="/blog/categories/webdevelopment.html">WebDevelopment</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2012/12/hyperlinks-need-to-live-forever-blog-edition.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_239F5619250FD2E148257ACB0019F5BD" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_239F5619250FD2E148257ACB0019F5BD"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>David Schaffer</b> on <i>Wednesday 05 December 2012 AD</i>:<br /> 
  Thanks for the nice tutorial on the rewrite rules. However, if a site is heavily reorganized there's often not much you can do with pattern matching. Sometimes you need individual redirects for the most popular pages and a good site map for the rest.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Thursday 06 December 2012 AD</i>:<br /> 
  David, 
  <br />I respectfully disagree. All reorganisations I came across change substantially in the base path - and that is all you need. The MAP will then help you to match an arbitrary old page to the exact new page. 
  <br /> 
  <b>AND</b> the preservation of the old links needs to be an integrated part of the revamp considerations. Most commonly you actually CAN identify what pages are old by using a pattern. What never works is to use a simple patterns transformation to get from old to new. But that is eaxtly the point of this blog post: once you got hold of an old page you simply look it up. 
  <br />Of course that requires the creation of the mapping table in the revamp project. Without that mapping nothing will work. 
  <br />A variation of this approach would be to alter the 404 page and lookup if there is a replacement page.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Martin Leyrer</b> on <i>Thursday 06 December 2012 AD</i>:<br /> 
  Tim Berners-Lee in 1998: Cool URIs don't change 
  <br />{ 
  <a href="http://www.w3.org/Provider/Style/URI.html" rel="nofollow" target="blank">Link</a> } 
  <br />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Martin Leyrer</b> on <i>Thursday 06 December 2012 AD</i>:<br /> 
  @David: mod_rewrite is voodoo. Damned cool voodoo, but still voodoo 
  <br /> 
  <br />Using the RewriteMap directive you could even handcraft or pre-generate subtitution tables so you do not have to only rely on regular expresions. With that you could cover the most complex sites and have no excuse to send your users to a 404 page. 
  <img alt="Emoticon wink.gif" src="/blog/images/emoticons/wink.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/12/whiteboard-selling.html"><i class="icon-hand-left"></i>Whiteboard Selling</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/12/graceful-degradation.html">Graceful degradation<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/blog.html">Blog</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-92P7K9" title="originally published at /blog/d6plinks/SHWL-92P7K9">SHWL-92P7K9</a>
	</li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="https://www.stickermule.com/u/43c09fe6343315f">Stickers from Stickermule</a></li>
						<li><a href="https://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a href="https://github.com/Stwissel">GitHub</a></li>
						<li><a href="https://bitbucket.org/stwissel/">Bitbucket</a></li>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2024 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2012/12/hyperlinks-need-to-live-forever-blog-edition.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "239F5619250FD2E148257ACB0019F5BD");
 		};
	</script>

</body>
</html>
