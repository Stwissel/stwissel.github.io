<!DOCTYPE html>
<html lang="en">
<head>
<title>Importing EML files into Notes (lots of them) - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<meta name="ROBOTS" content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title" content="NotesSensei's Weblog - Importing EML files into Notes (lots of them)" />
<meta name="Author" content="Stephan H. Wissel" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta name="description"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="Keywords"
	content="lotus,domino,quickplace,sametime,blog,template,blogging,blogger,notes,r9,verse,r8,r7,r6,r5,raven,k-station,nsf,ntf,websphere,agile,sdlc,j2ee,.net,personcentric,singapore,twins,JavaScript,vertx, nodejs" />
<meta name="Abstract"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="ICBM" content="1.2994, 103.8425" />
<meta name="Copyright"
	content="2012,2017 Stephan H. Wissel - Creative commons licence" />
<meta HTTP-EQUIV="Content-Language" content="en" />
<meta property="fb:admins" content="567103136" />
<meta property="fb:app_id" content="219323514774289">
<meta property="og:title"
	content="wissel.net - Importing EML files into Notes (lots of them)" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://wissel.net/blog" />
<meta property="og:image"
	content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="twitter:site" content="@notessensei" />
<meta name="twitter:card" content="summary" />
<meta name="xing:author"
	content="https://www.xing.com/profile/StephanH_Wissel" />

<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<!-- Masthead
		================================================== -->
		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <!--[if lt IE 10]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 11'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
<![endif]-->

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/04/">April</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/.html"></a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/04/roots-of-wisdom.html"><i class="icon-hand-left"></i>Roots of Wisdom</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/04/extracting-data-from-domino-into-pdf-using-xslt-and-xslfo-part-1.html">Extracting data from Domino into PDF using XSLT and XSL:FO (Part 1)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Importing EML files into Notes (lots of them)</small></h1>
					<hr />
					<div>My friend and Lotus Champion 
<a href="https://connections.zenithcomp.co.th/profiles/html/profileView.do?key=978e80f3-e6d1-4510-907e-051a09e4fb63&amp;lang=en_us">Weerapong Panpai</a> from 
<a href="http://www.zenithcomp.co.th">Zenith</a> in Thailand asked me " 
<i>How difficult is it to do a bulk import of <a href="http://en.wikipedia.org/wiki/MIME">eml files</a> into Lotus Notes</i>"? MIME as a format is plain ASCII, so on first look it seems simple. 
<br> However on a closer look you might guess where the author of an 
<a href="http://www.imdb.com/title/tt1375666/">outstanding movie</a> got his inspiration from. RFC 2045 
<a href="http://tools.ietf.org/html/rfc2045#section-2.5">nicely states</a>:" 
<i>NOTE: The previous four definitions are clearly circular. This is unavoidable, since the overall structure of a MIME message is indeed recursive.</i>" So trying to parse that messages on my own was clearly out of the question. Luckily there is ready code available. On one side there is JavaEE and the the 
<a href="http://docs.oracle.com/javaee/6/api/javax/mail/internet/MimeMessage.html">MimeMessage</a> and on the other 
<a href="http://james.apache.org/mime4j/">Apache James</a>. An implementation of the 
<code>javax.mail.internet</code> classes is hidden somewhere in the Notes client, so that would favour MimeMessage. However I found it easier to work with the mime4j classes. Here is what I came up with: 
<div class="java5"> 
 <span class="kw2">package</span> 
 <span class="co2">com.notessensei.mimeimport</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">java.io.IOException</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">java.io.InputStream</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">lotus.domino.Document</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">lotus.domino.NotesException</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">lotus.domino.Session</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">org.apache.james.mime4j.MimeException</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">org.apache.james.mime4j.parser.ContentHandler</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw2">import</span> 
 <span class="co2">org.apache.james.mime4j.parser.MimeStreamParser</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <br> 
 <span class="kw2">public</span> 
 <span class="kw2">class</span> Mime2Doc 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; 
 <span class="kw2">public</span> 
 <span class="kw3">void</span> importMail 
 <span class="br0">(</span>Session s, 
 <a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+InputStream"><span class="kw166">InputStream</span></a> in, 
 <a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+Document"><span class="kw166">Document</span></a> doc 
 <span class="br0">)</span> 
 <span class="kw2">throws</span> NotesException, MimeException, 
 <a href="http://java.sun.com/j2se/1%2E5%2E0/docs/api/java/io/IOException.html"><span class="kw20">IOException</span></a> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; doc. 
 <span class="me1">replaceItemValue</span> 
 <span class="br0">(</span> 
 <span class="st0">"Form"</span>, 
 <span class="st0">"Memo"</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; MimeStreamParser parser = 
 <span class="kw2">new</span> MimeStreamParser 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?sitesearch=java.sun.com&amp;q=allinurl%3Aj2se%2F1+5+0%2Fdocs%2Fapi+ContentHandler"><span class="kw166">ContentHandler</span></a> h = 
 <span class="kw2">new</span> DocContentHandler 
 <span class="br0">(</span>s, doc 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; parser. 
 <span class="me1">setContentHandler</span> 
 <span class="br0">(</span>h 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; parser. 
 <span class="me1">parse</span> 
 <span class="br0">(</span>in 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <br> 
 <span class="br0">}</span> 
</div> The bulk of the work happens inside the 
<a href="http://james.apache.org/mime4j/apidocs/org/apache/james/mime4j/parser/ContentHandler.html">ContentHandler</a>. Using a Stack (that works 
<a href="http://en.wikipedia.org/wiki/LIFO_(computing)">LIFO</a>) I can track Mime entries inside mime entries inside mime entries. Still the code is 
<a href="/blog/downloads/2012/DocContentHandler.java">just below 100 lines</a>. 
<br> The final piece in the puzzle is the class that helps to 
<a href="/blog/downloads/2012/MimePartInfo.java">track the MIME Parts</a> that are put onto the Stack and returns MIME-Type and encoding derived from the header fields. You are 
<a href="/blog/downloads/SHWL-8TMKWK">ready to test</a>.I used a directory full of eml files to test: 
<div class="java"> 
 <span class="kw1">package</span> 
 <span class="co2">com.notessensei.mimeimport</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">java.io.File</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">java.io.FileInputStream</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">java.io.FileNotFoundException</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">java.io.IOException</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">org.apache.james.mime4j.MimeException</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.Document</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.NotesException</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.NotesFactory</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.NotesThread</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.Session</span> 
 <span class="sy0">;</span> 
 <br> 
 <span class="kw1">import</span> 
 <span class="co2">lotus.domino.Database</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> 
 <span class="kw1">public</span> 
 <span class="kw1">class</span> Tester 
 <span class="br0">{</span> 
 <br> 
 <br> &nbsp; &nbsp; 
 <span class="kw1">public</span> 
 <span class="kw1">static</span> 
 <span class="kw4">void</span> main 
 <span class="br0">(</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> 
 <span class="br0">[</span> 
 <span class="br0">]</span> args 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="co1">// Change these for your own test</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">final</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> WORKDIR 
 <span class="sy0">=</span> 
 <span class="st0">"/home/user/testingmime/"</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">final</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> EXTENSION 
 <span class="sy0">=</span> 
 <span class="st0">".eml"</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">final</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> DBNAME 
 <span class="sy0">=</span> 
 <span class="st0">"testmail.nsf"</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">final</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> SERVER 
 <span class="sy0">=</span> 
 <span class="st0">""</span> 
 <span class="sy0">;</span> 
 <br> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; NotesThread. 
 <span class="me1">sinitThread</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">try</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Session s 
 <span class="sy0">=</span> NotesFactory. 
 <span class="me1">createSession</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Database db 
 <span class="sy0">=</span> s. 
 <span class="me1">getDatabase</span> 
 <span class="br0">(</span>SERVER, DBNAME 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a> folder 
 <span class="sy0">=</span> 
 <span class="kw1">new</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a> 
 <span class="br0">(</span>WORKDIR 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a> 
 <span class="br0">[</span> 
 <span class="br0">]</span> tobeImported 
 <span class="sy0">=</span> folder. 
 <span class="me1">listFiles</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Mime2Doc md 
 <span class="sy0">=</span> 
 <span class="kw1">new</span> Mime2Doc 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">for</span> 
 <span class="br0">(</span> 
 <span class="kw4">int</span> i 
 <span class="sy0">=</span> 
 <span class="nu0">0</span> 
 <span class="sy0">;</span> i 
 <span class="sy0">&lt;</span> tobeImported. 
 <span class="me1">length</span> 
 <span class="sy0">;</span> i 
 <span class="sy0">++</span> 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afile+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">File</span></a> f 
 <span class="sy0">=</span> tobeImported 
 <span class="br0">[</span>i 
 <span class="br0">]</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">if</span> 
 <span class="br0">(</span>f. 
 <span class="me1">isFile</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">&amp;&amp;</span> f. 
 <span class="me1">getName</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span>. 
 <span class="me1">endsWith</span> 
 <span class="br0">(</span>EXTENSION 
 <span class="br0">)</span> 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>. 
 <span class="me1">out</span>. 
 <span class="me1">println</span> 
 <span class="br0">(</span> 
 <span class="st0">"File: "</span> 
 <span class="sy0">+</span>f. 
 <span class="me1">getName</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocument+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Document</span></a> doc 
 <span class="sy0">=</span> db. 
 <span class="me1">createDocument</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afileinputstream+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">FileInputStream</span></a> in 
 <span class="sy0">=</span> 
 <span class="kw1">new</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afileinputstream+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">FileInputStream</span></a> 
 <span class="br0">(</span>f 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; md. 
 <span class="me1">importMail</span> 
 <span class="br0">(</span>s,in, doc 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; doc. 
 <span class="me1">recycle</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Asystem+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">System</span></a>. 
 <span class="me1">out</span>. 
 <span class="me1">println</span> 
 <span class="br0">(</span> 
 <span class="st0">"--- DONE ---"</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="co1">// Cleanup</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db. 
 <span class="me1">recycle</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <span class="kw1">catch</span> 
 <span class="br0">(</span>NotesException e 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e. 
 <span class="me1">printStackTrace</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <span class="kw1">catch</span> 
 <span class="br0">(</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Afilenotfoundexception+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">FileNotFoundException</span></a> e 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e. 
 <span class="me1">printStackTrace</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <span class="kw1">catch</span> 
 <span class="br0">(</span>MimeException e 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e. 
 <span class="me1">printStackTrace</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <span class="kw1">catch</span> 
 <span class="br0">(</span> 
 <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Aioexception+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">IOException</span></a> e 
 <span class="br0">)</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; e. 
 <span class="me1">printStackTrace</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <span class="kw1">finally</span> 
 <span class="br0">{</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NotesThread. 
 <span class="me1">stermThread</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <span class="sy0">;</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <br> &nbsp; &nbsp; 
 <span class="br0">}</span> 
 <br> 
 <span class="br0">}</span> 
</div> As usual: YMMV!</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 2012-04-23 10:01
<span class="divider">|</span>
<a href="/blog/2012/04/importing-eml-files-into-notes-lots-of-them.html#comments">Comments (11)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a> 

						<div class="shariff" data-lang="en" data-url="https://www.notessensei.com/blog/2012/04/importing-eml-files-into-notes-lots-of-them.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-title="Importing EML files into Notes (lots of them)"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2012/04/importing-eml-files-into-notes-lots-of-them.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_C66C3377B8E3257C482579E9004D05CF" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_C66C3377B8E3257C482579E9004D05CF"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
<img src="//www.gravatar.com/avatar/3f9419177fce54aaf9cc6e04c6dc1097.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Martin Durao</b> on <i>Wednesday 29 August 2012 AD - 18:36 Coordinated Universal Time</i>:<br /> 
  Hi Stephan 
  <br /> 
  <br />Great solution!!! 
  <br />The only drawback is in my case all EML docs are imported in Sent folder... 
  <br />I tried setting db view but without success. 
  <br />Do you know if could be some way to select the view/folder where import docs? 
  <br /> 
  <br />Thanks for your post! 
  <br />Martin
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Thursday 30 August 2012 AD - 10:33 Coordinated Universal Time</i>:<br /> 
  @Martin, 
  <br /> 
  <br />there is no such thing as a &quot;sent folder&quot;. In Lotus Notes &quot;Sent&quot; is a view that has a fixed formula and should show the messages you have sent out, but not the messages you have received (they would be in the &quot;all documents&quot; view - with all the others). 
  <br /> 
  <br />To have a message showing up in a different folder (you can show them in as many folders as you want) you add an document.putInFolder call. SO when you import a whole message set that might be in a directory structure resembling your original folder structure you would use the directory name. If the folder doesn't exist it is automatically created. When you execute the command multiple times with different folder names, the document is shown in all those folders, but exists only once.
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Tuesday 02 October 2012 AD - 03:44 Coordinated Universal Time</i>:<br /> 
  In my case the issue is its giving me error message in &quot;MimeException&quot;, the error message is &quot;No exception of type MimeException can be thrown; an exceptipn type must be a subclass of Throwable&quot;. Please let me know what should I do?
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Tuesday 02 October 2012 AD - 09:28 Coordinated Universal Time</i>:<br /> 
  @Vikram - short answer: debug! 
  <br />long answer: (this is a wild guess) It looks like something is not right with the MIME you try to read and the Mime4J classes try to throw an error and that error seems buggy. Head over to the 
  <a href="http://james.apache.org/mail.html#Mime4j" rel="nofollow" target="blank">mailing list </a> and ask for help there. Make sure to provide an isolated code snippet and the message that throws that error.
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Wednesday 03 October 2012 AD - 05:50 Coordinated Universal Time</i>:<br /> 
  Hi, There is no error now, but the issue is the documents gets created and saved in draft view. I dont have issues in there too. But the issue is it keeps To, From, BCC, Subject fields blank. And whatever it gets in EML file it copies that into body(RichTextField) field. Also second big issue is it keeps the message content in base64 encoded format. 
  <br /> 
  <br />Please help me if I am missing anything. my id is viky_rsolanki@yahoo.com.. if possible you can copy this agent into a sample database and send it across to me it would be great help. 
  <br /> 
  <br />I apreciate the coding partner. And even the code. It hardly takes some time to execute 75 eml files of size around 1MB. Highly apreciate the performance. :)
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Wednesday 03 October 2012 AD - 08:39 Coordinated Universal Time</i>:<br /> 
  @Vikram: I run thisas standalone Java application (pointing to the Domino JVM as runtime. Never tested it as agent and have no intention to do so. Too much headache with and permission.&amp;;br /&amp;gt;This might be your problem, so run it standalone.&amp;lt;br /&amp;gt;
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Wednesday 03 October 2012 AD - 09:33 Coordinated Universal Time</i>:<br /> 
  Thanks for your response. 
  <br /> 
  <br />How did u do that? Let me know the steps, even I will do the same way. Please let me know..
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Wednesday 03 October 2012 AD - 09:38 Coordinated Universal Time</i>:<br /> 
  And were u able to create proper email documents?
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Wednesday 03 October 2012 AD - 09:55 Coordinated Universal Time</i>:<br /> 
  In my case, the agent is able to create the documents. Now the issue is it creates the emails with complete EML content in body. And the mail body content as base64 encrypted. Can you help me to understand base 64 encoding format. And how can we get the eml file in normal format. This is only the big issue, rest the code works absolutely as per our expectation.
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Wednesday 03 October 2012 AD - 10:27 Coordinated Universal Time</i>:<br /> 
  /opt/ibm/lotus/notes/jvm/java com.notessensei.mimeport.Tester 
  <br /> 
  <br />eventually a -cp and memory parameters
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Wednesday 03 October 2012 AD - 10:49 Coordinated Universal Time</i>:<br /> 
  cool will try this out
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Friday 05 October 2012 AD - 04:41 Coordinated Universal Time</i>:<br /> 
  Now I have copied all teh jar files,apache-mime4j-0.3.jar,apache-mime4j-0.4.jar,commons-logging-api-1.0.4.jar and mail.jar in [Notes]\jvm\lib\ext directory. 
  <br /> 
  <br />And did not made any changes to your code, jst copied as it is into an agent. Now it works fine, only issue is it keeps it decoded. And only the body content is been displayed the rest of the fields like from, To and Subject does not appears.. I would like you to help me to get this message decoded. 
  <br /> 
  <br />Awaiting for your positive response.
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Friday 05 October 2012 AD - 10:30 Coordinated Universal Time</i>:<br /> 
  @Vikram: which part of &quot;I will not debug your agent, use standalone Java first&quot; was it you didn't understand? 
  <br />As stated before: debug! 
  <br />This is not a site for copy-paste development. When your code loads a mime part what does it discover? Is the mime type in your source wrong? 
  <br /> 
  <img alt="Emoticon angry.gif" src="/blog/images/emoticons/angry.gif" border="0" /> stw
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4249218cff9169c2cc90657aae48c871.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Vikram</b> on <i>Friday 05 October 2012 AD - 20:13 Coordinated Universal Time</i>:<br /> 
  Hi Stephen, 
  <br /> 
  <br />The code works fine with the agent also.. Only thing is it saves the memo document as draft. I am fine with it. The major issue which I am facing now, its only getting the body content and not the other fields like to, copy, bcc and subject which is also required. 
  <br /> 
  <br />Please suggest me.
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8704b4e6c909cd1bdf0b6dce7cc30d81.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Anders Naslund</b> on <i>Wednesday 17 October 2012 AD - 19:20 Coordinated Universal Time</i>:<br /> 
  @Martin, 
  <br />Why all EML Docs shows up in the sent folder is because they lack a field called &quot;DeliveredDate&quot; after being imported. Create a formula agent that runs on all documents that are not supposed to shown as &quot;sent&quot;: 
  <br /> 
  <br />FIELD DeliveredDate := PostedDate; 
  <br />SELECT @All 
  <br /> 
  <br /> 
  <img alt="Emoticon cool.gif" src="/blog/images/emoticons/cool.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/4589c6dbf3e9277504b4db39be33340a.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Michelangelo</b> on <i>Monday 18 November 2013 AD - 01:49 Coordinated Universal Time</i>:<br /> 
  Hi Stephan, thanks for your post. 
  <br />I am trying to do an agent to import from an IMAP account into Notes / Domino. It works on most of the email messages. Two glitches. 
  <br />1) A null pointer exception was thrown on certain eml files in DocContentHandler.field so I placed the code inside a try catch like this 
  <br />try { 
  <br /> this.mimeParts.peek().createHeader(rawField.getName(), rawField.getBody()); 
  <br />} catch (NullPointerException e) { 
  <br /> System.out.println(&quot;Null pointer exception, skipping field&quot;); 
  <br />} 
  <br />No problem with this fix. 
  <br />2) I get a NotesException: Item Body already exists when a message has another message inside it (Content-Type: message/rfc822). When this happens, you see on Java Console a &quot;startMessage&quot; so the line 
  <br />MIMEEntity body = doc.createMIMEEntity(DocContentHandler.RTFIELDNAME); 
  <br />throws an exception. 
  <br />I do not know how to fix this. 
  <br />What came to my mind is cumbersome: create a new doc (let's say doc2), then render to doc2 (recursion), then render doc2 into original body rich text . But ... I do not think I can do so until I finish importing MIME. 
  <br /> 
  <br />So before starting this I wonder if you had had such a problem. 
  <br /> 
  <br />If you think it might help, I have a sample eml file that causes this to happen. 
  <br />Thanks for your great post and if you are at Lotusphere ... errrr ... Connect 2014, I hope to see you there. 
  <br /> 
  <br />
 
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/e0a46e260fddf9eb74f6c224bd2d3a37.jpg?s&#61;88" class="gravatarimg" />
							posted by <b>Filip Navratil</b> on <i>Sunday 14 December 2014 AD - 06:55 Coordinated Universal Time</i>:<br /> 
  I wrote the agent to import from IMAP account into Notes. In order to handle embedded messages (Content-Type: message/rfc822) you have to modify the startMessage method as follows: 
  <br /> if (doc.getMIMEEntity()==null) { 
  <br /> //create mimeEntity 
  <br /> System.out.println(&quot;mimeEntity Creating&quot;); 
  <br /> MIMEEntity body = doc.createMIMEEntity(DocContentHandler.RTFIELDNAME); 
  <br /> this.mimeParts.push(new MimePartInfo(body)); // First element on the stack 
  <br /> } else { 
  <br /> System.out.println(&quot;Root mimeEntity created already&quot;); 
  <br /> MIMEEntity child=doc.getMIMEEntity().createChildEntity(); 
  <br /> this.mimeParts.push(new MimePartInfo(child)); // First element on the stack 
  <br /> } 
  <br /> 
  <br />You also have to modify endMessage method as follows: 
  <br />public void endMessage() throws MimeException { 
  <br /> this.mimeParts.pop(); 
  <br /> System.out.println(&quot; -- Import complete&quot;); 
  <br /> return; 
  <br /> } 
  <br /> 
  <br />As you cannot save within the endMessage method, you have to save the notes Document after md.importMail(s,in, doc) in the &quot;Tester.main&quot;.
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/04/roots-of-wisdom.html"><i class="icon-hand-left"></i>Roots of Wisdom</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/04/extracting-data-from-domino-into-pdf-using-xslt-and-xslfo-part-1.html">Extracting data from Domino into PDF using XSLT and XSL:FO (Part 1)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/04/">April</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/.html"></a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I'm a Cloud "Program Architect Director", working for Salesforce. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://plus.google.com/+StephanWissel/about" rel="author" style="text-decoration: none;">
						    <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="" style="border: 0; width: 16px; height: 16px;" /> Google+</a></li>
						<li><a href="skype://notessensei?chat">Skype</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2018 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2012/04/importing-eml-files-into-notes-lots-of-them.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "C66C3377B8E3257C482579E9004D05CF");
 		};
	</script>

</body>
</html>
