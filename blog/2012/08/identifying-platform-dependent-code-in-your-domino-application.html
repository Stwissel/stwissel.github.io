<!DOCTYPE html>
<html lang="en">
<head>
<title>NotesSensei's Blog - Identifying platform dependent code in your Domino application</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<meta name="ROBOTS" content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title" content="NotesSensei's Weblog - Identifying platform dependent code in your Domino application" />
<meta name="Author" content="Stephan H. Wissel" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta name="description"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="Keywords"
	content="lotus,domino,quickplace,sametime,blog,template,blogging,blogger,notes,r9,verse,r8,r7,r6,r5,raven,k-station,nsf,ntf,websphere,agile,sdlc,j2ee,.net,personcentric,singapore,twins,JavaScript,vertx, nodejs" />
<meta name="Abstract"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="ICBM" content="1.2994, 103.8425" />
<meta name="Copyright"
	content="2012,2017 Stephan H. Wissel - Creative commons licence" />
<meta HTTP-EQUIV="Content-Language" content="en" />
<meta property="fb:admins" content="567103136" />
<meta property="fb:app_id" content="219323514774289">
<meta property="og:title"
	content="wissel.net - Identifying platform dependent code in your Domino application" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://wissel.net/blog" />
<meta property="og:image"
	content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="twitter:site" content="@notessensei" />
<meta name="twitter:card" content="summary" />
<meta name="xing:author"
	content="https://www.xing.com/profile/StephanH_Wissel" />

<link rel="stylesheet" type="text/css" href="/blog/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shariff.complete.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />


<link rel="stylesheet" href="/blog/css/markdown.css" />
<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnet" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>


	<div class="container">

    		<!-- Masthead
		================================================== -->
		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <!--[if lt IE 10]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 11'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
<![endif]-->

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/08/">August</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/DXLMagic.html">DXLMagic</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>


		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/07/fixing-dominos-ldap.html"><i class="icon-hand-left"></i>Fixing Domino&apos;s LDAP</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/09/use-chrome-web-apps-to-access-ibm-connections-and-others.html">Use Chrome web apps to access IBM Connections (and others)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1>
						<small>Identifying platform dependent code in your Domino application</small>
					</h1>
					<hr />
					<div>Domino runs on many platforms, so you have the freedom of choice what to use. My personal favorite currently is zLinux 64Bit, the mainframe I/O capabilites are delightful. However you might have limited your choices by the way you developed your applications. Luckily LotusScript is case insensitive on all platforms, so you only have to pay attention to pieces of code that interact with the world around you. In specific you need to watch out for: 
<ul> 
 <li><a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FLSAZ_DECLARE_STATEMENT_EXTERNAL_C_CALLS.html">DECLARE</a>: where in LotusScript you refer to OS level DLLs that most likely won't be available on other platforms</li> 
 <li><a href="">Execute</a>: There could be anything inside, you don't know</li> 
 <li><a href="http://www.ibm.com/developerworks/lotus/library/ls-The_Evaluate_statement/">Evaluate</a> (and <a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_EVAL.html">@Eval</a>): Again there could be anything inside</li> 
 <li><a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FLSAZ_SHELL_FUNCTION.html">SHELL</a>: Executing OS level calls</li> 
 <li><b>Anything that reads/writes a file</b>: NotesStream, Standard file I/O etc.</li> 
 <li><a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FH_DBCOMMAND_ODBC.html">@DBCommand</a> (and the other @DB functions): When using ODBC that driver must be on the new platform. @DBCommand also allows you to actually call a DLL (a very little known extension point) when you use a keyword other than &quot;Domino&quot; or &quot;ODBC&quot;. That DLL needs to be available on the target platform</li> 
 <li><a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/index.jsp?topic=%2Fcom.ibm.designer.domino.main.doc%2FLSAZ_UNIX_PLATFORM_DIFFERENCES.html">All statements that need attention</a>: ActivateApp, ChDir, ChDrive, CreateObject, CurDir, CurDir$, CurDrive, CurDrive$, Date, Date$, Declare, Dir, Dir$, FileLen, Len, LenB, LenBP, LOF, GetFileAttr, GetObject, Input #, Input, Input$, InputB, InputB$, Line Input, Print, Write #, IsObject, IsUnknown, Open, Lock, Unlock, SendKeys, SetFileAttr, Shell, Time, Time$</li> 
</ul> Now when you are tasked with evaluating a server move to a different platform, you can use 
<a href="http://www.openntf.org/p/dxlmagic">DXLMagic</a> to get an idea how many problem areas you might deal with. These are the steps: 
<ol> 
 <li>Export your databases using the GUI:<br /> <img src="/blog/images/2012/exportnsf.png" border="0" alt="Export NSF" /><br /> Make sure you checked the option &quot;Create metric files&quot; </li> 
 <li>In your target directory you will find 2 files <code>com.ibm.sg.dxlmagic.DocumentDesignMetrics.properties</code> and <code>com.ibm.sg.dxlmagic.DocumentDesignTags.properties</code>. The first one determines what goes into the CSV file, the second one generates additional tags based on code fragments. You can edit both files and run the extraction from the command line (much faster than the initial export) to get the &quot;how much to pay attention to&quot; report. Edit the <code>com.ibm.sg.dxlmagic.DocumentDesignTags.properties</code> and change it to the following content<br /> <code><pre>#***** Platform investigation ******
Declare\ =C_CALL
ActivateApp=OLE_CALL
GetObject=OLE_CALL
CreateObject=OLE_CALL
IsObject=OLE_CALL
IsUnknown=OLE_CALL
ChDrive=DRIVE_OP
CurDrive=DRIVE_OP
ChDir=DIR_OP
CurDir=DIR_OP
Dir=DIR_OP
FileLen=FILE_IO
Len=FILE_IO
LenB=FILE_IO
LenBP=FILE_IO
LOF=FILE_IO
GetFileAttr=FILE_IO
SetFileAttr=FILE_IO
Input\ \#=FILE_IO
Input=FILE_IO
InputB=FILE_IO
Line\ Input=FILE_IO
Write\ \#=FILE_IO
Open=FILE_IO
Lock=FILE_IO
Unlock=FILE_IO
NotesStream=FILE_IO
Print=PRINT
Date=TIME_OP
Time=TIME_OP
Shell=SHELL_CALL
SendKeys=SHELL_CALL
@dialogbox=UI_formula
@prompt=UI_formula
.dialogbox=UI_script
as\ notesui=UI_script
source\ as=UI_event
@db=DB_formula
</pre></code><br /> Then edit the <code>com.ibm.sg.dxlmagic.DocumentDesignMetrics.properties</code> file and add the new tags (you can keep the existing ones if you want):<br /> <code><pre>C_CALL
OLE_CALL
DRIVE_OP
DIR_OP
FILE_IO
PRINT
TIME_OP
SHELL_CALL
DB_formula
LOC_formula
LOC_java
LOC_javascript
LOC_lotusscript
UI_event
UI_formula
UI_script
action
agent
button
column
field
form
formula
java
javascript
lotusscript
par
role
sharedcolumn
sharedfield
subform
view
</pre></code><br /> (you might want to skip the PRINT statement since it is often used in web agents and there nothing is special) </li> 
 <li>Run DXLMagic from the <a href="http://www.wissel.net/blog/d6plinks/SHWL-7PEMTF">Command Line</a> to extract and document based on the new property files. The result will be a new CSV file with extra columns<br /> <code> java com.ibm.sg.dxlmagic.DocumentDesignTags [DirectoryWithTheDXL] <br /> java com.ibm.sg.dxlmagic.DocumentDesignMetrics [DirectoryWithTheDXL] CsvFileName </code></li> 
</ol> Just to be clear: this steps show you how many instances are there, but not where or if changes are required. Most likely all PRINT and @db commands will be just fine. But it is a fast method to get a first impression. Based on the DXL you could devise an XSLT report to show the problem spots in detail. 
<br />As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 2012-08-15 10:10
<span class="divider">|</span>
<a href="/blog/2012/08/identifying-platform-dependent-code-in-your-domino-application.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/DXLMagic.html">DXLMagic</a>  <a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a> 

						<div class="shariff" data-lang="en" data-url="https://www.notessensei.com/blog/2012/08/identifying-platform-dependent-code-in-your-domino-application.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-title="Identifying platform dependent code in your Domino application"></div>
						<script type="text/javascript">
							var permaLink = "https://www.notessensei.com/blog/2012/08/identifying-platform-dependent-code-in-your-domino-application.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_784373D81EC57EFB48257A5B000BEAC0" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_784373D81EC57EFB48257A5B000BEAC0"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2012/07/fixing-dominos-ldap.html"><i class="icon-hand-left"></i>Fixing Domino&apos;s LDAP</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2012/09/use-chrome-web-apps-to-access-ibm-connections-and-others.html">Use Chrome web apps to access IBM Connections (and others)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/">2012</a> <span class="divider">/</span></li>
  <li><a href="/blog/2012/08/">August</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/DXLMagic.html">DXLMagic</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

	</div>
<!-- Footer	================================================== -->
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I am the "IBM Cloud Development Advocate for Collaboration". I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog"></g:plusone>
					</p>
					<script src="//stackoverflow.com/users/flair/131021.js?theme=default" type="text/javascript"></script>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://plus.google.com/+StephanWissel/about" rel="author" style="text-decoration: none;">
						    <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="" style="border: 0; width: 16px; height: 16px;" /> Google+</a></li>
						<li><a href="skype//:notessensei?chat">Skype</a></li>
						<li><a href="/blog/2010/04/communicating-with-ibmers-and-lotus-professionals-using-sametime.html"
							   title="Many ways to use Sametime, no own Sametime server required">Sametime</a></li>
						<li><a href="http://www.ibm.com/contact/employees/servlets/lookup?lastname=Wissel&amp;firstname=Stephan">IBM</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by Lotus Software nor IBM Corporation.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						IBM's - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2017 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="http://creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2012/08/identifying-platform-dependent-code-in-your-domino-application.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/jquery.fittext.js"></script>
	<script type="text/javascript" src="/blog/js/main.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>   
    <script type="text/javascript">
		SyntaxHighlighter.all();
		var countdown = document.getElementById("countdown");
		if (countdown) {
			countdown.innerHTML = getDayDifference("March 31 , 2017");
		}
    </script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
	
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/comments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			renderComment("6LcUOewSAAAAACAI4zVcGFVkGWmp0sUH5gabwy1q", "784373D81EC57EFB48257A5B000BEAC0");
		});
	</script>

</body>
</html>
