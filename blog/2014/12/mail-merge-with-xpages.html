<!DOCTYPE html>
<html lang="en">
<head>
<title>NotesSensei's Blog - Mail Merge with XPages</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<meta name="ROBOTS" content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title" content="NotesSensei's Weblog - Mail Merge with XPages" />
<meta name="Author" content="Stephan H. Wissel" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta name="description"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="Keywords"
	content="lotus,domino,quickplace,sametime,blog,template,blogging,blogger,notes,r9,verse,r8,r7,r6,r5,raven,k-station,nsf,ntf,websphere,agile,sdlc,j2ee,.net,personcentric,singapore,twins,JavaScript,vertx, nodejs" />
<meta name="Abstract"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="ICBM" content="1.2994, 103.8425" />
<meta name="Copyright"
	content="2014,2017 Stephan H. Wissel - Creative commons licence" />
<meta HTTP-EQUIV="Content-Language" content="en" />
<meta property="fb:admins" content="567103136" />
<meta property="fb:app_id" content="219323514774289">
<meta property="og:title"
	content="wissel.net - Mail Merge with XPages" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://wissel.net/blog" />
<meta property="og:image"
	content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="twitter:site" content="@notessensei" />
<meta name="twitter:card" content="summary" />
<meta name="xing:author"
	content="https://www.xing.com/profile/StephanH_Wissel" />

<link rel="stylesheet" type="text/css" href="/blog/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shariff.complete.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="stylesheet" href="/blog/css/markdown.css" />
<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnet" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>


	<div class="container">

    		<!-- Masthead
		================================================== -->
		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <!--[if lt IE 10]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 11'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
<![endif]-->

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/XPages.html">XPages</a>
  </li>
</ul>


		<div class="row-fluid">
			<div class="span12">
							<div class="well well-raised">
				<p>This article is part of a mini series. Read them all (latest on top):</p>
				<h3>Fun with {{Mustache}}</h3>
				<ol reversed class="nav nav-list">
					<li ><a href="/blog/2017/05/generating-a-controller-out-of-a-form.html">Generating a Controller out of a form</a></li>
					<li ><a href="/blog/2014/12/command-line-mail-merge.html">Command line mail merge</a></li>
					<li  class="active"><a href="/blog/2014/12/mail-merge-with-xpages.html">Mail Merge with XPages</a></li>
					<li ><a href="/blog/2014/11/mustache-helper-for-domino.html">{{Mustache}} Helper for Domino and XPages</a></li>
					<li ><a href="/blog/2014/09/creating-nginx-configurations-for-domino-ssl.html">Creating nginx configurations for Domino SSL</a></li>
					<li ><a href="/blog/2014/04/mustache-and-ckeditor-round-two.html">Mustache and CKEditor - Round two</a></li>
					<li ><a href="/blog/2014/04/ckeditor-and-mustache-become-friends.html">CKEditor and Mustache become friends</a></li>
					<li ><a href="/blog/2014/03/fun-with-mustache-and-notes-forms.html">Fun with {{Mustache}} and Notes Forms</a></li>
				</ol>
			</div>	

				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/12/application-migration-vs-xpage-enablement.html"><i class="icon-hand-left"></i>Application Migration vs. XPage enablement</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2014/12/command-line-mail-merge.html">Command line mail merge<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1>
						<small>Mail Merge with XPages</small>
					</h1>
					<hr />
					<div>Being able to have individualized letters based on a template was one of the drivers to make 
<a href="http://en.wikipedia.org/wiki/WordStar">Word processors</a> popular. In the age of 
<i>mass-communication of one</i>. This tasks falls no longer to the printer, but your eMail processor. For a complete solution, check out 
<a href="">Chris Toohey's</a> excellent 
<a href="http://www.dominoguru.com/website.nsf/page.xsp?id=product-mailer.html">Mailer</a> application, that is yours for USD 5.00 only. 
<br /> I was wondering what it would take to build something similar, minus the address management, in XPages. I defined a few constraints: 
<ul> 
 <li>I don't want to store the address list or the raw message</li> 
 <li>I need to be able to send images</li> 
 <li>I need to be able to fine tune the HTML</li> 
 <li>No sending of attachments required</li> 
 <li>Message needs to be individual using parameters (in the Body only), list of parameters will be flexible supplied together with the eMails as CSV data</li> 
</ul> So I created the 
<code>MergeManager</code> Java bean. Along the way I made a few experiences: 
<ul> 
 <li>When bound to a bean the XPages RichText control wants a data type of <code>com.ibm.xsp.http.MimeMultipart</code></li> 
 <li>The IBM Image upload doesn't work with a bean bound RichText control, but dragging and dropping works. I got rid of the button with a single line of code:<br /> <code>config.removeButtons = 'IbmImage';</code></li> 
 <li>When adding the <a href="http://www.wissel.net/blog/d6plinks/SHWL-9HZ2EA">Dropdown for the variables</a>, a simple change allowed me to show the <i>View source</i> button:<br /> <code>{&quot;name&quot; : &quot;mustache&quot;, &quot;items&quot; : [&quot;mustache&quot;,<b>&quot;Source&quot;</b>] });</code></li> 
 <li>I reused parts of <a href="http://openntf.org/XSnippets.nsf/snippet.xsp?id=emailbean-send-dominodocument-html-emails-cw-embedded-images-attachments-custom-headerfooter">Toni's eMail bean</a>, which I stripped of the attachment function and added direct deposition into the <code>mail.box</code>. Works like a charm</li> 
 <li>There are lots of loose ends to consider: using the <a href="">OpenNTF Domino API</a> to gain easy access to theads to send the messages in the background would be top on the list. Allow template storage, different messages for HTML and Text (and EE), eMail preview some of the others. But that's a story for another time</li> 
</ul> The result is a reusable bean for custom mass eMails.In my implementation I tested it on Domino (and the Notes client) 9.,0.1FP2. The bean should run in most 8.5x ++ versions, but the UI (not part of this post, subject to a future one) used the new CKEditor 4.2, so it won't run on older versions. 
<br /> 
<pre class="brush : java">
package com.notessensei;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.Serializable;
import java.io.StringReader;
import java.io.StringWriter;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;
import java.util.TreeMap;

import lotus.domino.Database;
import lotus.domino.Document;
import lotus.domino.MIMEEntity;
import lotus.domino.MIMEHeader;
import lotus.domino.NotesException;
import lotus.domino.Session;
import lotus.domino.Stream;

import com.github.mustachejava.DefaultMustacheFactory;
import com.github.mustachejava.Mustache;
import com.github.mustachejava.MustacheFactory;
import com.ibm.xsp.http.MimeMultipart;

public class MergeManager implements Serializable {

	private static final long	                   serialVersionUID	= 1L;
	private String	                               subject;
	private String	                               from;
	private String	                               rawAddresses;
	private final Map&lt;String, Map&lt;String, String&gt;&gt;	rcpData	        = new TreeMap&lt;String, Map&lt;String, String&gt;&gt;();
	private MimeMultipart	                       message;
	private String	                               eMailField	    = &quot;eMail&quot;;
	private final ArrayList&lt;String&gt;	               fields	        = new ArrayList&lt;String&gt;();
	private final MustacheFactory	               factory	        = new DefaultMustacheFactory();
	private final StringBuilder	                   statusMessages	= new StringBuilder();

	public MergeManager() {
		// Default Constructor to
		// be able to work as a bean
	}

	private void addOneDataLine(Map&lt;String, Map&lt;String, String&gt;&gt; allRCP, ArrayList&lt;String&gt; fields, String raw) {
		Map&lt;String, String&gt; oneLine = new HashMap&lt;String, String&gt;();
		String key = raw; // Backup pla
		try {
			String[] dataItems = raw.split(&quot;,&quot;);
			for (int i = 0; i &lt; dataItems.length; i++) {
				oneLine.put(fields.get(i), dataItems[i]);
				if (fields.get(i).equalsIgnoreCase(this.eMailField)) {
					key = dataItems[i];
				}
			}
			allRCP.put(key, oneLine);

		} catch (Exception e) {
			e.printStackTrace();
		}

	}

	public void clear() {
		this.message = null;
		this.subject = null;
		this.rawAddresses = null;
		this.statusMessages.delete(0, this.statusMessages.length() - 1);
	}

	public String getCount() {
		return (this.rcpData.isEmpty()) ? &quot;0&quot; : String.valueOf(this.rcpData.size());
	}

	public String getEmailField() {
		return this.eMailField;
	}

	public ArrayList&lt;String&gt; getFields() {
		return this.fields;
	}

	private void getFields(ArrayList&lt;String&gt; list, String raw) {
		String[] fieldNames = raw.split(&quot;,&quot;);
		list.clear();
		for (int i = 0; i &lt; fieldNames.length; i++) {
			list.add(fieldNames[i]);
		}
		return;
	}

	public String getFrom() {
		return this.from;
	}

	public MimeMultipart getMessage() {
		return this.message;
	}

	public String getRawAddresses() {
		return (this.rawAddresses == null) ? (&quot;eMail,salutation,greeting\n&quot;+
                                  &quot;peter.parker@noreply.com,Hi spidy,Your arachno fan\n&quot;+
                                  &quot;st.wissel@sg.ibm.com,Dear NotesSensei,Keep on coding&quot;
		        : this.rawAddresses;
	}

	public String getStatus() {
		return this.statusMessages.toString();
	}

	public String getSubject() {
		return this.subject;
	}

	private void populateMail(Session s, Document mail, String htmlBody,String textBody, String receipient) throws NotesException {
		s.setConvertMime(false);

		final MIMEEntity emailRoot = mail.createMIMEEntity(&quot;Body&quot;);

		// Primary Header
		String fromSender = this.getFrom();
		MIMEHeader emailHeader = emailRoot.createHeader(&quot;Return-Path&quot;);
		emailHeader.setHeaderVal(fromSender);
		emailHeader = emailRoot.createHeader(&quot;From&quot;);
		emailHeader.setHeaderVal(fromSender);
		emailHeader = emailRoot.createHeader(&quot;Sender&quot;);
		emailHeader.setHeaderVal(fromSender);

		emailHeader = emailRoot.createHeader(&quot;Recipients&quot;);
		emailHeader.setHeaderVal(receipient);

		emailHeader = emailRoot.createHeader(&quot;To&quot;);
		emailHeader.setHeaderVal(receipient);
		
		emailHeader = emailRoot.createHeader(&quot;Subject&quot;);
		emailHeader.setHeaderVal(this.getSubject());

		// Text and HTML Body
		MIMEEntity emailRootChild = emailRoot.createChildEntity();
		final String boundary = System.currentTimeMillis() + &quot;-&quot; + String.valueOf(this.hashCode());
		emailHeader = emailRootChild.createHeader(&quot;Content-Type&quot;);
		emailHeader.setHeaderVal(&quot;multipart/alternative; boundary=\&quot;&quot; + boundary + &quot;\&quot;&quot;);

		MIMEEntity emailChild = emailRootChild.createChildEntity();

		Stream stream = s.createStream();
		stream.writeText(textBody);
		emailChild.setContentFromText(stream, &quot;text/plain; charset=\&quot;UTF-8\&quot;&quot;, MIMEEntity.ENC_NONE);
		stream.close();

		emailChild = emailRootChild.createChildEntity();
		stream = s.createStream();
		stream.writeText(htmlBody);
		emailChild.setContentFromText(stream, &quot;text/html; charset=\&quot;UTF-8\&quot;&quot;, MIMEEntity.ENC_NONE);
		stream.close();
		stream.recycle();
		stream = null;
		s.setConvertMime(true);
	}

	public void process(Session s, Database database, Database mailbox) {
		System.out.println(this.message.getHTML());
		System.out.println(this.message.getContentAsText());
		Mustache mHTML = this.factory.compile(new StringReader(this.message.getHTML()), &quot;eMailHTML&quot;);
		Mustache mText = this.factory.compile(new StringReader(this.message.getContentAsText()), &quot;eMailPlain&quot;);
		for (Map&lt;String, String&gt; oneRecord : this.rcpData.values()) {
			this.sendOneMessage(s, database, mailbox, mHTML, mText, oneRecord);
		}
	}

	private void processRawAdresses(String raw) {
		ByteArrayInputStream in = new ByteArrayInputStream(raw.getBytes());
		boolean firstLine = true;
		Scanner scanner = new Scanner(in);

		while (scanner.hasNextLine()) {
			if (firstLine) {
				this.rcpData.clear();
				this.getFields(this.fields, scanner.nextLine());
				firstLine = false;
			} else {
				this.addOneDataLine(this.rcpData, this.fields, scanner.nextLine());
			}
		}
		this.statusMessages.append(String.format(&quot;%x Records loaded and ready\n&quot;, this.rcpData.size()));
		try {
			in.close();
		} catch (IOException e) {
			e.printStackTrace();
		}
	}

	private void sendOneMessage(Session s, Database database, Database mailbox, Mustache mHTML, Mustache mText, Map&lt;String, String&gt; oneRecord) {
		
		// Text as HTML and as plain Text
		StringWriter htmlBody = new StringWriter();
		StringWriter textBody = new StringWriter();
		mHTML.execute(htmlBody, oneRecord);
		mText.execute(textBody, oneRecord);
		try {
			Document mail = database.createDocument();
			String rcpt = oneRecord.get(this.eMailField);
			mail.replaceItemValue(&quot;Form&quot;, &quot;Memo&quot;);
			this.populateMail(s, mail, htmlBody.toString(), textBody.toString(), rcpt);
			mail.save();
			if (mailbox != null) {
				mail.copyToDatabase(mailbox);
			}
			mail.recycle();
			this.statusMessages.append(&quot;Mail send to &quot;);
			this.statusMessages.append(rcpt);
			this.statusMessages.append(&quot;\n&quot;);
		} catch (Exception e) {
			this.statusMessages.append(e.getMessage());
			this.statusMessages.append(&quot;\n&quot;);
		}
	}

	public void setEmailField(String mailField) {
		this.eMailField = mailField;
	}

	public void setFrom(String from) {
		this.from = from;
	}

	public void setMessage(MimeMultipart message) {
		this.message = message;
	}

	public void setRawAddresses(String rawAddresses) {
		if (rawAddresses != null &amp;&amp; !rawAddresses.equals(this.rawAddresses)) {
			this.processRawAdresses(rawAddresses);
			this.rawAddresses = rawAddresses;
		}
	}

	public void setSubject(String subject) {
		this.subject = subject;
	}
}
</pre> 
<br /> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 2014-12-13 08:21
<span class="divider">|</span>
<a href="/blog/2014/12/mail-merge-with-xpages.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/XPages.html">XPages</a> 

						<div class="shariff" data-lang="en" data-url="https://www.notessensei.com/blog/2014/12/mail-merge-with-xpages.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-title="Mail Merge with XPages"></div>
						<script type="text/javascript">
							var permaLink = "https://www.notessensei.com/blog/2014/12/mail-merge-with-xpages.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_5824628E3CB81D1C48257DAD0001F418" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_5824628E3CB81D1C48257DAD0001F418"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/12/application-migration-vs-xpage-enablement.html"><i class="icon-hand-left"></i>Application Migration vs. XPage enablement</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2014/12/command-line-mail-merge.html">Command line mail merge<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/XPages.html">XPages</a>
  </li>
</ul>

	</div>
<!-- Footer	================================================== -->
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I am the "IBM Cloud Development Advocate for Collaboration". I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://plus.google.com/+StephanWissel/about" rel="author" style="text-decoration: none;">
						    <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="" style="border: 0; width: 16px; height: 16px;" /> Google+</a></li>
						<li><a href="skype//:notessensei?chat">Skype</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2017 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2014/12/mail-merge-with-xpages.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/jquery.fittext.js"></script>
	<script type="text/javascript" src="/blog/js/main.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>   
    <script type="text/javascript">
		SyntaxHighlighter.all();
		var countdown = document.getElementById("countdown");
		if (countdown) {
			countdown.innerHTML = getDayDifference("March 31 , 2017");
		}
    </script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
	
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/comments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			renderComment("6LcUOewSAAAAACAI4zVcGFVkGWmp0sUH5gabwy1q", "5824628E3CB81D1C48257DAD0001F418");
		});
	</script>

</body>
</html>
