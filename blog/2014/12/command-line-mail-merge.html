<!DOCTYPE html>
<html lang="en">
<head>
<title>Command line mail merge - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Command line mail merge" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2014/12/command-line-mail-merge.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Command line mail merge" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2014,2019 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Command line mail merge&#10;As shown before mail merging with Notes and {{mustache}} is simple and easy to code. To be able to run merging on the command line, I modified the bean and removed the XPages dependency and added a static main function. Now you can run it off the command line easily. It requires 5 parameters: the da" />
<meta name="Keywords"
	content="IBM Notes," />
<meta name="Abstract"
	content="Command line mail merge&#10;As shown before mail merging with Notes and {{mustache}} is simple and easy to code. To be able to run merging on the command line, I modified the bean and removed the XPages dependency and added a static main function. Now you can run it off the command line easily. It requires 5 parameters: the da" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <script> 
var $buoop = {notify:{e:-0.01,f:-0.01,o:-0.01,s:-0.01,c:-0.01},insecure:true,unsupported:true,api:5}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.min.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script>

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
							<div class="well well-raised">
				<p>This article is part of a mini series. Read them all:</p>
				<h3>Fun with {{Mustache}}</h3>
				<ol reversed class="nav nav-list">
					<li ><a href="/blog/2014/03/fun-with-mustache-and-notes-forms.html">Fun with {{Mustache}} and Notes Forms</a></li>
					<li ><a href="/blog/2014/04/ckeditor-and-mustache-become-friends.html">CKEditor and Mustache become friends</a></li>
					<li ><a href="/blog/2014/04/mustache-and-ckeditor-round-two.html">Mustache and CKEditor - Round two</a></li>
					<li ><a href="/blog/2014/09/creating-nginx-configurations-for-domino-ssl.html">Creating nginx configurations for Domino SSL</a></li>
					<li ><a href="/blog/2014/11/mustache-helper-for-domino.html">{{Mustache}} Helper for Domino and XPages</a></li>
					<li ><a href="/blog/2014/12/mail-merge-with-xpages.html">Mail Merge with XPages</a></li>
					<li  class="active"><a href="/blog/2014/12/command-line-mail-merge.html">Command line mail merge</a></li>
				</ol>
			</div>	

				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/12/mail-merge-with-xpages.html"><i class="icon-hand-left"></i>Mail Merge with XPages</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2015/01/the-engineered-society.html">The engineered society<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Command line mail merge</small></h1>
					<hr />
					<div>As 
<a href="/blog/2014/12/mail-merge-with-xpages.html">shown before</a> mail merging with Notes and {{mustache}} is simple and easy to code. To be able to run merging on the command line, I modified the bean and removed the XPages dependency and added a static main function. Now you can run it off the command line easily. It requires 5 parameters: 
<ol> 
 <li>the database name</li> 
 <li>the CSV file</li> 
 <li>a file with a HTML message including {{mustache}} tags</li> 
 <li>a file with a Text message including {{mustache}} tags</li> 
 <li>The senders eMail</li> 
</ol>There isn't much error handling in that code, so be careful. 
<br> 
<pre class="brush : java">
package com.notessensei;

import java.io.ByteArrayInputStream;
import java.io.File;
import java.io.IOException;
import java.io.Serializable;
import java.io.StringReader;
import java.io.StringWriter;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Map;
import java.util.Scanner;
import java.util.TreeMap;

import lotus.domino.Database;
import lotus.domino.Document;
import lotus.domino.MIMEEntity;
import lotus.domino.MIMEHeader;
import lotus.domino.NotesException;
import lotus.domino.NotesFactory;
import lotus.domino.NotesThread;
import lotus.domino.Session;
import lotus.domino.Stream;

import com.github.mustachejava.DefaultMustacheFactory;
import com.github.mustachejava.Mustache;
import com.github.mustachejava.MustacheFactory;

public class MergeManager implements Serializable {

    public static void main(String[] args) throws NotesException, IOException {
        // We need 4 parameters: nsfToUse, addresses, html message, text message
        // eMail field in addresses MUST be eMail
        if (args.length &lt; 5) {
            System.out.println("Usage: java MergeManager maifile.nsf, addresses.csv, htmlmessage.txt, textmessage.txt sender");
            System.exit(1);
        }

        String dbName = args[0];
        String adrfilename = args[1];
        String htmlfilename = args[2];
        String txtfilename = args[3];
        String sender = args[4];

        MergeManager mergeManager = new MergeManager();

        // Load the content into the objects
        mergeManager.setRawAddresses(new Scanner(new File(adrfilename)).useDelimiter("\\Z").next());
        mergeManager.setHtmlMessage(new Scanner(new File(htmlfilename)).useDelimiter("\\Z").next());
        mergeManager.setTextMessage(new Scanner(new File(txtfilename)).useDelimiter("\\Z").next());
        mergeManager.setFrom(sender);
        
        // Spin up Notes
        NotesThread.sinitThread();
        Session s = NotesFactory.createSession();
        Database userMail = s.getDatabase("", dbName);
        // Set mailbox to null if you only want to generate the mails
        // but not send them
        Database mailbox = s.getDatabase("", "mail.box");

        mergeManager.process(s, userMail, mailbox);

        System.out.println(mergeManager.getStatus());

        // Shut down
        userMail.recycle();
        mailbox.recycle();
        NotesThread.stermThread();
    }
    private static final long                      serialVersionUID = 1L;
    private String                                 subject;
    private String                                 from;
    private String                                 rawAddresses;
    private final Map&lt;String, Map&lt;String, String&gt;&gt; rcpData          = new TreeMap&lt;String, Map&lt;String, String&gt;&gt;();
    private String                                 htmlMessage;
    private String                                 textMessage;
    private String                                 eMailField       = "eMail";
    private final ArrayList&lt;String&gt;                fields           = new ArrayList&lt;String&gt;();
    private final MustacheFactory                  factory          = new DefaultMustacheFactory();

    private final StringBuilder                    statusMessages   = new StringBuilder();

    private void addOneDataLine(Map&lt;String, Map&lt;String, String&gt;&gt; allRCP, ArrayList&lt;String&gt; fields, String raw) {
        Map&lt;String, String&gt; oneLine = new HashMap&lt;String, String&gt;();
        String key = raw; // Backup pla
        try {
            String[] dataItems = raw.split(",");
            for (int i = 0; i &lt; dataItems.length; i++) {
                oneLine.put(fields.get(i), dataItems[i]);
                if (fields.get(i).equalsIgnoreCase(this.eMailField)) {
                    key = dataItems[i];
                }
            }
            allRCP.put(key, oneLine);

        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    private void getFields(ArrayList&lt;String&gt; list, String raw) {
        String[] fieldNames = raw.split(",");
        list.clear();
        for (int i = 0; i &lt; fieldNames.length; i++) {
            list.add(fieldNames[i]);
        }
        return;
    }

    public String getStatus() {
        return this.statusMessages.toString();
    }

    private void populateMail(Session s, Document mail, String htmlBody, String textBody, String receipient) throws NotesException {
        s.setConvertMime(false);

        final MIMEEntity emailRoot = mail.createMIMEEntity("Body");

        // Primary Header
        String fromSender = this.from;
        MIMEHeader emailHeader = emailRoot.createHeader("Return-Path");
        emailHeader.setHeaderVal(fromSender);
        emailHeader = emailRoot.createHeader("From");
        emailHeader.setHeaderVal(fromSender);
        emailHeader = emailRoot.createHeader("Sender");
        emailHeader.setHeaderVal(fromSender);

        emailHeader = emailRoot.createHeader("Recipients");
        emailHeader.setHeaderVal(receipient);

        emailHeader = emailRoot.createHeader("To");
        emailHeader.setHeaderVal(receipient);

        emailHeader = emailRoot.createHeader("Subject");
        emailHeader.setHeaderVal(this.subject);

        // Text and HTML Body
        MIMEEntity emailRootChild = emailRoot.createChildEntity();
        final String boundary = System.currentTimeMillis() + "-" + String.valueOf(this.hashCode());
        emailHeader = emailRootChild.createHeader("Content-Type");
        emailHeader.setHeaderVal("multipart/alternative; boundary=\"" + boundary + "\"");

        MIMEEntity emailChild = emailRootChild.createChildEntity();

        Stream stream = s.createStream();
        stream.writeText(textBody);
        emailChild.setContentFromText(stream, "text/plain; charset=\"UTF-8\"", MIMEEntity.ENC_NONE);
        stream.close();

        emailChild = emailRootChild.createChildEntity();
        stream = s.createStream();
        stream.writeText(htmlBody);
        emailChild.setContentFromText(stream, "text/html; charset=\"UTF-8\"", MIMEEntity.ENC_NONE);
        stream.close();
        stream.recycle();
        stream = null;
        s.setConvertMime(true);
    }

    public void process(Session s, Database database, Database mailbox) {
        Mustache mHTML = this.factory.compile(new StringReader(this.htmlMessage), "eMailHTML");
        Mustache mText = this.factory.compile(new StringReader(this.textMessage), "eMailPlain");
        for (Map&lt;String, String&gt; oneRecord : this.rcpData.values()) {
            this.sendOneMessage(s, database, mailbox, mHTML, mText, oneRecord);
        }
    }

    private void processRawAdresses(String raw) {
        ByteArrayInputStream in = new ByteArrayInputStream(raw.getBytes());
        boolean firstLine = true;
        Scanner scanner = new Scanner(in);

        while (scanner.hasNextLine()) {
            if (firstLine) {
                this.rcpData.clear();
                this.getFields(this.fields, scanner.nextLine());
                firstLine = false;
            } else {
                this.addOneDataLine(this.rcpData, this.fields, scanner.nextLine());
            }
        }
        this.statusMessages.append(String.format("%x Records loaded and ready\n", this.rcpData.size()));
        try {
            in.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    private void sendOneMessage(Session s, Database database, Database mailbox, Mustache mHTML, Mustache mText,
                Map&lt;String, String&gt; oneRecord) {

        // Text as HTML and as plain Text
        StringWriter htmlBody = new StringWriter();
        StringWriter textBody = new StringWriter();
        mHTML.execute(htmlBody, oneRecord);
        mText.execute(textBody, oneRecord);
        try {
            Document mail = database.createDocument();
            String rcpt = oneRecord.get(this.eMailField);
            mail.replaceItemValue("Form", "Memo");
            this.populateMail(s, mail, htmlBody.toString(), textBody.toString(), rcpt);
            mail.save();
            if (mailbox != null) {
                mail.copyToDatabase(mailbox);
            }
            mail.recycle();
            this.statusMessages.append("Mail send to ");
            this.statusMessages.append(rcpt);
            this.statusMessages.append("\n");
        } catch (Exception &lt;e) {
            this.statusMessages.append(e.getMessage());
            this.statusMessages.append("\n");
        }
    }

    public void setEmailField(String mailField) {
        this.eMailField = mailField;
    }

    public void setFrom(String from) {
        this.from = from;
    }

    public void setHtmlMessage(String htmlMessage) {
        this.htmlMessage = htmlMessage;
    }

    public void setRawAddresses(String rawAddresses) {
        if (rawAddresses != null &amp;&amp; !rawAddresses.equals(this.rawAddresses)) {
            this.processRawAdresses(rawAddresses);
            this.rawAddresses = rawAddresses;
        }
    }

    public void setSubject(String subject) {
        this.subject = subject;
    }

    public void setTextMessage(String textMessage) {
        this.textMessage = textMessage;
    }
}
</pre> 
<br> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 13 December 2014
<span class="divider">|</span>
<a href="/blog/2014/12/command-line-mail-merge.html#comments">Comments (1)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/ibmnotes.html">IBM Notes</a> 

						<div class="shariff" data-lang="en" data-url="https://www.wissel.net/blog/2014/12/command-line-mail-merge.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]" data-title="Command line mail merge" data-twitter-via="@notessensei"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2014/12/command-line-mail-merge.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_AC78A80D1B42A33D48257DAD0008AE17" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_AC78A80D1B42A33D48257DAD0008AE17"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Tuesday 30 December 2014 AD</i>:<br /> 
  <p>Of course nobody would manually call the command line (**we wouldn't**). However in a batch file that might come handy.</p>
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/12/mail-merge-with-xpages.html"><i class="icon-hand-left"></i>Mail Merge with XPages</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2015/01/the-engineered-society.html">The engineered society<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/12/">December</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I'm a Cloud "Program Architect Director", working for Salesforce. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2019 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2014/12/command-line-mail-merge.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "AC78A80D1B42A33D48257DAD0008AE17");
 		};
	</script>

</body>
</html>
