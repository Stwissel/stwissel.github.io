<!DOCTYPE html>
<html lang="en">
<head>
<title>Put an angular face on your inbox - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Put an angular face on your inbox" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2014/09/put-an-angular-face-on-your-inbox.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Put an angular face on your inbox" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Put an angular face on your inbox - In the last installment I got vert.x to emit a Notes view, read from your local mail file, to be emitted as JSON stream. While that might be perfectly fine for the inner geek, normal mortals want to look (and interact) with something more pretty. The cool kids on the block for web interfaces and app" />
<meta name="Keywords"
	content="IBM Notes,JavaScript,Software,WebDevelopment," />
<meta name="Abstract"
	content="Put an angular face on your inbox - In the last installment I got vert.x to emit a Notes view, read from your local mail file, to be emitted as JSON stream. While that might be perfectly fine for the inner geek, normal mortals want to look (and interact) with something more pretty. The cool kids on the block for web interfaces and app" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/javascript.html">JavaScript</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-9PF3PZ" title="originally published at /blog/d6plinks/SHWL-9PF3PZ">SHWL-9PF3PZ</a>
	</li>
</ul>

		<div class="row-fluid">
			<div class="span12">
							<div class="well well-raised">
				<p>This article is part of a mini series. Read them all:</p>
				<h3>Make your own mail client</h3>
				<ol reversed class="nav nav-list">
					<li ><a href="/blog/2014/07/adventures-with-vertx-64bit-and-the-ibm-notes-client.html">Adventures with vert.x, 64Bit and the IBM Notes client</a></li>
					<li ><a href="/blog/2014/08/running-vertx-with-the-openntf-domino-api.html">Running vert.x with the OpenNTF Domino API</a></li>
					<li ><a href="/blog/2014/08/designing-a-rest-api-for-email.html">Designing a REST API for eMail</a></li>
					<li ><a href="/blog/2014/09/rendering-a-notes-view-as-json-rest-service-on-your-client.html">Rendering a Notes view as JSON REST service - on your client</a></li>
					<li  class="active"><a href="/blog/2014/09/put-an-angular-face-on-your-inbox.html">Put an angular face on your inbox</a></li>
					<li ><a href="/blog/2014/11/poking-around-the-inotes-http-api-part-1.html">Poking around the iNotes HTTP API (Part 1)</a></li>
					<li ><a href="/blog/2014/11/poking-around-the-inotes-http-api-part-2-fun-with-rhino.html">Poking around the iNotes HTTP API (Part 2) - Fun with Rhino</a></li>
					<li ><a href="/blog/2014/12/poking-around-the-inotes-http-api-part-3-retrieve-message-meta-data.html">Poking around the iNotes HTTP API (Part 3) - retrieve message meta data</a></li>
					<li ><a href="/blog/2015/12/mail-archive-with-apache-couchdb-ibm-cloudant-part-1.html">Mail archive with Apache CouchDB / IBM Cloudant - Part 1</a></li>
					<li ><a href="/blog/2016/02/disecting-a-mail-ui.html">Disecting a mail UI</a></li>
					<li ><a href="/blog/2016/02/vertx-and-domino.html">Vert.x and Domino</a></li>
				</ol>
			</div>	

				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/09/rendering-a-notes-view-as-json-rest-service-on-your-client.html"><i class="icon-hand-left"></i>Rendering a Notes view as JSON REST service - on your client</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2014/10/purpose.html">Purpose<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Put an angular face on your inbox</small></h1>
					<hr />
					<div>In the <a href="/blog/2014/09/rendering-a-notes-view-as-json-rest-service-on-your-client.html">last installment</a> I got vert.x to emit a Notes view, read from your local mail file, to be emitted as JSON stream. While that might be perfectly fine for the inner geek, normal mortals want to look (and interact) with something more pretty. 
<br>
 The cool kids on the block for web interfaces and applications are <a href="http://getbootstrap.com/">Twitter BootStrap</a> and <a href="https://angularjs.org/">AngularJS</a>, so these will be the tools in this installment. 
<br>
 Not familiar with them? Go and <a href="https://www.youtube.com/results?search_query=angularjs">watch some videos</a>. Back? Let's get going. 
<br>
 Since I'm not much of a designer, I choose the ready made <a href="http://www.almsaeedstudio.com/">Admin LTE</a> template based on bootstrap. The main reason for choosing this one, was a <a href="http://almsaeedstudio.com/AdminLTE/pages/UI/timeline.html">timeline layout</a> that I wanted for the inbox. 
<br>
 My inbox is already sorted by date, so it should fit nicely (so I thought). However the view optically is categorized by date and under the hood just a flat list of <code>&lt;li&gt;</code> elements. A little tweaking was necessary. The result looks quite OK for an after hour exercise: 
<br><img src="/blog/images/2014/mailbox-ng.png" border="0" alt="Alternate layout for the Inbox">
<br>
 The steps to get there: 
<ol>
 <li>Tweak the vert.x service to render a categorized by date version of the inbox. You can do that without touching the underlying view. I'll provide details on that modules in a later article (and some sample data below). The main difference for now: the inbox data will be available at the URL <code>/notes/categorized/($Inbox)</code></li>
 <li>Create templates and <a href="https://docs.angularjs.org/guide/directive">directives</a> for Angular</li>
 <li>Create the Angular.js app and its <a href="https://docs.angularjs.org/guide/concepts">Controllers</a></li>
</ol> Of course, no application is complete with a nice set of challenges. The biggest here was the flat list for the time line. I tried to adjust the CSS to accommodate a hierarchical list, where the outer elements are the date containing all messages arrived at that day, but there was too much CSS. So I decided to tweak the output a little.The JSON emitted from Notes now looks like this: 
<br>
<pre><code class="language-js">
{ "messagecount": 23, "messages": [
    {"date": "11 Oct. 2014", "events": [
         {"time": "17:05","sender": "John Doe","message": "message 1"}
    ]},
   {"date": "10 Oct. 2014", "events": [
       {"time": "16:30","sender": "Jane Doe","message": "message 2"},
       {"time": "14:00","sender": "Mogli Bear","message": "message 3"},
       {"time": "10:00","sender": "F. Zappa","message":"message 4"}
    ]
}]}</code></pre>
<br>
 In my page template I defined the Angular app and controller on the body level: 
<br>
<pre><code class="language-html">&lt;body class="skin-blue" ng-app="inbox" ng-controller="dayController as dc"&gt;&gt;</code></pre>
<br>
 This was necessary to be able to have the message count displayed in the upper right hand corner: 
<br><code>&lt;span class="label label-success"&gt;{{dc.messagecount}}&lt;/span&gt;</code>. 
<br>
 The template pieces are short, this is the main page (excerpt, download link below): 
<br>
<pre><code class="language-html">
&lt;section class="content"&gt;
 &lt;div class="row"&gt;
  &lt;div class="col-md-12"&gt;
   &lt;ul class="timeline"&gt;
    &lt;li class="time-label" time-line-start ng-repeat-start="day in dc.days"&gt;&lt;/li&gt;
    &lt;li time-line-end event="day.events[0]" day="day" ng-repeat-end&gt;&lt;/li&gt;
    &lt;li&gt;&lt;i class="fa fa-clock-o"&gt;&lt;/i&gt;&lt;/li&gt;
   &lt;/ul&gt;
  &lt;/div&gt;
 &lt;/div&gt;
&lt;/section&gt;
</code></pre>
<br>
 The interesting part in the above template are the <code>ng-repeat-start</code> and <code>ng-repeat-end</code> statements. What they do: for every date in the JSON, they will create two <code>&lt;li&gt;</code> entries: one for the date and one for the first message. Angular then needs to be convinced to expand that into all messages. More on that below. The individual message entries use this template: 
<br>
<pre><code class="language-html">
&lt;i class="fa fa-envelope bg-blue"&gt;&lt;/i&gt;
&lt;div class="timeline-item"&gt;
 &lt;span class="time"&gt;&lt;i class="fa fa-clock-o"&gt;&lt;/i&gt;{{event.time}}&lt;/span&gt;
    &lt;h3 class="timeline-header"&gt;&lt;a href="mailto:noreply"&gt;{{event.sender}}&lt;/a&gt; sent you an eMail&lt;/h3&gt;
    &lt;div class="timeline-body"&gt;
         {{event.message}}
    &lt;/div&gt;
    &lt;div class='timeline-footer'&gt;
       &lt;a class="btn btn-primary btn-xs"&gt;Read more...&lt;/a&gt;
       &lt;a class="btn btn-warning btn-xs"&gt;File&lt;/a&gt;
       &lt;a class="btn btn-danger btn-xs"&gt;Delete&lt;/a&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
<br>
 So far so good, now the final moving piece is the Angular app code. A little word of warning: the following code is a <b>ugly hack</b>. For production quality you would separate out the data fetching into a <a href="https://docs.angularjs.org/guide/concepts#service">service</a> and you add tests and error handling. Anyway, learning and poking around doesn't need this, so here you go: 
<pre><code class="language-js">
  angular.module('inbox', ['ngSanitize'])
   .controller('dayController', ['$http',dayMessages])
   .directive('timeLineStart', timeStartAccess)
   .directive('timeLineEnd', ['$compile',timeEndAccess])
   .directive('timeLine', timeAccess);
   
  function dayMessages($http) {
   var self = this;
   self.messageCount = 0;
   $http.get('days.json').then(function(response) {
    self.days = response.data.messages;
    self.messagecount = response.data.messagecount;
    console.log("Data fetched");
   }, function(errResponse) {
    console.error('Error while fetching menu data!');
   });
  }
  
  function timeStartAccess() {
   return {
    replace : false,
    transclude: true,
    scope : true,
    template : "&lt;span class='bg-red'&gt;{{day.date}}&lt;/span&gt;"
   };
  }
  
  function timeEndAccess($compile) {
   return {
    transclude: true,
    scope : {event : '=',
          day : '=' },
    template : "&lt;!-- messages from {{day.date}} --&gt;",
    link : function timeLink($scope, $element, $attrs) {
      var newHTML = "&lt;li event='event' time-line ng-repeat='event in day.events'&gt;&lt;/li&gt;";  
      var linkingFunction = $compile(newHTML);
      var elem = linkingFunction($scope);
      $element.after(elem);  
    }
   };
  }
  
  function timeAccess() {
   return {
    replace : false,
    scope : {event : '='},
    templateUrl : "demotimeline.html"
   };
  }
</code></pre>
<br>
 The interestin part is the <code>link</code> function in the timeEndAccess function. Since we have an outer loop over the date creating one li element per date, instead of one per message for that date, the function replaces that with a loop over the messages for that day. Seems to work quite nicely. The template contains Angular code, so it needs to compile, that's what <code>$compile</code> does for us. You can try for yourself, to run the Demo: 
<ol>
 <li>Download the <a href="http://almsaeedstudio.com/">Admin LTE template</a> and expand it</li>
 <li>Download my <a href="/blog/downloads/2014/demo.zip">sample files</a> and copy them into the directory where you have expanded the template. Put it into the template root</li>
 <li>Either download <a href="https://angularjs.org/">Angular.js</a> or edit my sample to point to a <a href="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-rc.3/angular.min.js">CDN</a></li>
 <li>Open <code>demoinbox.html</code> in your browser and enjoy</li>
</ol> The data is coming static from <code>days.js</code>, so no vert.x or Domino is required for you to have a look. As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 30 September 2014
<span class="divider">|</span>
<a href="/blog/2014/09/put-an-angular-face-on-your-inbox.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/ibmnotes.html">IBM Notes</a>  <a href="/blog/categories/javascript.html">JavaScript</a>  <a href="/blog/categories/software.html">Software</a>  <a href="/blog/categories/webdevelopment.html">WebDevelopment</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2014/09/put-an-angular-face-on-your-inbox.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_F39544920785ABD748257D630007E78B" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_F39544920785ABD748257D630007E78B"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2014/09/rendering-a-notes-view-as-json-rest-service-on-your-client.html"><i class="icon-hand-left"></i>Rendering a Notes view as JSON REST service - on your client</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2014/10/purpose.html">Purpose<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/">2014</a> <span class="divider">/</span></li>
  <li><a href="/blog/2014/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/javascript.html">JavaScript</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/webdevelopment.html">WebDevelopment</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-9PF3PZ" title="originally published at /blog/d6plinks/SHWL-9PF3PZ">SHWL-9PF3PZ</a>
	</li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="https://www.stickermule.com/u/43c09fe6343315f">Stickers from Stickermule</a></li>
						<li><a href="https://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a href="https://github.com/Stwissel">GitHub</a></li>
						<li><a href="https://bitbucket.org/stwissel/">Bitbucket</a></li>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2024 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2014/09/put-an-angular-face-on-your-inbox.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "F39544920785ABD748257D630007E78B");
 		};
	</script>

</body>
</html>
