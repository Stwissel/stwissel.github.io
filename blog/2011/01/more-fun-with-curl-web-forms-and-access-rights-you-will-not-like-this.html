<!DOCTYPE html>
<html lang="en">
<head>
<title>More fun with curl - Web forms and access rights (you will not like this) - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - More fun with curl - Web forms and access rights (you will not like this)" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2011/01/more-fun-with-curl-web-forms-and-access-rights-you-will-not-like-this.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - More fun with curl - Web forms and access rights (you will not like this)" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="More fun with curl - Web forms and access rights (you will not like this) - We had fun with curl and LotusLive before. Now lets have some fun with curl and web forms. To follow the fun you should download and install cURL (for Ubuntu users: sudo apt-get install curl). When discussing web enablement and XPages the topic of &#39;field validation&#39; pops up quite regular. My advice " />
<meta name="Keywords"
	content="Show-N-Tell Thursday," />
<meta name="Abstract"
	content="More fun with curl - Web forms and access rights (you will not like this) - We had fun with curl and LotusLive before. Now lets have some fun with curl and web forms. To follow the fun you should download and install cURL (for Ubuntu users: sudo apt-get install curl). When discussing web enablement and XPages the topic of &#39;field validation&#39; pops up quite regular. My advice " />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <script> 
var $buoop = {notify:{e:-0.01,f:-0.01,o:-0.01,s:-0.01,c:-0.01},insecure:true,unsupported:true,api:5}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.min.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script>

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/01/burncharts-in-xpages.html"><i class="icon-hand-left"></i>Burncharts in XPages</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/01/if-youre-attractive-enough-on-the-outside-.html">If you&apos;re attractive enough on the outside ...<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>More fun with curl - Web forms and access rights (you will not like this)</small></h1>
					<hr />
					<div>We had fun with <a href="/blog/2010/11/fun-with-lotuslive-curl-and-lotus-activities.html">curl and LotusLive</a> before. Now lets have some fun with curl and web forms. To follow the fun you should download and install <a href="http://curl.haxx.se/">cURL</a> (for <a href="http://www.ubuntu.com/">Ubuntu</a> users: <code>sudo apt-get install curl</code>). When discussing web enablement and <a href="http://xpages.info/">XPages</a> the topic of "field validation" pops up quite regular. My advice here stands firm: " <b><i>client side validation solely serves the comfort of the users (which is important) but never the integrity of your data</i></b>". More often than not I'm greeted with disbelieve. However at the very end what is send back to the server is just a HTTP post and the server developer has little control how that post was generated. In a <a href="http://www.getfirefox.com/">modern browser</a> one can use <a href="http://getfirebug.com/ ">Firebug</a> or <a href="http://www.greasespot.net/">GreaseMonkey</a> to alter the upload. All browsers can be redirected to send data via a local proxy (try <a href="http://axis.apache.org/axis/java/user-guide.html#AppendixUsingTheAxisTCPMonitorTcpmon">TCPMon</a> for fun or any <a href="http://www.google.com/search?q=local+proxy+software">other local proxy</a>). While that might be out of the reach of NMU <sup>*</sup>, a simple cURL command is not. I will use Domino as backend for my examples, however the approach applies to all type of backends: ASP, PHP, JSP, JSF, Ruby, NodeJS and whatever. Some of the considerations are Domino specific (around back-end behavior). 
<br> To send (HTTP POST) data to a server one can simply use <code>curl -F 'fieldname=fieldvalue' http://targeturl</code>. However that command line can get messy when there are a lot of fields and eventually authentication and redirections. So I will a) use a file as source for upload b) use the following command: <code>curl --netrc --data @<b>filename</b> --post301 --post302 <b>http://targeturl</b></code>. The parameters <code>post301, post302</code> make sure curl follows redirections if they occur without dropping the POST method, <code>--data @</code> uses a filename as source for the upload, finally <code>--netrc</code> tells curl to look in a secure (mode 600) file <i>.nerc</i> ( <i>_netrc</i> on Windows) for a line: <i>machine <b>hostname</b> login <b>username</b> password <b>password</b></i> (replace the bold parts with your information) if authentication is required. You can wrap this into a shell script to reduce typing. I created a simple form <i>Fruit</i> with 3 fields: <i>Subject, Color, Taste</i> and one view <i>Fruits</i> sorted by <i>subject</i> in my curldemo.nsf. Let the fun begin: 
<ol> 
 <li> 
  <ul> 
   <li><b>Test</b>: Post <code>Subject=Durian&amp;Color=White&amp;Taste=don't ask!!!</code> to <code>http://localhost/curldemo.nsf/fruit?CreateDocument</code><br> In this case an authorized user posts exactly the fields that are in the HTML form to the designated address. </li> 
   <li><b>Result/Insight</b>: Works as expected. You get a message back (with some html decoration) <i>Form processed</i>. </li> 
  </ul></li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Post <code>Subject=Apple&amp;Color=Green&amp;Taste=sour</code> to <code>"http://localhost/curldemo.nsf/fruit?OpenForm&amp;Seq=1"</code><br> One could expect the same result as in the first test, since it is all fields, a valid url and an authorized user. </li> 
   <li><b>Result/Insight</b>: Domino comes back with an empty form and no document gets created. On closer inspection you will find an extra hidden field "<i>__Click</i>" in the form Domino provides. So when you change your post data to <code>Subject=Apple&amp;Color=Green&amp;Taste=sour&amp;__Click=0</code> the document gets created as expected. </li> 
  </ul></li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Remove your user's right to create documents by demoting to author with "Create documents" unchecked. Post <code>Subject=Apple&amp;Color=Green&amp;Taste=sour</code> to <code>http://localhost/curldemo.nsf/fruit?CreateDocument</code> </li> 
   <li><b>Result/Insight</b>: As expected you get an HTTP Error 401 (not authorized) message </li> 
  </ul></li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Promote your user to Editor and post <code>Subject=Apple2&amp;Color=Green And Green&amp;Taste=deadly&amp;__Click=0</code> to <code>http://localhost/curldemo.nsf/Fruits/Apple2?EditDocument&amp;Seq=1</code> </li> 
   <li><b>Result/Insight</b>: The document gets saved back to the server and you get a "Form processed" message back. Works as expected. If you use a fruit name that doesn't exist you get a 404 - Entry not found in index error. You can change the key field when you post <code>Subject=Deadly Apple&amp;Color=Green And Green&amp;Taste=deadly&amp;__Click=0</code> </li> 
  </ul></li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Update the input validation formula of the Color field to <code>@If(@Trim(@ThisValue)="";@Failure("Please submit a color");@Success)</code>. Post <code>Subject=JackFruit</code> to <code>http://localhost/curldemo.nsf/Fruit?CreateDocument</code> In this example we only post a subset of the fields to create a document failing the server side validation </li> 
   <li><b>Result/Insight</b>: As expected the creation of the document fails and an error is returned. </li> 
  </ul> </li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Post <code>Color=Red And Green&amp;__Click=0</code> to <code>http://localhost/curldemo.nsf/Fruits/Deadly%20Apple?EditDocument&amp;Seq=1</code> In this example we only post a subset of the fields back to the form </li> 
   <li><b>Result/Insight</b>: The existing fields in the document are preserved and only the submitted values are updated. Works as expected. </li> 
  </ul> 
  <ol> 
   <br>So far we were playing nice and got expected results. Now let's get sneaky. 
   <br> 
   <br> 
  </ol></li> 
</ol><ol start="7"> 
 <li> 
  <ul> 
   <li><b>Test</b>: Post <code>Color=Blue&amp;Form=SuperFruit&amp;__Click=0</code> to <code>http://localhost/curldemo.nsf/Deadly%20Apple?EditDocument&amp;Seq=1</code> <i>Form</i> does exist as item in the document, but not as field in the form. </li> 
   <li><b>Result/Insight</b>: The color field is updated while the form field is silently dropped. This also holds true for other field names that are not in the form. In older versions of Domino submitting a field that didn't exist resulted in a HTTP error 500. So the Domino server is more forgiving what you can send, but still quite strict what it will process </li> 
  </ul></li> 
 <li> 
  <ul> 
   <li><b>Test</b>: Until now all fields we were posting to were visible html fields. A really interesting question however is: what happens to fields that are not rendered as visible html input fields: Fields with the attribute <code>type=hidden</code>, input fields marked as "hide from browser" (or any other hide-when formula), visible computed fields, hidden computed fields (both with the special case of having <code>@ThisValue</code> as formula, visible computed when composed fields, hidden computed when composed fields, visible computed for display fields and last not least hidden computed for display fields (an Oxymoron that only Domino developers can appreciate). </li> 
   <li><b>Result/Insight</b>: The table below shows the results: 
    <table class="investigation" border="0" cellpadding="4"></table> <style type="text/css">
.investigation .surprise {border : 4px solid red; font-size : bigger; color : red; background-color : #FFE0E0}
.investigation td {border-right : 1px solid gray; border-bottom : 1px solid gray; text-align : center}
.investigation th {border-right : 1px solid gray; border-bottom : 1px solid gray}
td.right, th.right {text-align : right}
.doesupdate {background-color: #E0FFE0}
.noupdate {background-color: #E0E0FF}
</style> Field type Visible Hidden by @HideWhen Standard input Note item gets updated Note item gets updated Not in Form posted value discarded posted value discarded Input type="hidden" Note item gets updated Note item gets updated Computed @ThisValue Note item gets updated Note item gets updated Computed posted value replaced by formula result posted value replaced by formula result Computed when composed Note item gets updated Note item gets updated Computed for display posted value discarded posted value discarded </li> 
  </ul> The results have quite some ramifications for your average workflow application! A typlical layout would be to use hide-when formulas depending on the role of the user and the current workflow status. Typically the submitter continues to have author access to a document, since (s)he can cancel the request until (or even after) final approval. The web form might not allow any changes to submitted values, but with a little curl that form is easily updated. In consequence: a secure web application must assign a value to the form field that only contains fields that should be editable by a given user and additional: the number of users in Author fields should be limited at all times to the bare minimum. Of course your webquerysave agent can check who is submitting and should (s)he be allowed to do that. To be fully on the safe site you can use the <a href="/blog/2009/05/notes-pattern-inversion-of-logging.html">inversion of logging</a> pattern. </li> 
</ol> There is plenty of good information about curl on <a href="http://superuser.com/questions/149329/how-do-i-make-a-post-request-with-curl">superuser.com</a>, details in the <a href="http://curl.haxx.se/docs/manual.html">curl manual</a>, or the <a href="http://curl.haxx.se/docs/httpscripting.html">curl scripting guide</a> (a better annotated version <a href="http://www.cs.sunysb.edu/documentation/curl/index.html">is here</a>). Depending on your application server and the "defenders" efforts you might need to deal with headers, cookies or referrers, all of this can be dealt with. 
<br>As usual: YMMV 
<br> 
<br> <sup>*</sup>NMU = <i>Normal Mortal User</i></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 16 January 2011
<span class="divider">|</span>
<a href="/blog/2011/01/more-fun-with-curl-web-forms-and-access-rights-you-will-not-like-this.html#comments">Comments (0)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a> 

						<div class="shariff" data-lang="en" data-url="https://www.wissel.net/blog/2011/01/more-fun-with-curl-web-forms-and-access-rights-you-will-not-like-this.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]" data-title="More fun with curl - Web forms and access rights (you will not like this)" data-twitter-via="@notessensei"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2011/01/more-fun-with-curl-web-forms-and-access-rights-you-will-not-like-this.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_BD0FC26B0070224E4825781A00228AD5" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_BD0FC26B0070224E4825781A00228AD5"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li id="nocomments">
							<h5>No comments yet, be the first to comment</h5>
						</li>
					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/01/burncharts-in-xpages.html"><i class="icon-hand-left"></i>Burncharts in XPages</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/01/if-youre-attractive-enough-on-the-outside-.html">If you&apos;re attractive enough on the outside ...<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2011/01/more-fun-with-curl-web-forms-and-access-rights-you-will-not-like-this.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
    <script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "BD0FC26B0070224E4825781A00228AD5");
 		};
	</script>

</body>
</html>
