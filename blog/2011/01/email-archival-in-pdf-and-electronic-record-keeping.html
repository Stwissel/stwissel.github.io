<!DOCTYPE html>
<html lang="en">
<head>
<title>eMail archival in PDF and electronic record keeping - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - eMail archival in PDF and electronic record keeping" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2011/01/email-archival-in-pdf-and-electronic-record-keeping.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - eMail archival in PDF and electronic record keeping" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2003,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="eMail archival in PDF and electronic record keeping - The question pops up quite regularly: &#39; Our compliance department has decided to use PDF/A for long term record storage, how can I save my eMail to it?&#39; (The question applies to ALL eMail systems). The short answer: Not as easy as you think. The biggest obstacle is legal need vs. user expectation. T" />
<meta name="Keywords"
	content="Show-N-Tell Thursday,Software," />
<meta name="Abstract"
	content="eMail archival in PDF and electronic record keeping - The question pops up quite regularly: &#39; Our compliance department has decided to use PDF/A for long term record storage, how can I save my eMail to it?&#39; (The question applies to ALL eMail systems). The short answer: Not as easy as you think. The biggest obstacle is legal need vs. user expectation. T" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/01/manifesto-for-software-craftsmanship.html"><i class="icon-hand-left"></i>Manifesto for Software Craftsmanship</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/02/productivity-work.html">Productivity @ Work<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>eMail archival in PDF and electronic record keeping</small></h1>
					<hr />
					<div>The question pops up quite regularly: " <i>Our compliance department has decided to use <a href="http://www.pdfa.org/">PDF/A</a> for long term record storage, how can I save my eMail to it?</i>" (The question applies to ALL eMail systems). The short answer: Not as easy as you think. The biggest obstacle is legal need vs. user expectation. To make that clear: I'm not a lawyer, this is not legal advise, just my opinion, talk to your legal counsel before taking action. User expectation (and thus problem awareness): "Storing as PDF is like storing on paper, so what's the big deal?" In reality electronic record keeping has a few different requirement (and NO printing an eMail as seen on screen is NOT record keeping - more on this in a second). Every jurisdiction has their own regulations, but they are strikingly similar (for the usual devil in the details ask your lawyer), so I just take Singapore's <a href="http://statutes.agc.gov.sg/non_version/cgi-bin/cgi_legdisp.pl?actno=2010-ACT-16-N&amp;doctitle=ELECTRONIC%20TRANSACTIONS%20ACT%202010%0A&amp;date=latest&amp;method=part&amp;sl=1">electronic transactions act</a> as a sample: 
<br><i> <b>Retention of electronic records</b><br> 9.&nbsp;â€”(1) &nbsp;&nbsp;Where a rule of law requires any document, record or information to be retained, or provides for certain consequences if it is not, that requirement is satisfied by retaining the document, record or information in the form of an electronic record if the following conditions are satisfied:<br> (a) the information contained therein remains accessible so as to be usable for subsequent reference;<br> (b) the electronic record is retained in the format in which it was originally generated, sent or received, or in a format which can be demonstrated to represent accurately the information originally generated, sent or received;<br> (c) such information, if any, as enables <span style="color : red">the identification of the origin and destination of an electronic record and the date and time when it was sent or received</span>, is retained; and<br> (d) any additional requirements relating to the retention of such electronic records specified by the public agency which has supervision over the requirement for the retention of such records are complied with.<br> </i> (colour emphasis mine) 
<br> So as there is "more than meets the eyes". A eMail record is only completely kept if you keep the header information. Now you have 2 possibilities: change the way you "print" to PDF to include all header / hidden fields (probably at the end of the message) or you use PDF capabilities to retain them accessible as PDF properties. The later case is more interesting since it resembles the user experience in your mail client: users don't see the "techie stuff" but it is a click away to have a peek. There are a number of ways how to create the PDF:<ul>
 <li>Use a commercial package like <a href="http://www.primeapple.co.uk/">DominoPDF</a>, <a href="http://www.agecom.com.au/export">AGE Exporter</a> or <a href="http://www.synaptris.com/">IntelliPrint</a> that are capable of generating PDF directly. They have their limitations of what they can output around signature and encryption. Big advantage: vendor support</li>
 <li>Use a PDF printer driver that can be programmed to automatically assign a known file name. Advantage: works like printing. Disadvantage: depends on the OS printing system</li>
 <li>Export your eMail as MIME or DXL and use a <a href="http://www.w3schools.com/xslt/">XSLT</a> transformation to generate <a href="http://www.w3schools.com/xslfo/">XSL:FO</a> that can be saved as PDF. There is <a href="http://xmlgraphics.apache.org/fop/">Apache FOP</a> and a series of <a href="http://www.w3schools.com/xslfo/xslfo_software.asp">commercial tools</a>. Advantage of this approach: you could have more than one pipeline (e.g. email, Notes apps, client apps, web apps) that end at the XSL:FO processor. Disadvantage: XSL:FO is simply a beast</li>
 <li>Generate the PDF in a discrete way using a Java library. Two Opensource libraries are quite popular: <a href="http://itextpdf.com/">iText</a> and <a href="http://pdfbox.apache.org/">PDFBox</a>. iText is Affero GPL licensed, so it might not be suitable for your project. PDFBox is licenced under the Apache license</li>
</ul> So now you have a PDF showing the visible part of your message (or document). Now it is time to add the (hidden) fields. In the sample below I used PDFBox and I exported all fields short of RichText. The first possibility is to use custom PDF properties. You also could think of: use XML Meta data, storing the entire document as roundtrip save DXL or store it as converted mime (if it isn't MIME already) as a meta data property. Adobe's Meta data specification is called <a href="http://www.adobe.com/devnet/xmp.html">XMP</a> (Extensible Metadata Platform) which is based on XML and makes heavy use of the <a href="http://dublincore.org/">Dublin Core</a> specification of <a href="http://www.w3.org/RDF/">RDF</a> (also known as <i>semantic web</i>). I like that since it is a good example of implementation of an open standard. 
<h3>Sample 1: Store all regular Notes fields as custom properties in PDF</h3>
<div class="java"><span class="co3">/**<br> &nbsp;* @param pDoc The PDF Document that will receive the meta data<br> &nbsp;* @param nDoc The Notes Document where the data will reside<br> &nbsp;* @throws NotesException <br> &nbsp;*/</span>
 <br> @SuppressWarnings <span class="br0">(</span><span class="st0">"unchecked"</span><span class="br0">)</span>
 <br><span class="kw1">public</span><span class="kw4">void</span> saveNoteToMeta <span class="br0">(</span>PDDocument pDoc, <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Adocument+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Document</span></a> nDoc <span class="br0">)</span><span class="kw1">throws</span> NotesException <span class="br0">{</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Avector+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">Vector</span></a> allItems <span class="sy0">=</span> nDoc. <span class="me1">getItems</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; PDDocumentInformation info <span class="sy0">=</span> pDoc. <span class="me1">getDocumentInformation</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span> i <span class="sy0">&lt;</span> allItems. <span class="me1">size</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span> i <span class="sy0">++</span><span class="br0">)</span><span class="br0">{</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; Item curItem <span class="sy0">=</span><span class="br0">(</span>Item <span class="br0">)</span> allItems. <span class="me1">get</span><span class="br0">(</span>i <span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">// TODO: exclude more items</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">if</span><span class="br0">(</span>curItem. <span class="me1">getType</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">!=</span> Item. <span class="me1">RICHTEXT</span><span class="sy0">&amp;&amp;</span> curItem. <span class="me1">getType</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">!=</span> Item. <span class="me1">ATTACHMENT</span><span class="sy0">&amp;&amp;</span> curItem. <span class="me1">getType</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">!=</span> Item. <span class="me1">EMBEDDEDOBJECT</span><span class="br0">)</span><span class="br0">{</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> itemName <span class="sy0">=</span> curItem. <span class="me1">getName</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href="http://www.google.com/search?hl=en&amp;q=allinurl%3Astring+java.sun.com&amp;btnI=I%27m%20Feeling%20Lucky"><span class="kw3">String</span></a> itemValue <span class="sy0">=</span> curItem. <span class="me1">getValueString</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; info. <span class="me1">setCustomMetadataValue</span><span class="br0">(</span>itemName, itemValue <span class="br0">)</span><span class="sy0">;</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="br0">}</span>
 <br> &nbsp; &nbsp; <span class="br0">}</span>
 <br><span class="br0">}</span>
</div> I will, so time permits, publish more samples for meta data storage: <i>Sample 2: Store all regular Notes fields as XML in PDF</i> , <i>Sample 3: Store the entire Note as XML in PDF</i> and <i>Sample 4: store the Note as MIME entries</i>. 
<br> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 26 January 2011
<span class="divider">|</span>
<a href="/blog/2011/01/email-archival-in-pdf-and-electronic-record-keeping.html#comments">Comments (3)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>  <a href="/blog/categories/software.html">Software</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2011/01/email-archival-in-pdf-and-electronic-record-keeping.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_90B9319DB27342344825782300570CD8" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_90B9319DB27342344825782300570CD8"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Jasper Duizendstra</b> on <i>Wednesday 26 January 2011 AD</i>:<br /> 
  Hi Stephan, How does the EML drag and drop functionality fit in this story? As far as I know there is no API yet, but it could function as a translation before generating the PDF. 
  <br /> 
  <br /> 
  <br /> 
  <br />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Warren Elsmore</b> on <i>Thursday 27 January 2011 AD</i>:<br /> 
  Stephan, 
  <br /> 
  <br />Personally, for any of these types of request we'd always recommend looking at an enterprise archiving solution that handles all this for you - and makes sure that you *cannot* 'loose' anything accidentally :) It's an infrastructure problem, not a development requirement IMHO. 
  <br /> 
  <br />IBM makes one, so do Symantec and a number of other vendors. I have strong views as to which is best though :)
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Thursday 27 January 2011 AD</i>:<br /> 
  @Jasper: the D&amp;D is just a representation of the API that has been there for a while. The challenge here is: MIME is not XML, so you have to hammer it into shape 
  <br /> 
  <br />@Warren: I concur. Nevertheless &quot;we want PDF&quot; is something that also applies to enterprise archival solutions. Storing the meta data inside the PDF (in addition to the archival database) has the huge advantage, that being self-contained a collection of PDF would &quot;survive&quot; a terminal destruction of the enterprise archival database. You simply rebuild it from the embedded meta data. 
  <br /> 
  <br />So in conclusion: an enterprise archival solution answers the question 
  <b>where</b> to store the data, while my little PDF musings are more around 
  <b>what</b> to store there. 
  <br /> 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" /> stw
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/01/manifesto-for-software-craftsmanship.html"><i class="icon-hand-left"></i>Manifesto for Software Craftsmanship</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/02/productivity-work.html">Productivity @ Work<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/software.html">Software</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2011/01/email-archival-in-pdf-and-electronic-record-keeping.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "90B9319DB27342344825782300570CD8");
 		};
	</script>

</body>
</html>
