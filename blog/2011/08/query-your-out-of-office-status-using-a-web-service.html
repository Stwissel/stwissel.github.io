<!DOCTYPE html>
<html lang="en">
<head>
<title>Query your Out-Of-Office status using a web service - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Query your Out-Of-Office status using a web service" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2011/08/query-your-out-of-office-status-using-a-web-service.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Query your Out-Of-Office status using a web service" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Query your Out-Of-Office status using a web service - In a more distributed working environment presence information becomes more and more important. In the consumer space you &#39;check in&#39; using various services, in the enterprise world where is less important than how, where how stands for: available, busy, unavailable etc. In the Lotus IBM Collaboratio" />
<meta name="Keywords"
	content="Show-N-Tell Thursday," />
<meta name="Abstract"
	content="Query your Out-Of-Office status using a web service - In a more distributed working environment presence information becomes more and more important. In the consumer space you &#39;check in&#39; using various services, in the enterprise world where is less important than how, where how stands for: available, busy, unavailable etc. In the Lotus IBM Collaboratio" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/08/">August</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8KXAJJ" title="originally published at /blog/d6plinks/SHWL-8KXAJJ">SHWL-8KXAJJ</a>
	</li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/08/capabilities-and-perception.html"><i class="icon-hand-left"></i>Capabilities and Perception</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/08/livetext-and-hashtags.html">LiveText and HashTags<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Query your Out-Of-Office status using a web service</small></h1>
					<hr />
					<div>In a more distributed working environment presence information becomes more and more important. In the consumer space you "check in" using <a href="http://www.google.com/search?&amp;q=location+aware+services">various services</a>, in the enterprise world <i>where</i> is less important than <i>how</i>, where <i>how</i> stands for: available, busy, unavailable etc. In the <strike> Lotus </strike> IBM Collaboration world we have multiple sources of status: the Sametime status, your IBM Connections status updates, the <a href="http://www.lotuslive.com/">IBM LotusLive</a> status and - for longer periods - your email out-of-office status. All but the last can easily kept in sync thanks <a href="http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/WildFire">WildFire</a>. Integrating the OOO service proves a little more tricky since it isn't exposed in a neutral API. So in a first step I designed a web service that can retrieve one or more OOO Status messages. In its first cut it ignores the OOO subject or the id of the requestor, but once you got the base version running it is easy to extend it. A few caveats: 
<ul>
 <li>You can (and probably should) place that web service in its own database. Access control to that database defines who can access that service</li>
 <li>You will need the <a href="http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/OpenLog">OpenLog</a> library in that database</li>
 <li>The service should be signed with the server ID, so it can read all mail files</li>
 <li>If you want to make it run across servers, you need to configure the servers to trust each other (check the Admin help for that)</li>
 <li>Since web services don't cache anything it is not the most performant option, so there is improvement potential</li>
 <li>There are 2 methods: one for just one status and one to retrieve a batch of them</li>
</ul>And here is the code: 
<div class="lotusscript"><span class="kw1">Public</span><span class="kw1">Class</span> OOOInfo 
 <br> &nbsp; &nbsp; <span class="kw1">Private</span> s <span class="kw1">As</span><span class="kw2">NotesSession</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span> db <span class="kw1">As</span><span class="kw2">NotesDatabase</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span> allNab <span class="kw1">As</span><span class="kw1">Variant</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span> isError <span class="kw1">As</span><span class="kw1">Boolean</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span> errorMsg <span class="kw1">As</span><span class="kw1">String</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Private</span><span class="kw1">Sub</span> initSessionAndDB 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Me</span>. <span class="me1">s</span><span class="kw1">Is</span><span class="kw1">Nothing</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span><span class="kw1">Me</span>. <span class="me1">s</span> = <span class="kw1">New</span><span class="kw2">NotesSession</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span><span class="kw1">Me</span>. <span class="me1">db</span> = s. <span class="me1">Currentdatabase</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; allNab = s. <span class="me1">AddressBooks</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Sub</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span><span class="kw1">Sub</span><span class="kw1">new</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span><span class="kw1">Me</span>. <span class="me1">initSessionAndDB</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Sub</span>
 <br> &nbsp; &nbsp; 
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; &nbsp; &nbsp; getOOOStatus<br> &nbsp; &nbsp; &nbsp; &nbsp; Description: Gets the status of one user name, there's the real work<br> %END REM</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span><span class="kw1">Function</span> getOOOStatus <span class="br0">(</span>who <span class="kw1">As</span><span class="kw1">String</span><span class="br0">)</span><span class="kw1">As</span> OOOResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> result <span class="kw1">As</span><span class="kw1">New</span> OOOResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> doc <span class="kw1">As</span><span class="kw2">NotesDocument</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">On</span><span class="kw1">Error</span><span class="kw1">Goto</span> Err_getOOOStatus 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> doc = <span class="kw1">Me</span>. <span class="me1">getUserDoc</span><span class="br0">(</span>who <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> doc <span class="kw1">Is</span><span class="kw1">Nothing</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'Here is the real work, retrieving the status</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> result = <span class="kw1">Me</span>. <span class="me1">getOOOfromNSF</span><span class="br0">(</span>doc. <span class="me1">Getitemvalue</span><span class="br0">(</span><span class="st0">"MailServer"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>,doc. <span class="me1">Getitemvalue</span><span class="br0">(</span><span class="st0">"MailFile"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">UserName</span> = doc. <span class="me1">GetItemValue</span><span class="br0">(</span><span class="st0">"FullName"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">InterNetMail</span> = doc. <span class="me1">GetItemValue</span><span class="br0">(</span><span class="st0">"InternetAddress"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">Status</span> = <span class="st0">"UserUnknown"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Exit_getOOOStatus: 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> getOOOStatus = result 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Err_getOOOStatus: 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> logError 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">status</span> = <span class="st0">"Error"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">message</span> = <span class="kw1">Error$</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Resume</span> Exit_getOOOStatus 
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; 
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; &nbsp; &nbsp; Function getOOOfromNSF<br> &nbsp; &nbsp; &nbsp; &nbsp; Description: Given an NSF Name retrieves the OOO Status and message<br> %END REM</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span><span class="kw1">Function</span> getOOOfromNSF <span class="br0">(</span>server <span class="kw1">As</span><span class="kw1">String</span>, mailFile <span class="kw1">As</span><span class="kw1">String</span><span class="br0">)</span><span class="kw1">As</span> OOOResult &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> result <span class="kw1">As</span><span class="kw1">New</span> OOOResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> mailDB <span class="kw1">As</span><span class="kw2">NotesDatabase</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> OOOProfile <span class="kw1">As</span><span class="kw2">NotesDocument</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">On</span><span class="kw1">Error</span><span class="kw1">Goto</span> Err_getOOOfromNSF 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span><span class="kw1">Me</span>. <span class="me1">initSessionAndDB</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> mailDB = <span class="kw1">New</span><span class="kw2">NotesDatabase</span><span class="br0">(</span>server, mailFile <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> mailDB. <span class="me1">Isopen</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> mailDB. <span class="kw1">Open</span><span class="br0">(</span><span class="st0">""</span>, <span class="st0">""</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> mailDB. <span class="me1">Isopen</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> OOOProfile = mailDB. <span class="me1">Getprofiledocument</span><span class="br0">(</span><span class="st0">"OutOfOfficeProfile"</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> OOOProfile. <span class="me1">Hasitem</span><span class="br0">(</span><span class="st0">"CurrentStatus"</span><span class="br0">)</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> OOOProfile. <span class="me1">Getitemvalue</span><span class="br0">(</span><span class="st0">"CurrentStatus"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> = <span class="st0">"0"</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">Status</span> = <span class="st0">"NoOOO"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">Status</span> = <span class="st0">"OK"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'//TODO: Do we need to specify different messages here?</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">message</span> = OOOProfile. <span class="me1">Getitemvalue</span><span class="br0">(</span><span class="st0">"GeneralMessage"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">returnDate</span> = <span class="kw1">Me</span>. <span class="me1">getISODate</span><span class="br0">(</span>OOOProfile. <span class="me1">Getitemvalue</span><span class="br0">(</span><span class="st0">"FirstDayOut"</span><span class="br0">)</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">Status</span> = <span class="st0">"NoOOO"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">Status</span> = <span class="st0">"Error"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">message</span> = <span class="st0">"Can't open mail file:"</span> &amp; mailFile 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Exit_getOOOfromNSF: 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">server</span> = server 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> getOOOfromNSF = result 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Err_getOOOfromNSF: 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> logError 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">status</span> = <span class="st0">"Error"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; result. <span class="me1">message</span> = <span class="kw1">Error$</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Resume</span> Exit_getOOOfromNSF 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; 
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; &nbsp; &nbsp; Function getISODate<br> &nbsp; &nbsp; &nbsp; &nbsp; Description: converts a Notes Date-time into ISO date<br> %END REM</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span><span class="kw1">Function</span> getISODate <span class="br0">(</span>raw <span class="kw1">As</span><span class="kw1">Variant</span><span class="br0">)</span><span class="kw1">As</span><span class="kw1">String</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> cur <span class="kw1">As</span><span class="kw2">NotesDateTime</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> cur = <span class="kw1">New</span><span class="kw2">NotesDateTime</span><span class="br0">(</span>raw <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'ToDo: fix this and get a proper date</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; getISODate = cur. <span class="me1">Dateonly</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; 
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; &nbsp; &nbsp; Function getUserDoc<br> &nbsp; &nbsp; &nbsp; &nbsp; Description: Retrieves the Notes Document with the user information<br> %END REM</span>
 <br> &nbsp; &nbsp; <span class="kw1">Private</span><span class="kw1">Function</span> getUserDoc <span class="br0">(</span>who <span class="kw1">As</span><span class="kw1">String</span><span class="br0">)</span><span class="kw1">As</span><span class="kw2">NotesDocument</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> doc <span class="kw1">As</span><span class="kw2">NotesDocument</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> nab <span class="kw1">As</span><span class="kw2">NotesDatabase</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> v <span class="kw1">As</span><span class="kw2">NotesView</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> i <span class="kw1">As</span><span class="kw1">Integer</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">On</span><span class="kw1">Error</span><span class="kw1">Goto</span> Err_getUserDoc 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'Loop through all NAB to make sure we get him</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">For</span> i = <span class="nu0">0</span><span class="kw1">To</span><span class="kw1">Ubound</span><span class="br0">(</span>allNab <span class="br0">)</span><span class="kw1">Step</span><span class="nu0">1</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> nab = allNab <span class="br0">(</span>i <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> &nbsp;nab. <span class="me1">IsOpen</span><span class="br0">(</span><span class="br0">)</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> nab. <span class="kw1">Open</span><span class="br0">(</span><span class="st0">""</span>, <span class="st0">""</span><span class="br0">)</span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> nab. <span class="me1">IsOpen</span><span class="br0">(</span><span class="br0">)</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> v = nab. <span class="me1">GetView</span><span class="br0">(</span><span class="st0">"($Users)"</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> v <span class="kw1">Is</span><span class="kw1">Nothing</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> doc = v. <span class="me1">GetDocumentByKey</span><span class="br0">(</span><span class="kw1">Lcase</span><span class="br0">(</span>who <span class="br0">)</span>, <span class="kw1">True</span><span class="br0">)</span><span class="co1">'$Users has lowercase keys</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> doc <span class="kw1">Is</span><span class="kw1">Nothing</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">For</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Next</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> getUserDoc = doc 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Exit_getUserDoc: 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> Err_getUserDoc : 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> logError 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> getUserDoc = <span class="kw1">Nothing</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Resume</span> Exit_getUserDoc 
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; 
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; &nbsp; &nbsp; getOOOStatus<br> &nbsp; &nbsp; &nbsp; &nbsp; Description: Gets the status of multiple user names<br> %END REM</span>&nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span><span class="kw1">Function</span> getMultipleOOOStatus <span class="br0">(</span>multiWho <span class="kw1">As</span> OOOMultiInput <span class="br0">)</span><span class="kw1">As</span> OOOMultiResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> i <span class="kw1">As</span><span class="kw1">Integer</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> result <span class="kw1">As</span> OOOResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> allSource <span class="kw1">As</span><span class="kw1">Variant</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; allSource = multiWho. <span class="me1">InputValues</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> getMultipleOOOStatus = <span class="kw1">New</span> OOOMultiResult 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> getMultipleOOOStatus. <span class="me1">resetSize</span><span class="br0">(</span><span class="kw1">Ubound</span><span class="br0">(</span>allSource <span class="br0">)</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">For</span> i = <span class="nu0">0</span><span class="kw1">To</span><span class="kw1">Ubound</span><span class="br0">(</span>allSource <span class="br0">)</span><span class="kw1">Step</span><span class="nu0">1</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> result = <span class="kw1">Me</span>. <span class="me1">getOOOStatus</span><span class="br0">(</span>allSource <span class="br0">(</span>i <span class="br0">)</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> getMultipleOOOStatus. <span class="me1">updateResult</span><span class="br0">(</span>result,i <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Next</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Function</span>
 <br> &nbsp; &nbsp; 
 <br><span class="kw1">End</span><span class="kw1">Class</span>
 <br>
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; Class OOOResult<br> &nbsp; &nbsp; Description: Return values for this user<br> %END REM</span>
 <br><span class="kw1">Public</span><span class="kw1">Class</span> OOOResult 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> Status <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'OK, NoOOO, UserUnknown, Error</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> Server <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'What server does the user come from</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> UserName <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'The fullName we found</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> InterNetMail <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'The Internet address</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> returnDate <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'//ToDo Decide on format</span>
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> message <span class="kw1">As</span><span class="kw1">String</span><span class="co1">'What's the message</span>
 <br><span class="kw1">End</span><span class="kw1">Class</span>
 <br>
 <br>
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; Class OOOMultiInput<br> &nbsp; &nbsp; Description: Array for multiple queries<br> %END REM</span>
 <br><span class="kw1">Public</span><span class="kw1">Class</span> OOOMultiInput 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> InputValues <span class="br0">(</span><span class="br0">)</span><span class="kw1">As</span><span class="kw1">String</span>
 <br><span class="kw1">End</span><span class="kw1">Class</span>
 <br>
 <br>
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; Class OOOMultiResult<br> &nbsp; &nbsp; Description: Array for multiple output values<br> %END REM</span>
 <br><span class="kw1">Public</span><span class="kw1">Class</span> OOOMultiResult 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span> ResultValues <span class="br0">(</span><span class="br0">)</span><span class="kw1">As</span> OOOResult 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span><span class="kw1">Sub</span> resetSize <span class="br0">(</span>index <span class="kw1">As</span><span class="kw1">Integer</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Redim</span> ResultValues <span class="br0">(</span>index <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Sub</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Public</span><span class="kw1">Sub</span> updateResult <span class="br0">(</span>newResult <span class="kw1">As</span> OOOResult, index <span class="kw1">As</span><span class="kw1">Integer</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Ubound</span><span class="br0">(</span>ResultValues <span class="br0">)</span> &lt; index <span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Redim</span><span class="kw1">Preserve</span> ResultValues <span class="br0">(</span>index <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> resultValues <span class="br0">(</span>index <span class="br0">)</span> = newResult 
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">Sub</span>
 <br><span class="kw1">End</span><span class="kw1">Class</span>
</div> Specify <code>OOOInfo</code> as your Port type class in the info box (Alt+Enter). If your database's name is ooo.nsf and you called the webservice query you can retrieve the wsdl using a url like this: <code>http://www.myserver.org/ooo.nsf/query?wsdl</code>. Next stop: The same as XPages based REST service. 
<br> As usual: YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 21 August 2011
<span class="divider">|</span>
<a href="/blog/2011/08/query-your-out-of-office-status-using-a-web-service.html#comments">Comments (2)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2011/08/query-your-out-of-office-status-using-a-web-service.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_73899AFFC26270C7482578F30027EA1C" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_73899AFFC26270C7482578F30027EA1C"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Gernot Hummer</b> on <i>Sunday 21 August 2011 AD</i>:<br /> 
  This is a very interesting approach, Stephan. To me Domino Web Services are very underrated. We are currently working on an XML Hub for easy data extraction from any Domino source (the user has access to) and it works pretty well. 
  <br /> 
  <br />This feature of yours might be interesting in project member statuses of bigger projects, one of the things I could think of.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Sunday 21 August 2011 AD</i>:<br /> 
  Gernot, you might be able to save yourself the trouble since a generalized web service engine for Domino is already on offer called 
  <a href="http://www.qkom.net/ibmdomino/soapgateq">soapGate Q!</a> by 
  <a href="http://www.qkom">QCom</a>, unless of course you want to compete with them. 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" /> stw
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2011/08/capabilities-and-perception.html"><i class="icon-hand-left"></i>Capabilities and Perception</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2011/08/livetext-and-hashtags.html">LiveText and HashTags<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/">2011</a> <span class="divider">/</span></li>
  <li><a href="/blog/2011/08/">August</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8KXAJJ" title="originally published at /blog/d6plinks/SHWL-8KXAJJ">SHWL-8KXAJJ</a>
	</li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2011/08/query-your-out-of-office-status-using-a-web-service.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "73899AFFC26270C7482578F30027EA1C");
 		};
	</script>

</body>
</html>
