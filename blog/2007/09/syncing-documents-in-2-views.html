<!DOCTYPE html>
<html lang="en">
<head>
<title>Syncing documents in 2 views - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Syncing documents in 2 views" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2007/09/syncing-documents-in-2-views.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Syncing documents in 2 views" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Syncing documents in 2 views - I got quite some requests on the details of the syncing documents in views pattern/anti-pattern.So this is what you need to do: Have 2 views with identical keys, sorted by the key Julian&#39;s OpenLog database The main function SyncAllDocument 3 auxiliary functions: getCompareKeySource, getCompareKeyTar" />
<meta name="Keywords"
	content="Show-N-Tell Thursday," />
<meta name="Abstract"
	content="Syncing documents in 2 views - I got quite some requests on the details of the syncing documents in views pattern/anti-pattern.So this is what you need to do: Have 2 views with identical keys, sorted by the key Julian&#39;s OpenLog database The main function SyncAllDocument 3 auxiliary functions: getCompareKeySource, getCompareKeyTar" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/09/domino-anti-pattern-delete-and-recreate.html"><i class="icon-hand-left"></i>Domino Anti-Pattern: Delete and Recreate</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/09/customizing-system-templates.html">Customizing system templates<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Syncing documents in 2 views</small></h1>
					<hr />
					<div>I got quite some requests on the <a href="/blog/2007/09/domino-anti-pattern-delete-and-recreate.html">details of the syncing documents</a> in views pattern/anti-pattern.So this is what you need to do: 
<ol> 
 <li>Have 2 views with identical keys, sorted by the key</li> 
 <li>Julian's <a href="http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/OpenLog">OpenLog database</a></li> 
 <li>The main function SyncAllDocument</li> 
 <li>3 auxiliary functions: getCompareKeySource, getCompareKeyTarget and updateSourceDoc</li> 
</ol> In my example code I made the assumption, that the documents contain the same fields and have a single key. You might have different requirements like computing things and/or only coying part of the items or do a computewithform before saving. Nevertheless you don't need to touch the main routine for that. You get the idea.<br> 
<style>.lotusscript { font-family: verdana, sans-serif; font-size: 9pt; color: black; }
.ls-comment { color: green; }
.ls-quote { color: black; }
.ls-datatype { color: black; }
.ls-operator { color: blue; }
.ls-keyword { color: blue; }
.ls-statement { color: blue; }
.ls-function { color: blue; }
.ls-class { color: black; }
.ls-constant { color: purple; }
</style> 
<pre>
 
 <div class="lotusscript">

<font class="ls-keyword">Option</font>

<font class="ls-keyword">Public</font>

<font class="ls-keyword">Option</font>

<font class="ls-keyword">Declare</font>

<font class="ls-statement">Use</font>

<font class="ls-quote">"OpenLogFunctions"</font>

<font class="ls-statement">Function</font> getCompareKey

<font class="ls-operator">(</font>doc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-operator">)</font>

<font class="ls-keyword">As</font>

<font class="ls-keyword">String</font>
getCompareKey

<font class="ls-operator">=</font> doc

<font class="ls-operator">.</font>getitemvalues

<font class="ls-operator">(</font>

<font class="ls-quote">"someidfield"</font>

<font class="ls-operator">)</font>

<font class="ls-operator">(</font>0

<font class="ls-operator">)</font>

<font class="ls-statement">End</font>

<font class="ls-statement">Function</font>

<font class="ls-statement">Sub</font> updateSourcedoc

<font class="ls-operator">(</font>curDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-operator">,</font> newDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-operator">)</font>

<font class="ls-comment">'We only save if the items have changed! </font>

<font class="ls-statement">Dim</font> saveFlag

<font class="ls-keyword">As</font>

<font class="ls-keyword">Boolean</font>

<font class="ls-statement">Dim</font> curItem

<font class="ls-keyword">As</font>

<font class="ls-class">NotesItem</font>

<font class="ls-statement">Dim</font> newItem

<font class="ls-keyword">As</font>

<font class="ls-class">NotesItem</font>

<font class="ls-statement">On</font>

<font class="ls-function">Error</font>

<font class="ls-keyword">Goto</font> Err_updateSourcedoc
saveFlag

<font class="ls-operator">=</font>

<font class="ls-constant">False</font>

<font class="ls-statement">Forall</font> it In newDoc

<font class="ls-operator">.</font>Items

<font class="ls-statement">Set</font> newItem

<font class="ls-operator">=</font> it

<font class="ls-statement">If</font> curDoc

<font class="ls-operator">.</font>HasItem

<font class="ls-operator">(</font>newItem

<font class="ls-operator">.</font>

<font class="ls-function">Name</font>

<font class="ls-operator">)</font>

<font class="ls-statement">Then</font>

<font class="ls-statement">Set</font> curItem

<font class="ls-operator">=</font> curDoc

<font class="ls-operator">.</font>GetFirstItem

<font class="ls-operator">(</font>newItem

<font class="ls-operator">.</font>

<font class="ls-function">Name</font>

<font class="ls-operator">)</font>

<font class="ls-statement">If</font> curItem

<font class="ls-operator">.</font>

<font class="ls-constant">Text</font>

<font class="ls-operator">&lt;</font>

<font class="ls-operator">&gt;</font> newitem

<font class="ls-operator">.</font>

<font class="ls-constant">Text</font>

<font class="ls-statement">Then</font>

<font class="ls-function">Call</font> curItem

<font class="ls-operator">.</font>

<font class="ls-keyword">Remove</font>

<font class="ls-function">Call</font> newItem

<font class="ls-operator">.</font>CopyItemToDocument

<font class="ls-operator">(</font>curDoc

<font class="ls-operator">,</font>newItem

<font class="ls-operator">.</font>

<font class="ls-function">Name</font>

<font class="ls-operator">)</font>
saveFlag

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">Else</font>

<font class="ls-function">Call</font> newItem

<font class="ls-operator">.</font>CopyItemToDocument

<font class="ls-operator">(</font>curDoc

<font class="ls-operator">,</font>newItem

<font class="ls-operator">.</font>

<font class="ls-function">Name</font>

<font class="ls-operator">)</font>
saveFlag

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">End</font>

<font class="ls-statement">Forall</font>

<font class="ls-comment">'Todo Optional: remove items that don't exist anymore</font>

<font class="ls-statement">If</font> saveFlag

<font class="ls-statement">Then</font>

<font class="ls-function">Call</font> curDoc

<font class="ls-operator">.</font>Save

<font class="ls-operator">(</font>

<font class="ls-constant">True</font>

<font class="ls-operator">,</font>

<font class="ls-constant">True</font>

<font class="ls-operator">)</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>
Exit_updateSourcedoc

<font class="ls-operator">:</font>

<font class="ls-statement">Exit</font>

<font class="ls-statement">Sub</font>
Err_updateSourcedoc

<font class="ls-operator">:</font>

<font class="ls-function">Call</font> LogErrorEx

<font class="ls-operator">(</font>

<font class="ls-quote">""</font>

<font class="ls-operator">,</font>SEVERITY_HIGH

<font class="ls-operator">,</font>curDoc

<font class="ls-operator">)</font>

<font class="ls-statement">Resume</font> Exit_updateSourcedoc

<font class="ls-statement">End</font>

<font class="ls-statement">Sub</font>

<font class="ls-statement">Function</font> SyncAllDocuments

<font class="ls-operator">(</font>sourceView

<font class="ls-keyword">As</font>

<font class="ls-class">NotesView</font>

<font class="ls-operator">,</font> targetView

<font class="ls-keyword">As</font>

<font class="ls-class">NotesView</font>

<font class="ls-operator">)</font>

<font class="ls-keyword">As</font>

<font class="ls-keyword">Boolean</font>

<font class="ls-comment">'The documents to be compared</font>

<font class="ls-statement">Dim</font> SourceDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-statement">Dim</font> nextSourceDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-statement">Dim</font> targetDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-statement">Dim</font> nextTargetDoc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-comment">'Auxiliary variables</font>

<font class="ls-statement">Dim</font> gotoNextSource

<font class="ls-keyword">As</font>

<font class="ls-keyword">Boolean</font>

<font class="ls-statement">Dim</font> gotoNextTarget

<font class="ls-keyword">As</font>

<font class="ls-keyword">Boolean</font>

<font class="ls-statement">Dim</font> sourceKey

<font class="ls-keyword">As</font>

<font class="ls-keyword">String</font>

<font class="ls-statement">Dim</font> targetKey

<font class="ls-keyword">As</font>

<font class="ls-keyword">String</font>

<font class="ls-statement">On</font>

<font class="ls-function">Error</font>

<font class="ls-keyword">Goto</font> Err_SyncAllDocuments

<font class="ls-comment">'Important: the two views are designed that at the end of this algorythm both views have the same number of documents</font>

<font class="ls-comment">'with the same data in it.</font>
gotoNextSource

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'We need to set this to get the loop started</font>
gotoNextTarget

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'We need to set this to get the loop started</font>

<font class="ls-statement">Set</font> sourceDoc

<font class="ls-operator">=</font> SourceView

<font class="ls-operator">.</font>GetFirstDocument

<font class="ls-statement">Set</font> targetDoc

<font class="ls-operator">=</font> TargetView

<font class="ls-operator">.</font>GetFirstDocument

<font class="ls-comment">'This is the outer loop running through the documents in this database</font>

<font class="ls-comment">'The "inner" loop is for the target database</font>

<font class="ls-statement">Do</font> Until sourceDoc

<font class="ls-operator">Is</font>

<font class="ls-constant">Nothing</font>

<font class="ls-statement">If</font> gotoNextSource

<font class="ls-statement">Then</font>

<font class="ls-comment">'Since we just advanced to the current source we need to know the next one</font>

<font class="ls-statement">Set</font> nextSourceDoc

<font class="ls-operator">=</font> SourceView

<font class="ls-operator">.</font>GetNextDocument

<font class="ls-operator">(</font>sourceDoc

<font class="ls-operator">)</font>

<font class="ls-comment">'This must be BEFORE any action with the doc</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">If</font> targetDoc

<font class="ls-operator">Is</font>

<font class="ls-constant">Nothing</font>

<font class="ls-statement">Then</font>

<font class="ls-comment">'We don't have any target documents, so we copy point blank</font>

<font class="ls-function">Call</font> sourceDoc

<font class="ls-operator">.</font>CopyToDatabase

<font class="ls-operator">(</font>targetView

<font class="ls-operator">.</font>Parent

<font class="ls-operator">)</font>
gotoNextSource

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'We can read the next source document</font>
gotoNextTarget

<font class="ls-operator">=</font>

<font class="ls-constant">False</font>

<font class="ls-comment">'We are already at nothing for the target</font>

<font class="ls-statement">Else</font>

<font class="ls-comment">'Since targetdocument exists we can get the next target document now if we need it</font>

<font class="ls-statement">If</font> gotoNextTarget

<font class="ls-statement">Then</font>

<font class="ls-comment">'Since we just advanced to the current target we need to know the next one</font>

<font class="ls-statement">Set</font> nextTargetDoc

<font class="ls-operator">=</font> targetView

<font class="ls-operator">.</font>GetNextDocument

<font class="ls-operator">(</font>targetDoc

<font class="ls-operator">)</font>

<font class="ls-comment">'This must be BEFORE any action with the doc</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-comment">'Now we need to compare the keys</font>
sourceKey

<font class="ls-operator">=</font> getCompareKeySource

<font class="ls-operator">(</font>sourceDoc

<font class="ls-operator">)</font>
targetKey

<font class="ls-operator">=</font> getCompareKeyTarget

<font class="ls-operator">(</font>targetDoc

<font class="ls-operator">)</font>

<font class="ls-statement">If</font> sourceKey

<font class="ls-operator">=</font> targetKey

<font class="ls-statement">Then</font>

<font class="ls-comment">'We found an existing document and would need to update it if values have changed</font>

<font class="ls-function">Call</font> updateSourcedoc

<font class="ls-operator">(</font>sourceDoc

<font class="ls-operator">,</font> targetDoc

<font class="ls-operator">)</font>

<font class="ls-comment">'We can move our pointer one up for source and target documents</font>
gotoNextSource

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>
gotoNextTarget

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-statement">Elseif</font> sourceKey

<font class="ls-operator">&gt;</font> targetKey

<font class="ls-statement">Then</font>

<font class="ls-comment">'We found a document that doesn't exist in the source database anymore</font>

<font class="ls-comment">'so we need to remove that from the target database</font>

<font class="ls-function">Call</font> targetDoc

<font class="ls-operator">.</font>

<font class="ls-keyword">Remove</font>

<font class="ls-operator">(</font>

<font class="ls-constant">True</font>

<font class="ls-operator">)</font>
gotoNextSource

<font class="ls-operator">=</font>

<font class="ls-constant">False</font>

<font class="ls-comment">'We stay on the source until we get even or less with the key</font>
gotoNextTarget

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'We just removed the document</font>

<font class="ls-statement">Else</font>

<font class="ls-comment">'We have a source document that is not yet in the target database, We just copy it over.</font>

<font class="ls-function">Call</font> sourceDoc

<font class="ls-operator">.</font>CopyToDatabase

<font class="ls-operator">(</font>targetView

<font class="ls-operator">.</font>Parent

<font class="ls-operator">)</font>
gotoNextSource

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'We just copied this document we move on</font>
gotoNextTarget

<font class="ls-operator">=</font>

<font class="ls-constant">False</font>

<font class="ls-comment">'They key was too big, so we need to wait </font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-comment">'Advance the pointers</font>

<font class="ls-statement">If</font> gotoNextSource

<font class="ls-statement">Then</font>

<font class="ls-statement">Set</font> sourceDoc

<font class="ls-operator">=</font> nextSourceDoc

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">If</font> gotoNextTarget

<font class="ls-statement">Then</font>

<font class="ls-statement">Set</font> targetDoc

<font class="ls-operator">=</font> nextTargetDoc

<font class="ls-statement">End</font>

<font class="ls-statement">If</font>

<font class="ls-statement">Loop</font>

<font class="ls-comment">'Finally we need to remove all documents in the target view that are still here since</font>

<font class="ls-comment">'We ran out of source documents</font>

<font class="ls-comment">'If we ran out of target documents already targetDoc is nothing aready</font>

<font class="ls-statement">Do</font> Until targetDoc

<font class="ls-operator">Is</font>

<font class="ls-constant">Nothing</font>

<font class="ls-statement">Set</font> nextTargetDoc

<font class="ls-operator">=</font> targetView

<font class="ls-operator">.</font>getNextDocument

<font class="ls-operator">(</font>targetDoc

<font class="ls-operator">)</font>

<font class="ls-function">Call</font> targetDoc

<font class="ls-operator">.</font>

<font class="ls-keyword">Remove</font>

<font class="ls-operator">(</font>

<font class="ls-constant">True</font>

<font class="ls-operator">)</font>

<font class="ls-statement">Set</font> targetDoc

<font class="ls-operator">=</font> nextTargetDoc

<font class="ls-statement">Loop</font>
SyncAllDocuments

<font class="ls-operator">=</font>

<font class="ls-constant">True</font>

<font class="ls-comment">'If we got here it worked</font>
Exit_SyncAllDocuments

<font class="ls-operator">:</font>

<font class="ls-statement">Exit</font>

<font class="ls-statement">Function</font>
Err_SyncAllDocuments

<font class="ls-operator">:</font>
SyncAllDocuments

<font class="ls-operator">=</font>

<font class="ls-constant">False</font>
LogError

<font class="ls-statement">Resume</font> Exit_SyncAllDocuments

<font class="ls-statement">End</font>

<font class="ls-statement">Function</font>

<font class="ls-statement">Function</font> getCompareKeySource

<font class="ls-operator">(</font>doc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-operator">)</font>

<font class="ls-keyword">As</font>

<font class="ls-keyword">String</font>
getCompareKeySource

<font class="ls-operator">=</font> getCompareKey

<font class="ls-operator">(</font>doc

<font class="ls-operator">)</font>

<font class="ls-statement">End</font>

<font class="ls-statement">Function</font>

<font class="ls-statement">Function</font> getCompareKeyTarget

<font class="ls-operator">(</font>doc

<font class="ls-keyword">As</font>

<font class="ls-class">NotesDocument</font>

<font class="ls-operator">)</font>

<font class="ls-keyword">As</font>

<font class="ls-keyword">String</font>
getCompareKeyTarget

<font class="ls-operator">=</font> getCompareKey

<font class="ls-operator">(</font>doc

<font class="ls-operator">)</font>

<font class="ls-statement">End</font>

<font class="ls-statement">Function</font>

 
 </div></pre> 
<div style="FONT-SIZE: 8pt; COLOR: gray; FONT-FAMILY: sans-serif; BORDER: 1 solid Grey; margin : 5px 50px 5px 50px;"> 
 <center>
   This LotusScript was converted to HTML using the <b><i>ls2html</i></b> routine, 
  <br>provided by Julian Robichaux at <a href="http://www.nsftools.com" target="_blank">nsftools.com</a>. 
 </center> 
</div></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 21 September 2007
<span class="divider">|</span>
<a href="/blog/2007/09/syncing-documents-in-2-views.html#comments">Comments (3)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2007/09/syncing-documents-in-2-views.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_9937BD66C8363D8F4825735D003DA421" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_9937BD66C8363D8F4825735D003DA421"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Monday 24 September 2007 AD</i>:<br /> 
  @William, 
  <br />thx for pointing out. You are right. Code fixed. 
  <br /> 
  <img src="/blog/images/emoticons/smile.gif" border="0" alt="Emoticon smile.gif" /> stw
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>William Ryken</b> on <i>Monday 24 September 2007 AD</i>:<br /> 
  thanks for the contribution to the community. 
  <br />one small logic typo... in the inner loop of the SyncAllDocuments function. 
  <br />Right after If targetDoc is Nothing, you're setting gotoNextSource twice. 
  <br />I'm thinking that you meant gotoNextSource = True, and then gotoNextTarget = False. 
  <br />You may want to make a small edit, just in case someone tries to cut-and-paste the code. 
  <br />Cheers.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Nick Wall</b> on <i>Monday 24 September 2007 AD</i>:<br /> 
  Very nice. 
  <br /> 
  <br />What I am about to mention takes away some of the &quot;dynamicness&quot; of the code, but if you are running into performance issues...just throwing another idea out there... 
  <br /> 
  <br />If the documents that have changed versus total docs in the view is small, in the updateSourceDoc routine, what you can also do is have column 2 of each view concactenate the fields, e.g. 
  <br />View1, column2 = Field1 + &quot;~&quot; + Field2 + &quot;~&quot; + @Implode(MultiField1;&quot;^&quot;) + Field4...etc, 
  <br /> 
  <br />View2 column2 = Field1 + &quot;~&quot; + Field2... 
  <br /> 
  <br />Since the docs are in a view, you can compare the doc.ColumnValues( 1 ), and if they are different, then start the cycle through the fields. This should speed up the iteration. If you used NotesViewEntries, and only referenced the NotesDocument if you began the iteration through the NotesItems, this should speed it up even more. The side effect will be that the view indeces will go up on each view, plus it's only checking if the fields you have concatenated in the view column have changed.
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/09/domino-anti-pattern-delete-and-recreate.html"><i class="icon-hand-left"></i>Domino Anti-Pattern: Delete and Recreate</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/09/customizing-system-templates.html">Customizing system templates<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2007/09/syncing-documents-in-2-views.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "9937BD66C8363D8F4825735D003DA421");
 		};
	</script>

</body>
</html>
