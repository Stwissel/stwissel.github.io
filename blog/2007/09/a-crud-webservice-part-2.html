<!DOCTYPE html>
<html lang="en">
<head>
<title>A CRUD webservice - Part 2 - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - A CRUD webservice - Part 2" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2007/09/a-crud-webservice-part-2.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - A CRUD webservice - Part 2" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="A CRUD webservice - Part 2 - In Part 1 of this Show-N-Tell Thursday I showed how to generate a WSDL definition out of a Notes form. While this is nice, it leaves quite a bit of work to actually implement the service. In this installment we take the opposite route. Instead of generating a WSDL definition, LotusScript code will b" />
<meta name="Keywords"
	content="Show-N-Tell Thursday," />
<meta name="Abstract"
	content="A CRUD webservice - Part 2 - In Part 1 of this Show-N-Tell Thursday I showed how to generate a WSDL definition out of a Notes form. While this is nice, it leaves quite a bit of work to actually implement the service. In this installment we take the opposite route. Instead of generating a WSDL definition, LotusScript code will b" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/09/software-pricing-and-software-risk.html"><i class="icon-hand-left"></i>Software Pricing and Software Risk</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/09/michael-vizard-on-microsoft-exchange.html">Michael Vizard on Microsoft Exchange<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>A CRUD webservice - Part 2</small></h1>
					<hr />
					<div>In Part 1 of this Show-N-Tell Thursday I showed how to generate a <a href="/blog/2006/12/designing-a-crud-webservice-for-a-domino-form.html">WSDL definition out of a Notes form</a>. While this is nice, it leaves quite a bit of work to actually implement the service. In this installment we take the opposite route. Instead of generating a WSDL definition, LotusScript code will be generated out of a Form definition. Unfortunately DXL doesn't support Web services very well (at least up to R8.0), so I will generate a text file that contains pure LotusScript code. This text file needs to be manually imported into an empty Web service (Copy and paste will do). 
<br> 
<br>I generate a few classes including a custom class which you can overwrite to implement your specific additions to the code. You might want to put that into a different library, so you keep your customization. Nota bene: the generated code is not real production quality. I haven't implemented good logging or error handling ( <a href="http://www.openntf.org/Projects/pmt.nsf/ProjectLookup/OpenLog">OpenLog</a> anybody). Once you see the code you get the idea and can complete that easily (feedback would be nice). 
<br> 
<br>A web service requires a LotusScript class with public members, properties and/or functions. Domino Designer will then generate a WSDL file for us. One path to travel would be implementing generic code, that takes fields as name/value pairs. While tempting this has the clear disadvantage, that the web service becomes rather unspecific and we can't take advantage of a strong validation using XML schema. So my approach is to analyze the form and generate 2 XML structures: one for all input fields, used to create and update a document and one for all fields used to read a document. I don't take hide-when formulas into account. 
<br> 
<br>There are a few challenges to overcome. First we need to deal with multi-value fields. In WSDL these are expressed as Arrays. Secondly we need to map the Domino data types to WSDL data types. Luckily half of the work is done since <a href="http://www-12.lotus.com/ldd/doc/domino_notes/7.0/help7_designer.nsf/855dc7fcfd5fec9a85256b870069c0ab/bc4627f58ea92d998525704a003fba96?OpenDocument">Domino includes "lsxds.lss"</a> It translates WSDL data types into LotusScript. From LotusScript to NotesItems is a path well travelled. 
<br> 
<br>Let's have a look at the XSLT stylesheet (if you don't know how to translate DXL using XSLT <a href="https://addons.mozilla.org/en-US/firefox/addon/2897">use this plug-in</a> -- you are using FireFox are you?) 
<br> 
<br>To instruct the XSLT processor to output plain text rather than XML or HTML we use this statement: 
<br> <tt>&lt;xsl:output</tt> <tt> indent=</tt> <tt>"yes"</tt> <tt> method=</tt> <tt>"text"</tt> <tt> omit-xml-declaration=</tt> <tt>"yes"</tt> <tt> media-type=</tt> <tt>"text/lotuscript"</tt> <tt> xml:space=</tt> <tt>"preserve"</tt> <tt> </tt> <tt>/&gt;</tt> 
<br> 
<br>Then inside the root tag the LotusScript Code is written as you would write in Domino Designer. 
<br> <tt>&nbsp; </tt> <tt>&lt;xsl:template</tt> <tt> match=</tt> <tt>"/"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;!-- We use the build-in data type mapping for LotusScript agents --&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; %INCLUDE "lsxsd.lss"</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; ' &nbsp;Autogenerated code to be embedded into a Domino Web Service</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public Class form</tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> 
<br> 
<br>We have 2 levels of comments here. XSLT Comments looking like this: &lt;!-- ... --&gt; and regular LotusScript comments starting with '. 
<br>Whenever we need to get specific we can use <tt>&lt;xsl:value-of</tt> to pick a value from the DXL form. 
<br> 
<br>The class we will expose into the webservice is, other than its name and the content of the parameters pretty standard and (IMHO) self explaining: 
<br> 
<br> <tt>Public Class form</tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '/**</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '* createData takes in the custom form data and creates a new document.</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '* the data given as parameter matches all input fields of the form</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '*</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; '**/</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Function createData(formData as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>InputData) as ResultCode</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dim curData as new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set createData = curData.createData(formData)</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public Function createAndReadData(formData as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>InputData) as ExtendedResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set createAndReadData = new ExtendedResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set createAndReadData.Data = new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set createAndReadData.Result = createAndReadData.Data.createData(formData) </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public Function readData(key as String) as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dim tmpResult as new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Call tmpResult.readData(key)</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set readData = tmpResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Function updateData(key as String, formData as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>InputData) as ResultCode</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dim curData as new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set updateData = curData.updateData(key, formData) &nbsp; &nbsp; &nbsp; &nbsp;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Function updateAndReadData(key as String, formData as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>InputData) as ExtendedResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set updateAndReadData = new ExtendedResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set updateAndReadData.Data = new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set updateAndReadData.Result = updateAndReadData.Data.updateData(key,formData) </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Function deleteData(key as String) as ResultCode</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Dim curData as new </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Set deleteData = curData.deleteData(key)</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; End Function</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; End Class</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public Class ResultCode</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Value as Integer 'We use HTTP values</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public DBid as String 'Database and document we try our luck with</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public DocID as String</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; End Class</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public Class ExtendedResult</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Result as ResultCode</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Public Data as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$formName"</tt> <tt>/&gt;</tt> <tt>CustomData</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; End Class</tt> 
<br> 
<br>The more interesting part is in the generation of code per field. Code needs to be generated for fields in various parts of the code, so we take advantage of XSLT's mode attribute to specify what generation should take place: 
<br> 
<br> <tt>&nbsp; &nbsp;</tt> <tt>&lt;!-- Fields need to be specified per mode/edit/compute and data type --&gt;</tt> <tt> </tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;xsl:template</tt> <tt> match=</tt> <tt>"d:field"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:variable</tt> <tt> name=</tt> <tt>"datatype"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:call-template</tt> <tt> name=</tt> <tt>"getdatatype"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:with-param</tt> <tt> name=</tt> <tt>"curField"</tt> <tt> select=</tt> <tt>"."</tt> <tt> </tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;/xsl:call-template&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;/xsl:variable&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Public </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"@name"</tt> <tt>/&gt;</tt> <tt> as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$datatype"</tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;/xsl:template&gt;</tt> 
<br> 
<br>We actually treat multi-value fields slightly different, so we just add a qualifier to our match condition and we can be more specific what to do. I prefer match clauses to if conditions most of the time. &nbsp; &nbsp; 
<br> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;!-- We need to treat multivalue fields a little different since they are arrays --&gt;</tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;xsl:template</tt> <tt> match=</tt> <tt>"d:field[@allowmultivalues='true']"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:variable</tt> <tt> name=</tt> <tt>"datatype"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:call-template</tt> <tt> name=</tt> <tt>"getdatatype"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:with-param</tt> <tt> name=</tt> <tt>"curField"</tt> <tt> select=</tt> <tt>"."</tt> <tt> </tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;/xsl:call-template&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;/xsl:variable&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; Public </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"@name"</tt> <tt>/&gt;</tt> <tt>() as </tt> <tt>&lt;xsl:value-of</tt> <tt> select=</tt> <tt>"$datatype"</tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;/xsl:template&gt;</tt> 
<br> 
<br>The variable datatype contains the mapping from a notes datatype into the XSD data type and is implemented as XSLT's version of sub routine. Once you make piece with XSLT's strictly set oriented way of thinking you will appreciate the power of the language. The mapping as of now looks like this: 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;!-- Determin the datatype. This maps Notes field types to XML Datatypes. Change as needed --&gt;</tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;xsl:template</tt> <tt> name=</tt> <tt>"getdatatype"</tt> <tt>&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:param</tt> <tt> name=</tt> <tt>"curField"</tt> <tt> </tt> <tt>/&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:choose&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='text'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='keyword'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='password'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='keyword'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='names'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='authors'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='readers'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='formula'"</tt> <tt>&gt;</tt> <tt>XSD_STRING</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='number'"</tt> <tt>&gt;</tt> <tt>XSD_DOUBLE</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:when</tt> <tt> test=</tt> <tt>"$curField/@type='datetime'"</tt> <tt>&gt;</tt> <tt>XSD_DATETIME</tt> <tt>&lt;/xsl:when&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;!-- TODO: complete the datatype mapping! --&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;xsl:otherwise&gt;</tt> <tt>XSD_ANYTYPE</tt> <tt>&lt;/xsl:otherwise&gt;</tt> 
<br> <tt>&nbsp; &nbsp; &nbsp; &nbsp; </tt> <tt>&lt;/xsl:choose&gt;</tt> 
<br> <tt>&nbsp; &nbsp; </tt> <tt>&lt;/xsl:template&gt;</tt> 
<br> 
<br>In this case I did choose the <tt>&lt;xsl:choose&gt;</tt> <tt> </tt>command since it allows for a compact display and the when conditions are not too complicated. One question to ask: if I only use the type of the field, why would I use the field in the parameter instead of just the type. The answer here is extensibility. You will want to be more specific on datetime and number fields. For a datetime field you could check what parts are visible date and/or time and create XSD_DATE, XSD_TIME instead of XSD_DATETIME. Similar for numbers: based on the display selection you could choose other data types then XSD_DOUBLE. 
<br> 
<br>The sample XSLT stylesheet is <a href="/blog/downloads">available for download</a>. 
<br> 
<br>Next stop: Reverse the game - generate a form from a web service.</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 05 September 2007
<span class="divider">|</span>
<a href="/blog/2007/09/a-crud-webservice-part-2.html#comments">Comments (1)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2007/09/a-crud-webservice-part-2.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_6FAF433A6CE76A6948257267001784B6" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_6FAF433A6CE76A6948257267001784B6"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Dan Sickles</b> on <i>Thursday 06 September 2007 AD</i>:<br /> 
  &quot;Programs that write programs are the happiest programs in the world.&quot; Nice work Stephan.
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/09/software-pricing-and-software-risk.html"><i class="icon-hand-left"></i>Software Pricing and Software Risk</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/09/michael-vizard-on-microsoft-exchange.html">Michael Vizard on Microsoft Exchange<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/09/">September</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2007/09/a-crud-webservice-part-2.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "6FAF433A6CE76A6948257267001784B6");
 		};
	</script>

</body>
</html>
