<!DOCTYPE html>
<html lang="en">
<head>
<title>NotesSensei's Blog - How much attachments are on your servers?</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<meta name="ROBOTS" content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title" content="NotesSensei's Weblog - How much attachments are on your servers?" />
<meta name="Author" content="Stephan H. Wissel" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta name="description"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="Keywords"
	content="lotus,domino,quickplace,sametime,blog,template,blogging,blogger,notes,r9,verse,r8,r7,r6,r5,raven,k-station,nsf,ntf,websphere,agile,sdlc,j2ee,.net,personcentric,singapore,twins,JavaScript,vertx, nodejs" />
<meta name="Abstract"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="ICBM" content="1.2994, 103.8425" />
<meta name="Copyright"
	content="2007,2017 Stephan H. Wissel - Creative commons licence" />
<meta HTTP-EQUIV="Content-Language" content="en" />
<meta property="fb:admins" content="567103136" />
<meta property="fb:app_id" content="219323514774289">
<meta property="og:title"
	content="wissel.net - How much attachments are on your servers?" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://wissel.net/blog" />
<meta property="og:image"
	content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="twitter:site" content="@notessensei" />
<meta name="twitter:card" content="summary" />
<meta name="xing:author"
	content="https://www.xing.com/profile/StephanH_Wissel" />

<link rel="stylesheet" type="text/css" href="/blog/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shariff.complete.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="stylesheet" href="/blog/css/markdown.css" />
<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnet" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>


	<div class="container">

    		<!-- Masthead
		================================================== -->
		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <!--[if lt IE 10]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 11'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
<![endif]-->

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/10/">October</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>


		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/10/there-is-no-lesson-in-victory.html"><i class="icon-hand-left"></i>There is no lesson in victory</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/10/switching-between-domino-server-versions-windows-edition.html">Switching between Domino server versions (Windows Edition)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1>
						<small>How much attachments are on your servers?</small>
					</h1>
					<hr />
					<div>In a recent discussion a customer asked how much space could they save on their mail servers if they move all attachments to 
<a href="http://www-306.ibm.com/software/lotus/products/quickr/">Lotus Quickr</a> or an content management solution like 
<a href="http://www-306.ibm.com/software/data/commonstore/lotus/">IBM DB/2 CommonStore for Domino</a>. While you can inspect a database easily for size and number of documents it doesn't tell you how much of this size is attributed to attachments. Since altering the mail template to add an attachment view was out of the picture I whipped up a little script, that will scan an entire server and report back the size figures into a database: 
<br /> 
<style>.lotusscript { font-family: sans-serif; font-size: 9pt; color: black; }
.ls-comment { color: green; }
.ls-quote { color: gray; }
.ls-datatype { color: orange; }
.ls-operator { color: blue; }
.ls-keyword { color: blue; }
.ls-statement { color: blue; }
.ls-function { color: blue; }
.ls-class { color: red; }
.ls-constant { color: purple; }
</style> 
<pre>
 
 
 <div class="lotusscript">

  
  
  <font class="ls-comment">'ScanForSize: </font>


  
  
  <font class="ls-keyword">Option</font> 
  
  
  <font class="ls-keyword">Public</font>

  
  
  <font class="ls-keyword">Option</font> 
  
  
  <font class="ls-keyword">Declare</font>

  
  
  <font class="ls-statement">Use</font> 
  
  
  <font class="ls-quote">&quot;SizeTools&quot;</font>

  
  
  <font class="ls-statement">Sub</font> 
  
  
  <font class="ls-keyword">Initialize</font>
	
  
  
  <font class="ls-statement">Dim</font> s 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-keyword">New</font> 
  
  
  <font class="ls-class">NotesSession</font>
	
  
  
  <font class="ls-statement">Dim</font> db 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-class">NotesDatabase</font>
	
  
  
  <font class="ls-statement">Dim</font> curDB 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-class">NotesDatabase</font>
	
  
  
  <font class="ls-statement">Dim</font> dbDir 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-class">NotesDbDirectory</font>
	
  
  
  <font class="ls-statement">Dim</font> serverName 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-keyword">String</font>
	
	
  
  
  <font class="ls-statement">Set</font> db 
  
  
  <font class="ls-operator">=</font> s
  
  
  <font class="ls-operator">.</font>CurrentDatabase
	
  
  
  <font class="ls-statement">If</font> db
  
  
  <font class="ls-operator">.</font>Server 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-quote">&quot;&quot;</font> 
  
  
  <font class="ls-statement">Then</font>
		serverName 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-quote">&quot;(local)&quot;</font>
	
  
  
  <font class="ls-statement">Else</font> 
		serverName 
  
  
  <font class="ls-operator">=</font> db
  
  
  <font class="ls-operator">.</font>Server
	
  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">If</font>
	serverName 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-function">Inputbox</font>
  
  
  <font class="ls-operator">(</font>
  
  
  <font class="ls-quote">&quot;Please select the server to scan (local) for local&quot;</font>
  
  
  <font class="ls-operator">,</font>
  
  
  <font class="ls-quote">&quot;Server Scan&quot;</font>
  
  
  <font class="ls-operator">,</font>serverName
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">If</font> serverName 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-quote">&quot;&quot;</font> 
  
  
  <font class="ls-statement">Then</font>
		
  
  
  <font class="ls-statement">Exit</font> 
  
  
  <font class="ls-statement">Sub</font>
	
  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">If</font>
	
	
  
  
  <font class="ls-statement">If</font> servername 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-quote">&quot;(local)&quot;</font> 
  
  
  <font class="ls-statement">Then</font>
		
  
  
  <font class="ls-statement">Set</font> dbDir 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-keyword">New</font> 
  
  
  <font class="ls-class">NotesDbDirectory</font>
  
  
  <font class="ls-operator">(</font>
  
  
  <font class="ls-quote">&quot;&quot;</font>
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">Else</font>
		
  
  
  <font class="ls-statement">Set</font> dbDir 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-keyword">New</font> 
  
  
  <font class="ls-class">NotesDbDirectory</font>
  
  
  <font class="ls-operator">(</font>serverName
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">If</font>
	
	
  
  
  <font class="ls-statement">Set</font> curDB 
  
  
  <font class="ls-operator">=</font> dbdir
  
  
  <font class="ls-operator">.</font>GetFirstDatabase
  
  
  <font class="ls-operator">(</font>
  
  
  <font class="ls-constant">TEMPLATE_CANDIDATE</font>
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">Do</font> Until curDB 
  
  
  <font class="ls-operator">Is</font> 
  
  
  <font class="ls-constant">Nothing</font>
		
  
  
  <font class="ls-function">Print</font> 
  
  
  <font class="ls-quote">&quot;Working on &quot;</font> 
  
  
  <font class="ls-operator">&amp;</font> curDB
  
  
  <font class="ls-operator">.</font>FilePath
		
  
  
  <font class="ls-function">Call</font> countThis
  
  
  <font class="ls-operator">(</font>curDB
  
  
  <font class="ls-operator">,</font> db
  
  
  <font class="ls-operator">)</font>
		
  
  
  <font class="ls-statement">Set</font> curDB 
  
  
  <font class="ls-operator">=</font> dbDir
  
  
  <font class="ls-operator">.</font>GetNextDatabase
	
  
  
  <font class="ls-statement">Loop</font>
	
  
  
  <font class="ls-function">Msgbox</font> 
  
  
  <font class="ls-quote">&quot;Run completed&quot;</font>

  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">Sub</font>



  
  
  <font class="ls-statement">Sub</font> countThis
  
  
  <font class="ls-operator">(</font>curDB 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-class">NotesDatabase</font>
  
  
  <font class="ls-operator">,</font> reportDB 
  
  
  <font class="ls-keyword">As</font> 
  
  
  <font class="ls-class">NotesDatabase</font>
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">Dim</font> curSize 
  
  
  <font class="ls-keyword">As</font> DBSizeInfo	
	
  
  
  <font class="ls-statement">On</font> 
  
  
  <font class="ls-function">Error</font> 
  
  
  <font class="ls-statement">Resume</font> 
  
  
  <font class="ls-statement">Next</font>
	
  
  
  <font class="ls-statement">Set</font> curSize 
  
  
  <font class="ls-operator">=</font> 
  
  
  <font class="ls-keyword">New</font> DBSizeInfo
  
  
  <font class="ls-operator">(</font>curDB
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-function">Call</font> curSize
  
  
  <font class="ls-operator">.</font>count
	
  
  
  <font class="ls-comment">'We save only database information that has an attachment</font>
	
  
  
  <font class="ls-statement">If</font> curSize
  
  
  <font class="ls-operator">.</font>AttachmentCount 
  
  
  <font class="ls-operator">&gt;</font> 0 
  
  
  <font class="ls-statement">Then</font>
		
  
  
  <font class="ls-function">Call</font> curSize
  
  
  <font class="ls-operator">.</font>save
  
  
  <font class="ls-operator">(</font>reportDB
  
  
  <font class="ls-operator">)</font>
	
  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">If</font>

  
  
  <font class="ls-statement">End</font> 
  
  
  <font class="ls-statement">Sub</font>




 
 
 </div></pre> 
<div style="FONT-SIZE: 8pt; COLOR: gray; FONT-FAMILY: sans-serif; BORDER: 1 solid Grey; margin : 5px 50px 5px 50px;"> 
 <center>
   This LotusScript was converted to HTML using the 
  <b><i>ls2html</i></b> routine, 
  <br />provided by Julian Robichaux at 
  <a href="http://www.nsftools.com" target="_blank">nsftools.com</a>. 
 </center> 
</div> 
<br />The meat is in the class: 
<br /> 
<pre>
 
 
 <div class="lotusscript">
  
  
  
'SizeTools: 

Option Public
Option Declare

Public Class DBSizeInfo
	Private db As NotesDatabase 'The database to be counted
	Public DBSize As Variant 'Size of the database 
	Public AttachmentSize As Variant
	Public AttachmentCount As Variant
	Public DocumentCount As Variant
	Public hasError As Boolean
	
	Sub new (curDB As NotesDatabase)
		Set db = curDB
		hasError = False
	End Sub
	
	
	Public Function Count As Boolean
		Dim doc As NotesDocument
		Dim dc As NotesDocumentCollection
		Dim countResult As Variant
		Dim sizeResult As Variant
		On Error Goto Err_Count
		
		If Not db.IsOpen Then
			Call db.Open(&quot;&quot;,&quot;&quot;)
			If Not db.IsOpen Then
				'We could not open it
				Print &quot;Can't open &quot; &amp; db.FilePath
				Count = False
				Goto Exit_Count
			End If
		End If
		
		DBSize = db.Size
		AttachmentCount = 0
		AttachmentSize = 0
		DocumentCount = 0
		
		Set dc = db.AllDocuments
		Set doc = dc.GetFirstDocument
		
		Do Until doc Is Nothing
			If doc.HasEmbedded Then
				Call getAttachmentSizes(doc)
			End If
			DocumentCount = DocumentCount + 1
			Set doc = dc.GetNextDocument(doc)
		Loop
		
		Count = True 'If we got here it worked
Exit_Count:
		Exit Function
		
Err_Count:
		Print Error$ &amp; &quot; in  Count in &quot; &amp; db.FilePath &amp; &quot; in line &quot; &amp; Cstr(Erl)
		Count = False
		hasError = True
		Resume Exit_Count
	End Function
	
	Public Sub Save(reportDB As NotesDatabase)
		Dim doc As NotesDocument
		Dim v As NotesView
		Dim searchkey(0 To 1) As String
		
		On Error Goto Err_Save
		
		Set v = reportDB.GetView(&quot;(LookupByServerAndPath)&quot;)
		If v Is Nothing Then
			Set doc = New NotesDocument(reportDB)
		Else
			If db.Server = &quot;&quot; Then
				searchkey(0) = &quot;(local)&quot;
			Else
				searchkey(0) = db.Server				
			End If
			searchkey(1) = Lcase(db.FilePath)
			Set doc = v.GetDocumentByKey(searchkey,True)
			If doc Is Nothing Then
				Set doc = New NotesDocument(reportDB)
			End If
		End If
		
		Call doc.ReplaceItemValue(&quot;Form&quot;,&quot;SizeReport&quot;)
		Call doc.ReplaceItemValue(&quot;DBSize&quot;,Me.DBSize)
		Call doc.ReplaceItemValue(&quot;AttachmentSize&quot;,Me.AttachmentSize)
		Call doc.ReplaceItemValue(&quot;AttachmentCount&quot;,Me.AttachmentCount)
		Call doc.ReplaceItemValue(&quot;DocumentCount&quot;,Me.DocumentCount)	
		If hasError Then
			Call doc.ReplaceItemValue(&quot;ErrorFlag&quot;,1)				
		Elseif doc.HasItem(&quot;hasError&quot;) Then
			Call doc.RemoveItem(&quot;ErrorFlag&quot;)
		End If
		If db.Server = &quot;&quot; Then
			Call doc.ReplaceItemValue(&quot;ServerName&quot;,&quot;(local)&quot;)
		Else
			Call doc.ReplaceItemValue(&quot;ServerName&quot;,db.Server	)
		End If
		
		Call doc.ReplaceItemValue(&quot;FilePath&quot;,Lcase(db.FilePath))
		Call doc.Save(True,True)
		
Exit_Save:
		Exit Sub
		
Err_Save:
		Print Error$ &amp; &quot; in &quot; &amp; db.FilePath
		Resume Exit_Save
	End Sub
	
	Private Sub getAttachmentSizes(doc As NotesDocument)
		Dim attNames As Variant		
		Dim att As NotesEmbeddedObject
		Dim result As Variant
		result = 0
		On Error Goto Err_getAttachmentSizes
		
		attNames = Evaluate(|@Attachmentnames|, doc)
		
		If attNames(0) &lt;&gt; &quot;&quot; Then
			Forall an In attNames
				Print &quot;Checking Attachment  &quot; &amp; an
				Set att = doc.GetAttachment(an)
				result = result + att.FileSize
				Me.AttachmentCount = Me.AttachmentCount + 1
			End Forall
		End If
		
Exit_getAttachmentSizes:
		Me.AttachmentSize = Me.AttachmentSize +  result
		Exit Sub
		
Err_getAttachmentSizes:
		Print Error$ &amp; &quot; in getAttachmentSizes doc: &quot; &amp; doc.UniversalID 
		Resume Exit_getAttachmentSizes
	End Sub
	
End Class

 
 
 </div></pre> 
<br />You can 
<a href="/blog/DOWNLOADS/789D375AC8DF8C504825738400548E4C/$FILE/Attachmentsizes.zip">download the sample database</a>. 
<br /> 
<b>YMMV</b></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 2007-10-30 12:00
<span class="divider">|</span>
<a href="/blog/2007/10/how-much-attachments-are-on-your-servers.html#comments">Comments (7)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a> 

						<div class="shariff" data-lang="en" data-url="https://www.notessensei.com/blog/2007/10/how-much-attachments-are-on-your-servers.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-title="How much attachments are on your servers?"></div>
						<script type="text/javascript">
							var permaLink = "https://www.notessensei.com/blog/2007/10/how-much-attachments-are-on-your-servers.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_98E83A9A2A45967048257383003B29EE" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_98E83A9A2A45967048257383003B29EE"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
<img src="//www.gravatar.com/avatar/84e6d53d773650e4acc9ffce777af6df.jpg?s=88" class="gravatarimg" />
							posted by <b>Rich</b> on <i>Wednesday 31 October 2007 AD - 00:58 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  This is a great idea. I tried the database, locally and on a server, and never see any results. Perhaps another setup step is required? In the status bar it rips through a list of databases, but doesn't seem to open or check any of them. I hope I just missed something simple.
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/84e6d53d773650e4acc9ffce777af6df.jpg?s=88" class="gravatarimg" />
							posted by <b>Rich</b> on <i>Wednesday 31 October 2007 AD - 01:56 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Ah, must have been a signing issue of some kind. I signed the db which didn't seem to make a difference. However, I opened the agent to comment out the 'Working on' Print statement so I could see what else was going on. After I saved it and ran it again, it was fine. Cool tool!
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/84e6d53d773650e4acc9ffce777af6df.jpg?s=88" class="gravatarimg" />
							posted by <b>Rich</b> on <i>Wednesday 31 October 2007 AD - 02:15 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  One thing I've noticed is that the size of my attachments sometimes exceeds the size of the database itself. Attachment compression at work? Is there a way to capture the stored compressed size vs actual?
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/a9cbb0270b33b3882200366e7f0f8931.jpg?s=88" class="gravatarimg" />
							posted by <b>Jack Dausman</b> on <i>Wednesday 31 October 2007 AD - 02:34 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Stephan, what a GREAT idea. Thanks. this is exactly the 
  <del>weapon</del> report we were looking for ! I just didn't know it, until you posted it.
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/f8a85b2f8c976aeb6e842c1f64324c36.jpg?s=88" class="gravatarimg" />
							posted by <b>Ulrich Krause</b> on <i>Wednesday 31 October 2007 AD - 13:49 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Nice solution! 
  <br /> 
  <br />I did as similar one way back in 2006. ( 
  <a href="http://www.eknori.de/archives/337" rel="nofollow">http://www.eknori.de/archives/337</a> ) 
  <br />My solution not only recognizes the attachments size but calculates, how much space can be saved when there were only a single instance of an attachment. ( like what modern mail archiving systems do ). 
  <br />It calculates a hash for every attachment.
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/f4c78119440804a1ff4bb4c67bc7e2f8.jpg?s=88" class="gravatarimg" />
							posted by <b>Dev K Menon</b> on <i>Thursday 01 November 2007 AD - 15:14 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Great idea Stephan. I will share it with my team. A lot of times we do meet customers who have tons of attachments within their apps and disk space is always a challenge. 
  <br /> 
  <br />These simple tips can help alot of time wasted on analysing these attachments.
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/74c991ff6cc962c59eab1b924c359789.jpg?s=88" class="gravatarimg" />
							posted by <b>Slawek Rogulski</b> on <i>Friday 02 November 2007 AD - 11:46 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Nice one Stephan.
 </body>
</html>
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2007/10/there-is-no-lesson-in-victory.html"><i class="icon-hand-left"></i>There is no lesson in victory</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2007/10/switching-between-domino-server-versions-windows-edition.html">Switching between Domino server versions (Windows Edition)<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/">2007</a> <span class="divider">/</span></li>
  <li><a href="/blog/2007/10/">October</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/Show-N-Tell Thursday.html">Show-N-Tell Thursday</a>
  </li>
</ul>

	</div>
<!-- Footer	================================================== -->
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I'm working as "Cloud Program Architect" for Salesforce. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://plus.google.com/+StephanWissel/about" rel="author" style="text-decoration: none;">
						    <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="" style="border: 0; width: 16px; height: 16px;" /> Google+</a></li>
						<li><a href="skype//:notessensei?chat">Skype</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2017 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2007/10/how-much-attachments-are-on-your-servers.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/jquery.fittext.js"></script>
	<script type="text/javascript" src="/blog/js/main.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/comments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
		        SyntaxHighlighter.all();
			renderComment("6LcUOewSAAAAACAI4zVcGFVkGWmp0sUH5gabwy1q", "98E83A9A2A45967048257383003B29EE");
		});
	</script>

</body>
</html>
