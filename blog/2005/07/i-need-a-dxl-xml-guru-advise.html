<!DOCTYPE html>
<html lang="en">
<head>
<title>&amp;lt;strike&amp;gt;I need a&amp;lt;/strike&amp;gt; DXL/XML guru&amp;amp;apos;s advise! - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - &amp;lt;strike&amp;gt;I need a&amp;lt;/strike&amp;gt; DXL/XML guru&amp;amp;apos;s advise!" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2005/07/i-need-a-dxl-xml-guru-advise.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - &amp;lt;strike&amp;gt;I need a&amp;lt;/strike&amp;gt; DXL/XML guru&amp;amp;apos;s advise!" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="&amp;lt;strike&amp;gt;I need a&amp;lt;/strike&amp;gt; DXL/XML guru&amp;amp;apos;s advise! - I&#39;m working on a project, that will reunite a bunch of databases that once were one back into a common template. One tool that worked very well is DXL export, XSLT transformation and importing that stuff back. I&#39;m using the Body field of a Notes document to store the DXL, which creates some kind of " />
<meta name="Keywords"
	content="IBM Notes,Lotus Notes," />
<meta name="Abstract"
	content="&amp;lt;strike&amp;gt;I need a&amp;lt;/strike&amp;gt; DXL/XML guru&amp;amp;apos;s advise! - I&#39;m working on a project, that will reunite a bunch of databases that once were one back into a common template. One tool that worked very well is DXL export, XSLT transformation and importing that stuff back. I&#39;m using the Body field of a Notes document to store the DXL, which creates some kind of " />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2005/">2005</a> <span class="divider">/</span></li>
  <li><a href="/blog/2005/07/">July</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/lotusnotes.html">Lotus Notes</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2005/07/i-aposm-a-porn-site-operator-now.html"><i class="icon-hand-left"></i>I&amp;apos;m a Porn site operator now!</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2005/07/retreat-now.html">Retreat now!<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>&lt;strike&gt;I need a&lt;/strike&gt; DXL/XML guru&amp;apos;s advise!</small></h1>
					<hr />
					<div>I'm working on a project, that will reunite a bunch of databases that once were one back into a common template. One tool that worked very well is DXL export, XSLT transformation and importing that stuff back. I'm using the Body field of a Notes document to store the DXL, which creates some kind of documentation/audit trail. This morning we hit the wall. 
<br> I exported a rather complex form (a lot of subforms, multi-nested tables, hotspots and a lot of fields). When I tried to reimport the DXL untouched I was greeted with this error dialogue: 
<br> 
<img src="/blog/images/2014/DXLError.gif" border="0" width="335" height="152"> 
<br> (For RSS readers: the message says: "Left margin cannot be greater than right margi". I did the msgbox, but that was the error in the DXL importer. Please note the typo/truncation. Anybody came across this and could advise what to do? 
<br> 
<br> <b>Update:</b> I found a solution (and opened another can of worms)! The form I tried to export has quite a bit of "history" So in the table tag there is an attribute <code>r4spacing="true"</code>. With this attribute set I get the error message. The attribute tells the designer to use the fixed values provided in <code>refwidth="10.4778in"</code>. Once you remove the attribute "r4spacing" import works. Of course now the table rendering follows a different rule set, so it gets all messed up. Looks like another session in XSLT to clean this up. 
<br> 
<br> This is the agent we use for import:<pre><code class="language-vb">
Sub Initialize
    'Exports DXL design elements from the base line code into a
    'database. Can be new, might exist

    Dim db As NotesDatabase
    Dim dCol As NotesDocumentCollection
    Dim newDB As NotesDatabase
    Dim doc As NotesDocument
    Dim rt As NotesRichTextItem
    Dim txtServerName As String
    Dim txtNewDBName As String

    Dim s As New NotesSession
    Set db = s.CurrentDatabase
    txtServerName = db.Server

    txtNewDBName = Inputbox("Create/Update db on "+txtServerName,"")
    If txtNewDBName = "" Then
             Exit Sub
    End If

    Set newDB = New NotesDatabase(txtServerName,txtNewDBName)
    If Not newDB.IsOpen Then
             'We need to create it!
             Call newDB.Create(txtServerName,txtNewDBName,True)
    Else
             If Msgbox("This DB does exist, update it? (Exisiting elements will be overwritten)",36) &lt;&gt; 6 Then
                     Exit Sub
             End If

    End If

    'Final check
    If Not newDB.IsOpen Then
             'Something went wrong!
             Msgbox"Can't open the selected database, I'm sorry!"
             Exit Sub
    End If

    Set dCol = db.UnprocessedDocuments
    Set doc = dCol.GetFirstDocument

    Do Until doc Is Nothing
             If doc.HasItem("Body") Then
                     Set rt = doc.GetFirstItem("Body")
                     If doc.HasItem("Subject") Then
                              Print "Working on " &amp; doc.subject(0)
                     End If
                     Call ImportDXLfromRT(rt,newDB)
             End If
             Set doc = dCol.GetNextDocument(doc)
    Loop

End Sub

Sub ImportDXLfromRT(rt As NotesRichTextItem, db As NotesDatabase)
Dim dxi As NotesDXLImporter

    On Error Goto Err_ImportDXLfromRT

    Dim s As New NotesSession
    Set dxi = s.CreateDXLImporter

    'Set the import to ONLY import design elements
    dxi.ACLImportOption = DXLIMPORTOPTION_IGNORE
    dxi.DesignImportOption = DXLIMPORTOPTION_REPLACE_ELSE_CREATE
    dxi.DocumentImportOption = DXLIMPORTOPTION_IGNORE
    dxi.ReplaceDBProperties = False
    dxi.ReplicaRequiredForReplaceOrUpdate = False

    'Set the source to RT and the target to the db
    Call dxi.setInput(rt)
    Call dxi.setOutput(db)
    Call dxi.process

Exit_ImportDXLfromRT:
Exit Sub

Err_ImportDXLfromRT:
'Error from dxi
Print Error$
Msgboxdxi.log
ResumeExit_ImportDXLfromRT

End Sub
</code>

</pre> 
<br> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 05 July 2005
<span class="divider">|</span>
<a href="/blog/2005/07/i-need-a-dxl-xml-guru-advise.html#comments">Comments (1)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/ibmnotes.html">IBM Notes</a>  <a href="/blog/categories/lotusnotes.html">Lotus Notes</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2005/07/i-need-a-dxl-xml-guru-advise.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_144C20376E6620D448257035004BAA80" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_144C20376E6620D448257035004BAA80"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>null</b> on <i>Tuesday 25 March 2008 AD</i>:<br /> 
  <img alt="Emoticon wink.gif" src="/blog/images/emoticons/wink.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2005/07/i-aposm-a-porn-site-operator-now.html"><i class="icon-hand-left"></i>I&amp;apos;m a Porn site operator now!</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2005/07/retreat-now.html">Retreat now!<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2005/">2005</a> <span class="divider">/</span></li>
  <li><a href="/blog/2005/07/">July</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/lotusnotes.html">Lotus Notes</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2005/07/i-need-a-dxl-xml-guru-advise.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "144C20376E6620D448257035004BAA80");
 		};
	</script>

</body>
</html>
