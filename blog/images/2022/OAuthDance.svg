<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="626px" preserveAspectRatio="none" style="width:725px;height:626px;background:#FFFFFF;" version="1.1" viewBox="0 0 725 626" width="725px" zoomAndPan="magnify"><defs><filter height="300%" id="fwszgurprqbsf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="101" x="314.25" y="29.4023">OAuth Flow</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="123.6875" y2="541.3457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="229.5" x2="229.5" y1="123.6875" y2="541.3457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="359.5" x2="359.5" y1="123.6875" y2="541.3457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="466.5" x2="466.5" y1="123.6875" y2="541.3457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="581.5" x2="581.5" y1="123.6875" y2="541.3457"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="690.5" x2="690.5" y1="123.6875" y2="541.3457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="120.7344">User</text><ellipse cx="23.5" cy="50.1992" fill="#FEFECE" filter="url(#fwszgurprqbsf)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,58.1992 L23.5,85.1992 M10.5,66.1992 L36.5,66.1992 M23.5,85.1992 L10.5,100.1992 M23.5,85.1992 L36.5,100.1992 " fill="none" filter="url(#fwszgurprqbsf)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="5" y="553.8809">User</text><ellipse cx="23.5" cy="566.834" fill="#FEFECE" filter="url(#fwszgurprqbsf)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M23.5,574.834 L23.5,601.834 M10.5,582.834 L36.5,582.834 M23.5,601.834 L10.5,616.834 M23.5,601.834 L36.5,616.834 " fill="none" filter="url(#fwszgurprqbsf)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="124" x="165.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="172.5" y="108.7344">Service provider</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="124" x="165.5" y="540.3457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="110" x="172.5" y="560.8809">Service provider</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="109" x="303.5" y="55.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="336" y="75.7578">OAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="310.5" y="92.2461">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="327" y="108.7344">Endpoint</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="109" x="303.5" y="540.3457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="336" y="560.8809">OAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="310.5" y="577.3691">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="327" y="593.8574">Endpoint</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="76" x="426.5" y="55.2227"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="442.5" y="75.7578">OAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="443" y="92.2461">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="433.5" y="108.7344">Endpoint</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="63.4648" style="stroke:#A80036;stroke-width:1.5;" width="76" x="426.5" y="540.3457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="442.5" y="560.8809">OAuth</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="443" y="577.3691">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="433.5" y="593.8574">Endpoint</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="126" x="516.5" y="88.1992"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="523.5" y="108.7344">Identity Provider</text><rect fill="#FEFECE" filter="url(#fwszgurprqbsf)" height="30.4883" style="stroke:#A80036;stroke-width:1.5;" width="126" x="516.5" y="540.3457"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="523.5" y="560.8809">Identity Provider</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="658" y="104.2461">KEEP API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="656.5" y="120.7344">Endpoint</text><path d="M672.5,54.7109 C672.5,44.7109 690.5,44.7109 690.5,44.7109 C690.5,44.7109 708.5,44.7109 708.5,54.7109 L708.5,80.7109 C708.5,90.7109 690.5,90.7109 690.5,90.7109 C690.5,90.7109 672.5,90.7109 672.5,80.7109 L672.5,54.7109 " fill="#FEFECE" filter="url(#fwszgurprqbsf)" style="stroke:#000000;stroke-width:1.5;"/><path d="M672.5,54.7109 C672.5,64.7109 690.5,64.7109 690.5,64.7109 C690.5,64.7109 708.5,64.7109 708.5,54.7109 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="658" y="553.8809">KEEP API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="656.5" y="570.3691">Endpoint</text><path d="M672.5,583.3223 C672.5,573.3223 690.5,573.3223 690.5,573.3223 C690.5,573.3223 708.5,573.3223 708.5,583.3223 L708.5,609.3223 C708.5,619.3223 690.5,619.3223 690.5,619.3223 C690.5,619.3223 672.5,619.3223 672.5,609.3223 L672.5,583.3223 " fill="#FEFECE" filter="url(#fwszgurprqbsf)" style="stroke:#000000;stroke-width:1.5;"/><path d="M672.5,583.3223 C672.5,593.3223 690.5,593.3223 690.5,593.3223 C690.5,593.3223 708.5,593.3223 708.5,583.3223 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><polygon fill="#A80036" points="217.5,150.998,227.5,154.998,217.5,158.998,221.5,154.998" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="223.5" y1="154.998" y2="154.998"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="30.5" y="150.2559">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="43.5" y="150.2559">request resource</text><polygon fill="#A80036" points="34.5,195.6191,24.5,199.6191,34.5,203.6191,30.5,199.6191" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="28.5" x2="228.5" y1="199.6191" y2="199.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="40.5" y="187.2217">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="53.5" y="179.5664">request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="53.5" y="194.877">authorization</text><polygon fill="#A80036" points="348,224.9297,358,228.9297,348,232.9297,352,228.9297" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="354" y1="228.9297" y2="228.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="30.5" y="224.1875">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="43.5" y="224.1875">access OAuth</text><polygon fill="#A80036" points="569.5,254.2402,579.5,258.2402,569.5,262.2402,573.5,258.2402" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="360" x2="575.5" y1="258.2402" y2="258.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="367" y="253.498">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162" x="380" y="253.498">redirect to Authentication</text><polygon fill="#A80036" points="34.5,283.5508,24.5,287.5508,34.5,291.5508,30.5,287.5508" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="569.5,283.5508,579.5,287.5508,569.5,291.5508,573.5,287.5508" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28.5" x2="575.5" y1="287.5508" y2="287.5508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="40.5" y="282.8086">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="53.5" y="282.8086">authenticates</text><polygon fill="#A80036" points="348,328.1719,358,332.1719,348,336.1719,352,332.1719" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="354" y1="332.1719" y2="332.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="30.5" y="319.7744">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="43.5" y="312.1191">authorizes client</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="43.5" y="327.4297">for registered scopes</text><polygon fill="#A80036" points="34.5,357.4824,24.5,361.4824,34.5,365.4824,30.5,361.4824" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="28.5" x2="359" y1="361.4824" y2="361.4824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="40.5" y="356.7402">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="53.5" y="356.7402">redirects with authorization code</text><polygon fill="#A80036" points="217.5,386.793,227.5,390.793,217.5,394.793,221.5,390.793" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="23.5" x2="223.5" y1="390.793" y2="390.793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="30.5" y="386.0508">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="43.5" y="386.0508">provide authorziation code</text><polygon fill="#A80036" points="454.5,431.4141,464.5,435.4141,454.5,439.4141,458.5,435.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="229.5" x2="460.5" y1="435.4141" y2="435.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="236.5" y="423.0166">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="249.5" y="415.3613">send client id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="249.5" y="430.6719">and authorization code</text><polygon fill="#A80036" points="240.5,460.7246,230.5,464.7246,240.5,468.7246,236.5,464.7246" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="234.5" x2="465.5" y1="464.7246" y2="464.7246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="246.5" y="459.9824">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="268.5" y="459.9824">provide access token (JWT)</text><polygon fill="#000000" points="678.5,490.0352,688.5,494.0352,678.5,498.0352,682.5,494.0352" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="229.5" x2="684.5" y1="494.0352" y2="494.0352"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="236.5" y="489.293">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291" x="258.5" y="489.293">send access token (JWT) with resource request</text><polygon fill="#000000" points="217.5,519.3457,227.5,523.3457,217.5,527.3457,221.5,523.3457" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="23.5" x2="223.5" y1="523.3457" y2="523.3457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="18" x="30.5" y="518.6035">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="52.5" y="518.6035">provide resource</text><!--MD5=[10e4a2efbbfde8ad9a0eed7f740e7d1c]
@startuml OAuthDance
autonumber
title OAuth Flow
actor       "User" as human
participant "Service provider" as App
participant "OAuth\nAuthorization\nEndpoint" as OAuth1
participant "OAuth\nToken\nEndpoint" as OAuth2
participant "Identity Provider" as IdP
database "KEEP API\nEndpoint" as keep
human -> App: request resource
human <- - App: request\nauthorization
human -> OAuth1: access OAuth
OAuth1 - -> IdP: redirect to Authentication
human <-> IdP: authenticates
human -> OAuth1: authorizes client\nfor registered scopes
human <- - OAuth1: redirects with authorization code
human -> App: provide authorziation code
App -> OAuth2: send client id\nand authorization code
App <- OAuth2: provide access token (JWT)
App -[#000000]> keep: send access token (JWT) with resource request
App <[#000000]- human: provide resource
@enduml

PlantUML version 1.2022.0(Wed Jan 12 00:16:42 PST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: Eclipse OpenJ9 VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>