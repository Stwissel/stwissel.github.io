<!DOCTYPE html>
<html lang="en">
<head>
<title>Driving Embedded Experiences Adoption - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Driving Embedded Experiences Adoption" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2013/11/driving-embedded-experiences-adoption.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Driving Embedded Experiences Adoption" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Driving Embedded Experiences Adoption - With the introduction of Connections Mail and IBM Notes 9.0 a brand new productivity feature was made available in eMail: Embedded Experiences (EE). They are defined by the Open Social Foundation and can also be found in IBM Connections or Atlassian&#39;s Confluence Wiki. The use case for embedded exper" />
<meta name="Keywords"
	content="IBM Notes,XPages," />
<meta name="Abstract"
	content="Driving Embedded Experiences Adoption - With the introduction of Connections Mail and IBM Notes 9.0 a brand new productivity feature was made available in eMail: Embedded Experiences (EE). They are defined by the Open Social Foundation and can also be found in IBM Connections or Atlassian&#39;s Confluence Wiki. The use case for embedded exper" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/">2013</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2013/09/aggregating-view-data-for-use-in-d3js-graphics.html"><i class="icon-hand-left"></i>Aggregating view data for use in d3js graphics</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2013/11/elearning-are-we-there-yet.html">eLearning - are we there yet?<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Driving Embedded Experiences Adoption</small></h1>
					<hr />
					<div>With the introduction of <a href="http://www-10.lotus.com/ldd/lcwiki.nsf/xpDocViewer.xsp?lookupName=IBM+Connections+Mail+1.0+documentation#action=openDocument&amp;content=catcontent&amp;ct=prodDoc">Connections Mail</a> and <a href="http://www-03.ibm.com/software/products/us/en/ibmnotes">IBM Notes 9.0</a> a brand new productivity feature was made available in eMail: <a href="http://eedemos.opensocial2.org/">Embedded Experiences</a> (EE). They are defined by the <a href="http://opensocial.org/">Open Social Foundation</a> and can also be found in <a href="http://www.ibm.com/connections/">IBM Connections</a> or Atlassian's <a href="https://www.atlassian.com/software/confluence">Confluence Wiki</a>. 
<br> The use case for embedded experiences in eMail is simple: 
<br> " <i>Any application that sends a notification message to your attention and/or action can reduce the time and clicks required for processing by taking advantage of an embedded experience</i>" 
<br> Ryan <a href="https://www.ibmdw.net/social/docs/enabling-opensocial-gadget-support-on-ibm-notes-and-domino-9-0/">described in detail</a> how to switch on the processing of embedded experiences and the Wiki <a href="http://www-10.lotus.com/ldd/dominowiki.nsf/dx/Integration_with_XPage_Embedded_Experiences_OSC90">tells how how to use XPages</a> to send them. The trouble with this: you need to touch every single application that sends out a notification. You might not have time, budget or source code access to them. 
<br> <b>So are EE a nice idea, but confined to some niche applications?</b> 
<br> <b>Not at all!</b> When peeking under the hood, you can see, that an EE enabled eMail has a HTML and a JSON Mime part. If a client doesn't understand EE (like mobile clients or any other eMail than IBM Notes), then the HTML message is rendered. Important here: even with Notes you must have a HTML part, a plain text message won't do. Using a "when new mail arrives" agent, you can turn an incoming message into an EE. 
<br> As long as the target system supports one of the authentications the <a http:="" www-10.lotus.com="" dd="" ewiki.nsf="" pdocviewer.xsp?lookupname="Lotus+Expeditor+6.2.3+Documentation#action=openDocument&amp;res_title=Accounts_framework_XPD623&amp;content=pdcontent&quot;">Account API</a> provides (Basic HTTP, JEE Form, SAML, Spengo, OS Credential, Siteminder, LTPA) this will work. This is Notes client only, for Connections or iNotes you are limited to SAML. 
<br> First thought was to use a "Before mail arrives" agent to make sure, that the mail gets delivered fully converted. However such an agent runs in the router context and might be a performance killer - the when new mail arrives option seems a suitable compromise. The approach works with signed eMails too, since signing covers the eMail body, but not headers and mime separators (you can't sign the header since each routing hop adds information there). 
<br> As an example I used a plain text eMail, that sends a notification with a number of field/values separated by colon and containing only one URL. For your use cases, you will need to adopt the code (or wait for a future blog, just saying). Since my original message only contained text/plain I had to add text/html and application/json mime parts.The Notes API <a href="http://publib.boulder.ibm.com/infocenter/domhelp/v8r0/topic/com.ibm.designer.domino.main.doc/H_MIMEENTITY_CLASS_JAVA.html">MimeEntity</a> class makes the code rather simple and does the conversion in less than 100 lines of code. It will work for any notification following this pattern. 
<div class="lotusscript"> <span class="kw1">Sub</span> ConvertToEE <span class="br0">(</span>s <span class="kw1">As</span> <span class="kw2">NotesSession</span>, doc <span class="kw1">As</span> <span class="kw2">NotesDocument</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> body <span class="kw1">As</span> <span class="kw2">NotesMIMEEntity</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> parent <span class="kw1">As</span> <span class="kw2">NotesMIMEEntity</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> header <span class="kw1">As</span> <span class="kw2">NotesMIMEHeader</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> jsonEE <span class="kw1">As</span> <span class="kw2">NotesMIMEEntity</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> htmlEE <span class="kw1">As</span> <span class="kw2">NotesMIMEEntity</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> jsonStream <span class="kw1">As</span> <span class="kw2">NotesStream</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> htmlStream <span class="kw1">As</span> <span class="kw2">NotesStream</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> content <span class="kw1">As</span> <span class="kw2">NotesStream</span> 
 <br> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> headerName <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> headerValue <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> newHeaders <span class="kw1">List</span> <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> content = s. <span class="me1">Createstream</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> jsonStream = s. <span class="me1">Createstream</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> htmlStream = s. <span class="me1">Createstream</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; s. <span class="me1">Convertmime</span> = <span class="kw1">False</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> body = doc. <span class="me1">Getmimeentity</span> <span class="br0">(</span> <span class="st0">"Body"</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> body. <span class="me1">Getcontentastext</span> <span class="br0">(</span>content, <span class="kw1">True</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> parent = body. <span class="me1">Createparententity</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> addHeader <span class="br0">(</span>parent, <span class="st0">"Content-Type"</span>, <span class="st0">"multipart/alternative"</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> addHeader <span class="br0">(</span>parent, <span class="st0">"MIME-Version"</span>, <span class="st0">"1.0"</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> generateEEParts <span class="br0">(</span>content,jsonStream,htmlStream <span class="br0">)</span> 
 <br> 
 <br> &nbsp; &nbsp; jsonStream. <span class="me1">position</span> = <span class="nu0">0</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> jsonEE = parent. <span class="me1">Createchildentity</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> jsonEE. <span class="me1">Setcontentfromtext</span> <span class="br0">(</span>jsonStream, <span class="st0">"application/embed+json;charset=UTF-8"</span>, ENC_IDENTITY_7BIT <span class="br0">)</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; htmlStream. <span class="me1">position</span> = <span class="nu0">0</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> htmlEE = parent. <span class="me1">Createchildentity</span> <span class="br0">(</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> htmlEE. <span class="me1">Setcontentfromtext</span> <span class="br0">(</span>htmlStream, <span class="st0">"text/html;charset=UTF-8"</span>, ENC_IDENTITY_7BIT <span class="br0">)</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> doc. <span class="me1">Replaceitemvalue</span> <span class="br0">(</span> <span class="st0">"containsEE"</span>, <span class="st0">"URL"</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> doc. <span class="me1">Save</span> <span class="br0">(</span> <span class="kw1">true</span>, <span class="kw1">true</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; s. <span class="me1">Convertmime</span> = <span class="kw1">true</span> 
 <br> <span class="kw1">End</span> <span class="kw1">Sub</span> 
 <br> <span class="coMULTI">%REM<br> &nbsp; &nbsp; Sub generateEEParts<br> &nbsp; &nbsp; Description: Creates the body content for <br> %END REM</span> 
 <br> <span class="kw1">Sub</span> generateEEParts <span class="br0">(</span>stream <span class="kw1">As</span> <span class="kw2">NotesStream</span>, outJSON <span class="kw1">As</span> <span class="kw2">NotesStream</span>, outHTML <span class="kw1">As</span> <span class="kw2">NotesStream</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> workstring <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> url <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> ParamName <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> ParamValue <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> position <span class="kw1">As</span> <span class="kw1">Integer</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> isFirst <span class="kw1">As</span> <span class="kw1">Boolean</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> eolChars <span class="kw1">List</span> <span class="kw1">As</span> <span class="kw1">Integer</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> eolPos <span class="kw1">As</span> <span class="kw1">Integer</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> i <span class="kw1">As</span> <span class="kw1">Integer</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> x <span class="kw1">As</span> <span class="kw1">String</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; eolChars <span class="br0">(</span> <span class="nu0">0</span> <span class="br0">)</span> = <span class="nu0">10</span> 
 <br> &nbsp; &nbsp; eolChars <span class="br0">(</span> <span class="nu0">1</span> <span class="br0">)</span> = <span class="nu0">13</span> 
 <br> &nbsp; &nbsp; eolChars <span class="br0">(</span> <span class="nu0">2</span> <span class="br0">)</span> = <span class="nu0">42</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="co1">'Create the URL </span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;h1 style="background-color : Yellow; font-family: Verdana, Arial, sans-serif"&gt;Workflow notification (URL)&lt;/h1&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;table border="0" cellpadding="2" cellspacing="2"&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;tr&gt;&lt;th style="border : 1px solid gray; font-family: Verdana, Arial, sans-serif"&gt;Parameter&lt;/th&gt;&lt;th style="border: 1px solid gray; font-family: Verdana, Arial, sans-serif"&gt;Value&lt;/th&gt;&lt;/tr&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="co1">'Loop through all the items</span> 
 <br> &nbsp; &nbsp; stream. <span class="me1">Position</span> = <span class="nu0">0</span> 
 <br> &nbsp; &nbsp; workstring = stream. <span class="me1">Readtext</span> <span class="br0">(</span>STMREAD_LINE , EOL_ANY <span class="br0">)</span> 
 <br> &nbsp; &nbsp; isFirst = <span class="kw1">true</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Do</span> <span class="kw1">Until</span> workString = <span class="st0">""</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">For</span> eolPos = <span class="nu0">1</span> <span class="kw1">To</span> <span class="kw1">Len</span> <span class="br0">(</span>workString <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; x = x + <span class="kw1">CStr</span> <span class="br0">(</span> <span class="kw1">Asc</span> <span class="br0">(</span> <span class="kw1">Mid$</span> <span class="br0">(</span>workstring,eolPos, <span class="nu0">1</span> <span class="br0">)</span> <span class="br0">)</span> <span class="br0">)</span>+ <span class="st0">"-"</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Next</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'Cleanup workstring - remove 10/13 combinations</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">ForAll</span> curChar <span class="kw1">In</span> eolChars 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eolPos = <span class="kw1">InStr</span> <span class="br0">(</span>workstring, <span class="kw1">Chr$</span> <span class="br0">(</span>curChar <span class="br0">)</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">While</span> <span class="br0">(</span>eolPos &gt; <span class="nu0">0</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; workstring = <span class="kw1">Left$</span> <span class="br0">(</span>workstring,eolPos- <span class="nu0">1</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; eolPos = <span class="kw1">InStr</span> <span class="br0">(</span>workstring, <span class="kw1">Chr$</span> <span class="br0">(</span>curChar <span class="br0">)</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Wend</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">ForAll</span> 
 <br> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; position = <span class="kw1">InStr</span> <span class="br0">(</span>workstring, <span class="st0">":"</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> position &gt; <span class="nu0">0</span> <span class="kw1">Then</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'We have a line with a Name / Value Pair</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ParamName = <span class="kw1">Replace</span> <span class="br0">(</span> <span class="kw1">Trim$</span> <span class="br0">(</span> <span class="kw1">Left$</span> <span class="br0">(</span>workstring,position- <span class="nu0">1</span> <span class="br0">)</span> <span class="br0">)</span>, <span class="st0">|"|</span>, <span class="st0">|\"|</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ParamValue = <span class="kw1">Replace</span> <span class="br0">(</span> <span class="kw1">Trim$</span> <span class="br0">(</span> <span class="kw1">Mid$</span> <span class="br0">(</span>workstring,position+ <span class="nu0">1</span> <span class="br0">)</span> <span class="br0">)</span>, <span class="st0">|"|</span>, <span class="st0">|\"|</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> <span class="kw1">Left$</span> <span class="br0">(</span>ParamValue, <span class="nu0">4</span> <span class="br0">)</span> = <span class="st0">"http"</span> <span class="kw1">Then</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outJSON. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|{ "url" &nbsp;: "|</span>+ParamValue+ <span class="st0">|" }|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">If</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;tr&gt;&lt;td style="border: 1px solid gray; font-family: Verdana, Arial, sans-serif"&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span>ParamName,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;/td&gt;&lt;td style="border-bottom : 1px solid gray; border-right: 1px solid gray; font-family: Verdana, Arial, sans-serif"&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span>ParamValue,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;/td&gt;&lt;/tr&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">If</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; workstring = stream. <span class="me1">Readtext</span> <span class="br0">(</span>STMREAD_LINE , EOL_Platform <span class="br0">)</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Loop</span> 
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="co1">'Write out the closing</span> 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> outHTML. <span class="me1">writeText</span> <span class="br0">(</span> <span class="st0">|&lt;/table&gt;|</span>,EOL_PLATFORM <span class="br0">)</span> 
 <br> &nbsp; &nbsp; 
 <br> <span class="kw1">End</span> <span class="kw1">Sub</span> 
 <br> <span class="kw1">Sub</span> addHeader <span class="br0">(</span>mime <span class="kw1">As</span> <span class="kw2">NotesMIMEEntity</span>, hName <span class="kw1">As</span> <span class="kw1">String</span>, value <span class="kw1">As</span> <span class="kw1">String</span> <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Dim</span> header <span class="kw1">As</span> <span class="kw2">NotesMIMEHeader</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> header = mime. <span class="me1">CreateHeader</span> <span class="br0">(</span>hName <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> header <span class="kw1">Is</span> <span class="kw1">Nothing</span> <span class="kw1">Then</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> header = mime. <span class="me1">Getnthheader</span> <span class="br0">(</span>hname <span class="br0">)</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span> <span class="kw1">If</span> 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> header. <span class="me1">SetHeaderVal</span> <span class="br0">(</span>value <span class="br0">)</span> 
 <br> <span class="kw1">End</span> <span class="kw1">Sub</span> 
</div> As usual: YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 03 November 2013
<span class="divider">|</span>
<a href="/blog/2013/11/driving-embedded-experiences-adoption.html#comments">Comments (3)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/ibmnotes.html">IBM Notes</a>  <a href="/blog/categories/xpages.html">XPages</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2013/11/driving-embedded-experiences-adoption.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_A32B70C364D2096148257C18004C2E88" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_A32B70C364D2096148257C18004C2E88"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Stephan Wissel</b> on <i>Monday 04 November 2013 AD</i>:<br /> 
  @David, I just checked, and there are Gadgets listed for embedded experiences in a pretty plain Confluence installation, so they are there (just 
  <a href="https://www.google.com/search?client=ubuntu&amp;channel=fs&amp;q=conf-activitystream-gadget.xml" rel="nofollow" target="blank"> google it</a>). Also the 
  <a href="https://opensocial.atlassian.net/wiki/display/OSREF/Embedded+Experiences+Tutorial" rel="nofollow" target="blank">documetation for OpenSocial</a> is in Confluence. 
  <br /> 
  <br /> 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" /> stw
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Robert Ibsen Voith</b> on <i>Monday 04 November 2013 AD</i>:<br /> 
  Thanks for sharing! Most interesting - and very timely!
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>David Simpson</b> on <i>Monday 04 November 2013 AD</i>:<br /> 
  Hi Stephan, thanks for posting this. A minor correction Atlassian Confluence does not have embedded experience inbuilt. 
  <br /> 
  <br /> 
  <img alt="Emoticon smile.gif" src="/blog/images/emoticons/smile.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2013/09/aggregating-view-data-for-use-in-d3js-graphics.html"><i class="icon-hand-left"></i>Aggregating view data for use in d3js graphics</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2013/11/elearning-are-we-there-yet.html">eLearning - are we there yet?<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/">2013</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/ibmnotes.html">IBM Notes</a>
  </li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2013/11/driving-embedded-experiences-adoption.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "A32B70C364D2096148257C18004C2E88");
 		};
	</script>

</body>
</html>
