<!DOCTYPE html>
<html lang="en">
<head>
<title>NotesSensei's Blog - Don&amp;apos;t try this at home!</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
<meta name="ROBOTS" content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title" content="NotesSensei's Weblog - Don&amp;apos;t try this at home!" />
<meta name="Author" content="Stephan H. Wissel" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta name="description"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="Keywords"
	content="lotus,domino,quickplace,sametime,blog,template,blogging,blogger,notes,r6,r5,raven,k-station,nsf,ntf,websphere,agile,sdlc,j2ee,.net,personcentric,singapore,twins" />
<meta name="Abstract"
	content="Thoughts, Insights and Opinions of Stephan H. Wissel. Topics included: IBM Lotus Notes and Domino, IBM Websphere, other IBM Lotus stuff,  J2EE, .Net, Software Archtecture, Personcentric Development, Agile Software, SDLC, Singapore and my Twins" />
<meta name="ICBM" content="1.2994, 103.8425" />
<meta name="Copyright"
	content="2013,2015 Stephan H. Wissel - Creative commons licence" />
<meta HTTP-EQUIV="Content-Language" content="en" />
<meta property="fb:admins" content="567103136" />
<meta property="fb:app_id" content="219323514774289">
<meta property="og:title"
	content="wissel.net - Don&amp;apos;t try this at home!" />
<meta property="og:type" content="blog" />
<meta property="og:url" content="https://wissel.net/blog" />
<meta property="og:image"
	content="//www.wissel.net/blog/skin/OrangeKeys.css/$File/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<meta name="twitter:site" content="@notessensei" />
<meta name="twitter:card" content="summary" />
<meta name="xing:author"
	content="https://www.xing.com/profile/StephanH_Wissel" />

<link rel="stylesheet" type="text/css" href="/blog/css/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/shariff.complete.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />


<link rel="stylesheet" href="/blog/css/markdown.css" />
<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnet" />
<link rel="alternate" type="application/rss+xml" title="RSS Comments Feed" href="https://feeds.feedburner.com/Wisselnet-Comments" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>


	<div class="container">

    		<!-- Masthead
		================================================== -->
		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <!--[if lt IE 10]>
  <div style='border: 1px solid #F7941D; background: #FEEFDA; text-align: center; clear: both; height: 75px; position: relative;'>
    <div style='position: absolute; right: 3px; top: 3px; font-family: courier new; font-weight: bold;'><a href='#' onclick='javascript:this.parentNode.parentNode.style.display="none"; return false;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-cornerx.jpg' style='border: none;' alt='Close this notice'/></a></div>
    <div style='width: 640px; margin: 0 auto; text-align: left; padding: 0; overflow: hidden; color: black;'>
      <div style='width: 75px; float: left;'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-warning.jpg' alt='Warning!'/></div>
      <div style='width: 275px; float: left; font-family: Arial, sans-serif;'>
        <div style='font-size: 14px; font-weight: bold; margin-top: 12px;'>You are using an outdated browser</div>
        <div style='font-size: 12px; margin-top: 6px; line-height: 12px;'>For a better experience using this site, please upgrade to a modern web browser.</div>
      </div>
      <div style='width: 75px; float: left;'><a href='http://www.firefox.com' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-firefox.jpg' style='border: none;' alt='Get Firefox'/></a></div>
      <div style='width: 75px; float: left;'><a href='http://www.browserforthebetter.com/download.html' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-ie8.jpg' style='border: none;' alt='Get Internet Explorer 11'/></a></div>
      <div style='width: 73px; float: left;'><a href='http://www.apple.com/safari/download/' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-safari.jpg' style='border: none;' alt='Get Safari'/></a></div>
      <div style='float: left;'><a href='http://www.google.com/chrome' target='_blank'><img src='http://www.ie6nomore.com/files/theme/ie6nomore-chrome.jpg' style='border: none;' alt='Get Google Chrome'/></a></div>
    </div>
  </div>
<![endif]-->

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/">2013</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/05/">May</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/XPages.html">XPages</a>
  </li>
</ul>


		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2013/05/enterprise-20-and-weight-loss-siblings-separated-at-birth.html"><i class="icon-hand-left"></i>Enterprise 2.0 and weight loss - siblings separated at birth?</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2013/05/shadowit.html">ShadowIT<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1>
						<small>Don&apos;t try this at home!</small>
					</h1>
					<hr />
					<div>Domino has a refined security system, so the 
<a href="https://www.google.com/search?q=Domino+XPages+java.policy">java.policy</a> file can be a real PITA. So you would be tempted to write a few lines of LotusScript and run it on a scheduled agent, so on the next server restart that pain goes away. Of course you wouldn't write code like below which lacks any error handling.You also would not hide this code from your admin people who would want an impact study and your firstborn for any change they make. So instead of doing all this you wait until there is a proper configuration setting for this. 
<div class="lotusscript"> 
 <span class="kw1">Option</span> 
 <span class="kw1">Public</span> 
 <br /> 
 <span class="kw1">Option</span> 
 <span class="kw1">Declare</span> 
 <br /> 
 <br /> 
 <span class="kw1">Sub</span> Initialize 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> s 
 <span class="kw1">As</span> 
 <span class="kw1">New</span> 
 <span class="kw2">NotesSession</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> inikey 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> secFileName 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> stream 
 <span class="kw1">As</span> 
 <span class="kw2">NotesStream</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> policy 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> beginString 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> endString 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> permission 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> beginPos 
 <span class="kw1">As</span> 
 <span class="kw1">Integer</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> endPos 
 <span class="kw1">As</span> 
 <span class="kw1">Integer</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; inikey = 
 <span class="st0">&quot;NotesProgram&quot;</span> 
 <br /> &nbsp; &nbsp; beginString = 
 <span class="st0">&quot;grant {&quot;</span> 
 <br /> &nbsp; &nbsp; endString = 
 <span class="st0">&quot;}&quot;</span> 
 <br /> &nbsp; &nbsp; secFileName = s. 
 <span class="me1">Getenvironmentstring</span> 
 <span class="br0">(</span>iniKey, 
 <span class="kw1">true</span> 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; secFileName = secFileName + 
 <span class="st0">&quot;jvm/lib/security/java.policy&quot;</span> 
 <br /> &nbsp; &nbsp; permission = 
 <span class="st0">&quot;permission java.security.AllPermission;&quot;</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Set</span> stream = s. 
 <span class="me1">Createstream</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Open</span> 
 <span class="br0">(</span>secFileName 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; policy = stream. 
 <span class="me1">Readtext</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; beginPos = 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>policy,beginString 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">If</span> beginPos &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="co1">'We don't have any so we abort</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Exit</span> 
 <span class="kw1">sub</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> firstCut 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; firstCut = 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy,beginPos 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; endPos = 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>firstCut,endString 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">If</span> endPos &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="co1">'The file is borked</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Exit</span> 
 <span class="kw1">Sub</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Dim</span> allGrant 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> &nbsp; &nbsp; allGrant = 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>firstCut, 
 <span class="nu0">1</span>,endPos 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="co1">'Now the check</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">If</span> 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>allGrant,permission 
 <span class="br0">)</span> &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="co1">'We need to update the file</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Truncate</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span> 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy, 
 <span class="nu0">1</span>,beginPos+ 
 <span class="nu0">7</span> 
 <span class="br0">)</span>, EOL_NONE 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>permission, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span> 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy,beginPos+ 
 <span class="nu0">7</span> 
 <span class="br0">)</span>, EOL_NONE 
 <span class="br0">)</span> 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> &nbsp; &nbsp; 
 <br /> &nbsp; &nbsp; 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Close</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">Sub</span> 
</div> As usual YMMV<br /> 
<b>Update</b>: Going after java.pol requires a slightly different approach: 
<div class="lotusscript"> 
 <span class="kw1">Option</span> 
 <span class="kw1">Public</span> 
 <br /> 
 <span class="kw1">Option</span> 
 <span class="kw1">Declare</span> 
 <br /> 
 <br /> 
 <span class="kw1">Sub</span> Initialize 
 <br /> 
 <span class="kw1">Dim</span> s 
 <span class="kw1">As</span> 
 <span class="kw1">New</span> 
 <span class="kw2">NotesSession</span> 
 <br /> 
 <span class="kw1">Dim</span> inikey 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <span class="kw1">Dim</span> secFileName 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <span class="kw1">Dim</span> stream 
 <span class="kw1">As</span> 
 <span class="kw2">NotesStream</span> 
 <br /> 
 <span class="kw1">Dim</span> policy 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <br /> 
 <span class="kw1">Dim</span> beginString 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <span class="kw1">Dim</span> endString 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <span class="kw1">Dim</span> permission 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> 
 <br /> 
 <span class="kw1">Dim</span> beginPos 
 <span class="kw1">As</span> 
 <span class="kw1">Integer</span> 
 <br /> 
 <span class="kw1">Dim</span> endPos 
 <span class="kw1">As</span> 
 <span class="kw1">Integer</span> 
 <br /> 
 <br /> inikey = 
 <span class="st0">&quot;NotesProgram&quot;</span> 
 <br /> beginString = 
 <span class="st0">&quot;grant {&quot;</span> 
 <br /> endString = 
 <span class="st0">&quot;}&quot;</span> 
 <br /> secFileName = s. 
 <span class="me1">Getenvironmentstring</span> 
 <span class="br0">(</span>iniKey, 
 <span class="kw1">true</span> 
 <span class="br0">)</span> 
 <br /> secFileName = secFileName + 
 <span class="st0">&quot;jvm/lib/security/java.pol&quot;</span> 
 <br /> permission = 
 <span class="st0">&quot;permission java.security.AllPermission;&quot;</span> 
 <br /> 
 <span class="kw1">Set</span> stream = s. 
 <span class="me1">Createstream</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <br /> 
 <span class="co1">'Open or create the file</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Open</span> 
 <span class="br0">(</span>secFileName 
 <span class="br0">)</span> 
 <br /> 
 <br /> 
 <span class="co1">'A new file would be IsEOS</span> 
 <br /> 
 <span class="kw1">If</span> stream. 
 <span class="me1">Iseos</span> 
 <span class="kw1">Then</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>beginString, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>permission, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>endString, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Close</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Exit</span> 
 <span class="kw1">Sub</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> 
 <br /> 
 <span class="co1">'Read the entire file in one go</span> 
 <br /> policy = stream. 
 <span class="me1">Readtext</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <br /> beginPos = 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>policy,beginString 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">If</span> beginPos &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> 
 <span class="co1">'We don't have any general grant statement, so we need to add it</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span> 
 <span class="st0">&quot;&quot;</span>, EOL_PLATFORM 
 <span class="br0">)</span> 
 <span class="co1">'One new line</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>beginString, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>permission, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>endString, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Close</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Exit</span> 
 <span class="kw1">sub</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> 
 <br /> 
 <span class="kw1">Dim</span> firstCut 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> firstCut = 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy,beginPos 
 <span class="br0">)</span> 
 <br /> endPos = 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>firstCut,endString 
 <span class="br0">)</span> 
 <br /> 
 <br /> 
 <span class="kw1">If</span> endPos &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> 
 <span class="co1">'The file is borked, we won't touch it!</span> 
 <br /> 
 <span class="kw1">Exit</span> 
 <span class="kw1">Sub</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> 
 <br /> 
 <span class="kw1">Dim</span> allGrant 
 <span class="kw1">As</span> 
 <span class="kw1">String</span> 
 <br /> allGrant = 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>firstCut, 
 <span class="nu0">1</span>,endPos 
 <span class="br0">)</span> 
 <br /> 
 <br /> 
 <span class="co1">'Now the check</span> 
 <br /> 
 <span class="kw1">If</span> 
 <span class="kw1">InStr</span> 
 <span class="br0">(</span>allGrant,permission 
 <span class="br0">)</span> &lt; 
 <span class="nu0">1</span> 
 <span class="kw1">Then</span> 
 <br /> 
 <span class="co1">'We need to update the file</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Truncate</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span> 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy, 
 <span class="nu0">1</span>,beginPos+ 
 <span class="nu0">7</span> 
 <span class="br0">)</span>, EOL_NONE 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span>permission, EOL_PLATFORM 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="me1">Writetext</span> 
 <span class="br0">(</span> 
 <span class="kw1">Mid$</span> 
 <span class="br0">(</span>policy,beginPos+ 
 <span class="nu0">7</span> 
 <span class="br0">)</span>, EOL_NONE 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">If</span> 
 <br /> 
 <br /> 
 <span class="kw1">Call</span> stream. 
 <span class="kw1">Close</span> 
 <span class="br0">(</span> 
 <span class="br0">)</span> 
 <br /> 
 <span class="kw1">End</span> 
 <span class="kw1">Sub</span> 
</div></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 2013-05-22 02:32
<span class="divider">|</span>
<a href="/blog/2013/05/dont-try-this-at-home.html#comments">Comments (10)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/XPages.html">XPages</a> 

						<div class="shariff" data-lang="en" data-url="https://www.notessensei.com/blog/2013/05/dont-try-this-at-home.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-title="Don&apos;t try this at home!"></div>
						<script type="text/javascript">
							var permaLink = "https://www.notessensei.com/blog/2013/05/dont-try-this-at-home.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_3D95D8BE3A2AC2D048257B720065D644" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_3D95D8BE3A2AC2D048257B720065D644"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
<img src="//www.gravatar.com/avatar/126d36c5b458c9b16c7ed76d4f00d40b.jpg?s=88" class="gravatarimg" />
							posted by <b>Declan Lynch</b> on <i>Wednesday 22 May 2013 AD - 03:22 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  And the good admins would have an ECL set on the server which would forbid file system changes. 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/25978fc33002971d42497036b3d28fb8.jpg?s=88" class="gravatarimg" />
							posted by <b>urs meli</b> on <i>Wednesday 22 May 2013 AD - 04:18 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Good admins would do the change to keep their devs happy
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/aa53d52b26dfd8f7f9b1735fb5891d94.jpg?s=88" class="gravatarimg" />
							posted by <b>Karsten Lehmann</b> on <i>Wednesday 22 May 2013 AD - 05:12 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  I don't see a reason for this, as long as I can deploy OSGi plugins on the server. 
  <img alt="Emoticon wink.gif" src="/blog/images/emoticons/wink.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/cd57cb246c676d426588becd4305eb96.jpg?s=88" class="gravatarimg" />
							posted by <b>Thomas Hampel</b> on <i>Wednesday 22 May 2013 AD - 06:19 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Good admins cooperate with developers by sharing the code above, by maintaining a common documentation, and exploring the platform capabilities together! Admins and developers have a joint mission and therefore must be best friends! Hint: if thats not the case yet, invite him/her for a drink!
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/2700093cde972d5ef286572a56f95e84.jpg?s=88" class="gravatarimg" />
							posted by <b>Chris Miller</b> on <i>Wednesday 22 May 2013 AD - 06:34 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Good admins say we can't read this code and deny it will even work 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/8b244c19421b34079796e5e64fc8ff75.jpg?s=88" class="gravatarimg" />
							posted by <b>Stephan H. Wissel</b> on <i>Wednesday 22 May 2013 AD - 12:25 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @Karsten: deploying OSGi plugins requires setting a Notes.ini variable - big battle already 
  <img alt="Emoticon smile.gif" src="/blog/images/emoticons/smile.gif" border="0" />, but I agree 
  <br /> 
  <br />@Chris: they wont' see that code, since you wouldn't hide somewhere inside an innocent function (or even in a lss where you didn't provide the source) 
  <br /> 
  <br />@All: &quot;Good admins&quot; are characters found where you also find toothferries and unicorns (except Paul of course)
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/aa53d52b26dfd8f7f9b1735fb5891d94.jpg?s=88" class="gravatarimg" />
							posted by <b>Karsten Lehmann</b> on <i>Wednesday 22 May 2013 AD - 12:42 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @Stephan: 
  <br />Right, but that Notes.ini variable only has to be set once. For a customer, we have developed some code (LotusScript BTW) that runs when you open the nsf via url /path/to/db.nsf and that checks if all required plugins are deployed and running on the server. 
  <br />If not, we display an info message with a button to copy the missing pieces from the app's design into the update site nsf (and create it if missing). 
  <br />Now we check if that Notes.ini variable is set. If not, we display another info message for the admin. 
  <br />Finally, we try to call an XPage via xhr. If that fails, we display another button, that everything seems to be installed, but http task needs to be restarted. 
  <br />If everything is ok, we redirect to the XPages app. 
  <img alt="Emoticon smile.gif" src="/blog/images/emoticons/smile.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/adfeda530786fcecc7baeedc28331fcf.jpg?s=88" class="gravatarimg" />
							posted by <b>Giulio Campobassi</b> on <i>Wednesday 22 May 2013 AD - 13:36 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  I think this would fall under the category of &quot;trust me, it's hacking for the greater good&quot;
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/29fe7c89751645e5511b900c3925ee42.jpg?s=88" class="gravatarimg" />
							posted by <b>Simon O&#39;Doherty</b> on <i>Wednesday 22 May 2013 AD - 20:35 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  A good example of why you never give the developers any ability to run code on production servers. 
  <img alt="Emoticon smile.gif" src="/blog/images/emoticons/smile.gif" border="0" /> 
  <br /> 
  <br />Change requests and ECL control under Admin's thumb!
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/2d120998c078dca1932259a0692e1097.jpg?s=88" class="gravatarimg" />
							posted by <b>Peter Presnell</b> on <i>Wednesday 22 May 2013 AD - 20:39 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  For an example coded in LotusScript I am surprised the accompanying text wasn't written in Latin. 
  <img alt="Emoticon tongue.gif" src="/blog/images/emoticons/tongue.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/3b1c93c07c543a757dc6a507b5268a31.jpg?s=88" class="gravatarimg" />
							posted by <b>John Dalsgaard</b> on <i>Wednesday 22 May 2013 AD - 22:26 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Well, you could talk to your admin once (the first time) and then agree upon the need for an adjustment. 
  <br /> 
  <br />However, instead of changing the java.policy file I suggest you create a file named &quot;java.pol&quot; in the same directory and make your changes there. Changes in this file are not overwritten by updates to Notes/Domino. 
  <br /> 
  <br />You can see the configuration of the usage of java.pol in the file java.security 
  <img alt="Emoticon wink.gif" src="/blog/images/emoticons/wink.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/d624e774e5f1cb9d58b25ba7610ba4f7.jpg?s=88" class="gravatarimg" />
							posted by <b>Nathan T. Freeman</b> on <i>Thursday 23 May 2013 AD - 01:43 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @John THANK YOU!!! That's a hot tip!
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/3b1c93c07c543a757dc6a507b5268a31.jpg?s=88" class="gravatarimg" />
							posted by <b>John Dalsgaard</b> on <i>Thursday 23 May 2013 AD - 04:38 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @Nathan - You're welcome 
  <img alt="Emoticon wink.gif" src="/blog/images/emoticons/wink.gif" border="0" />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/e9a51aeb928ef8080242274590dde924.jpg?s=88" class="gravatarimg" />
							posted by <b>liliakress</b> on <i>Monday 12 August 2013 AD - 16:25 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  Hello, this is a really fas&shy;ci&shy;nat&shy;ing web blog and I have loved read&shy;ing sev&shy;eral of the arti&shy;cles and posts con&shy;tained upon the site, sus&shy;tain the great work and hope to read a lot more excit&shy;ing arti&shy;cles in the time to&nbsp;come. Thank you so much. 
  <br />
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/275fc50abaf1e880b13853446c369f73.jpg?s=88" class="gravatarimg" />
							posted by <b>Marco Wertel</b> on <i>Wednesday 18 February 2015 AD - 15:11 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @Karsten: Can you share some code pieces with us to check if all necessary stuff for the XPages application is available? Highly interested in that. Thank you.
 </body>
</html>
							<hr style="clear : both" />
						</li> 						<li>
<img src="//www.gravatar.com/avatar/aa53d52b26dfd8f7f9b1735fb5891d94.jpg?s=88" class="gravatarimg" />
							posted by <b>Karsten Lehmann</b> on <i>Monday 23 February 2015 AD - 17:17 Singapore Time</i>:<br /> <html>
 <head></head>
 <body>
  @Marco: I can't share the exact code. Maybe I can find the time to blog about the idea and provide a small sample, but I am very busy at the moment. 
  <br />The general idea is to set the DB launch options to a page or frameset and do the check in LotusScript, e.g. as WebQueryOpen agent. 
  <br /> 
  <br />You first check for the OSGI_HTTP_DYNAMIC_BUNDLES Notes.ini variable. If it is missing, you can either tell the user to let the admin add it and restart the server or you can just add the variable to the server's configuration document yourself (your NSF needs to be signed with a server or admin ID to do this). 
  <br /> 
  <br />Next you read the content of -dominodata-/data/domino/workspace/.config/org.eclipse.update/platform.xml and search for the required Eclipse features. 
  <br />If they are missing, you can check if they are already stored in the update site NSF. If not, you can add them in your code (we store the plugin/feature document as design elemente in the DB design for this purpose) or let the admin do it. If they are in the update site, the HTTP task has not been restarted since adding them. 
  <br /> 
  <br />I hope you get the idea. There are a lot of different error states to cover to do this properly. 
  <br /> 
  <br />We asked IBM twice in the last 3 years to just open a classic form if plugins are missing, similar to the general error pages for classic web development in Domino and add some information to it so that our code can either display a proper error message, but it's not in the product yet. Looks like this feature has no priority. 
  <br /> 
  <br />Another approach to make plugin deployment easier might be to copy the lookup views of the update site NSF ($Lookup OSGi features / loader / plugins) to your application database and modify their $FormulaClass field so that they display design documents instead of data documents. Next you write some code that imports content of an update site NSF into the database design of your application (e.g. by duplicating a page design element and copying all fields and attachments). 
  <br /> 
  <br />The result is that your application database contains both the application code and all required plugins. You can them point the OSGI_DYNAMIC_BUNDLES variable to your application NSF. The code that loads the plugins does not care whether the lookup views contain data documents or design documents. 
  <br /> 
  <br />
 </body>
</html>
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2013/05/enterprise-20-and-weight-loss-siblings-separated-at-birth.html"><i class="icon-hand-left"></i>Enterprise 2.0 and weight loss - siblings separated at birth?</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2013/05/shadowit.html">ShadowIT<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/">2013</a> <span class="divider">/</span></li>
  <li><a href="/blog/2013/05/">May</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/XPages.html">XPages</a>
  </li>
</ul>

	</div>
<!-- Footer	================================================== -->
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I am the "IBM Cloud Development Advocate for Collaboration". I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog"></g:plusone>
					</p>
					<script src="//stackoverflow.com/users/flair/131021.js?theme=default" type="text/javascript"></script>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://plus.google.com/+StephanWissel/about" rel="author" style="text-decoration: none;">
						    <img src="https://ssl.gstatic.com/images/icons/gplus-16.png" alt="" style="border: 0; width: 16px; height: 16px;" /> Google+</a></li>
						<li><a href="skype//:notessensei?chat">Skype</a></li>
						<li><a href="/blog/2010/04/communicating-with-ibmers-and-lotus-professionals-using-sametime.html"
							   title="Many ways to use Sametime, no own Sametime server required">Sametime</a></li>
						<li><a href="http://www.ibm.com/contact/employees/servlets/lookup?lastname=Wissel&amp;firstname=Stephan">IBM</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by Lotus Software nor IBM Corporation.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						IBM's - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2017 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="http://creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2013/05/dont-try-this-at-home.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/jquery.fittext.js"></script>
	<script type="text/javascript" src="/blog/js/main.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>   
    <script type="text/javascript">
		SyntaxHighlighter.all();
    </script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
	
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/comments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api/js/recaptcha_ajax.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			renderComment("6LcUOewSAAAAACAI4zVcGFVkGWmp0sUH5gabwy1q", "3D95D8BE3A2AC2D048257B720065D644");
		});
	</script>

</body>
</html>
