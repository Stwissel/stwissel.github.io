<!DOCTYPE html>
<html lang="en">
<head>
<title>Update all views in a database - web style - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Update all views in a database - web style" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2010/11/update-all-views-in-a-database-web-style.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Update all views in a database - web style" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Update all views in a database - web style - It is a bad idea to check the property &#39;hide from Notes client&#39; on a view. If you do this you burden your HTTP task with refreshing that view rather than leaving that to the indexer task (which would run in its own thread on its own processor(s). The better way to hide views from Notes clients (for " />
<meta name="Keywords"
	content="Show-N-Tell Thursday," />
<meta name="Abstract"
	content="Update all views in a database - web style - It is a bad idea to check the property &#39;hide from Notes client&#39; on a view. If you do this you burden your HTTP task with refreshing that view rather than leaving that to the indexer task (which would run in its own thread on its own processor(s). The better way to hide views from Notes clients (for " />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8585SX" title="originally published at /blog/d6plinks/SHWL-8585SX">SHWL-8585SX</a>
	</li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/11/firefox-takes-a-page-from-the-notes-ui.html"><i class="icon-hand-left"></i>Firefox takes a page from the Notes UI</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/12/loading-html-or-xml-content-in-lotusscript-over-http.html">Loading HTML or XML Content in LotusScript over HTTP<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Update all views in a database - web style</small></h1>
					<hr />
					<div>It is a bad idea to check the property "hide from Notes client" on a view. If you do this you burden your HTTP task with refreshing that view rather than leaving that to the indexer task (which would run in its own thread on its own processor(s). The better way to hide views from Notes clients (for convenience) is to start their name with <code>(</code>. The <a href="http://techlab.ytria.com/485/lotus-notes-secrets/hiding-views-notes-client-bring-domino-server-knees/">Performance impact</a> can be quite positive once you fix them (and bad if you don't). Until you get the approval and find the time to fix the view visibility a method is needed to quickly update all database views from a web perspective. In my toolbox there is a little script that does exactly that. The nice aspect of it: it lives in a utility database and takes the database to work on as a parameter: 
<br><code>http://mywebserver/senseitoolbox.nsf/webupdateviews?openAgent&amp;database=apps/hr/webleave.nsf</code> The agent renders a page with a link to each view in the database (I don't check for the "hide from web" property) and an Ajax call that opens ever view once through the URL and records completion. Completion doesn't imply success. I'm not monitoring for return codes or so. The agent is a good interim helper until the view visibility to the indexing task has been restored. 
<br> As usual YMMV<div class="lotusscript"><span class="coMULTI">%REM<br> &nbsp; &nbsp; Agent (webUpdateViews)<br> &nbsp; &nbsp; Created Nov 23, 2010 by Stephan H Wissel/Singapore/IBM<br> &nbsp; &nbsp; Description: Agent to refesh all views in the database using URL open<br> %END REM</span>
 <br><span class="kw1">Option</span><span class="kw1">Public</span>
 <br><span class="kw1">Option</span><span class="kw1">Declare</span>
 <br>
 <br><span class="kw1">Public</span><span class="kw1">Const</span> queryStringName = <span class="st0">"QUERY_STRING_DECODED"</span>
 <br>
 <br><span class="kw1">Sub</span> Initialize 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> s <span class="kw1">As</span><span class="kw1">New</span><span class="kw2">NotesSession</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> db <span class="kw1">As</span><span class="kw2">NotesDatabase</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> workDB <span class="kw1">As</span><span class="kw2">NotesDatabase</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> doc <span class="kw1">As</span><span class="kw2">NotesDocument</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> db = s. <span class="me1">Currentdatabase</span>
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> doc = s. <span class="me1">Documentcontext</span>
 <br>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> dbNameItem <span class="kw1">As</span><span class="kw2">NotesItem</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> work <span class="kw1">As</span><span class="kw1">Variant</span><span class="co1">'For the evaluation of the database</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> doc. <span class="me1">Hasitem</span><span class="br0">(</span>queryStringName <span class="br0">)</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Print</span><span class="st0">"You need a querystring for this agent to work"</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">sub</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> dbNameItem = doc. <span class="me1">Getfirstitem</span><span class="br0">(</span>queryStringName <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="co1">'Get the database name on the server</span>
 <br> &nbsp; &nbsp; work = <span class="kw1">Evaluate</span><span class="br0">(</span><span class="st0">|@trim(@Left(@Right("|</span>+dbNameItem. <span class="kw1">Text</span>+ <span class="st0">|&amp;";"&amp;database=");"&amp;"))|</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">If</span> work <span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> = <span class="st0">""</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Print</span><span class="st0">"You need to specify the database on the server with &amp;amp;database="</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">sub</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> workDB = <span class="kw1">New</span><span class="kw2">NotesDatabase</span><span class="br0">(</span><span class="st0">""</span>,work <span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> workDB. <span class="me1">Isopen</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> workDB. <span class="kw1">Open</span><span class="br0">(</span><span class="st0">""</span>, <span class="st0">""</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> workDB. <span class="me1">Isopen</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Print</span><span class="st0">"Could not open the database "</span>+work <span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Exit</span><span class="kw1">sub</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> RenderAjax <span class="br0">(</span>s, workDB <span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br><span class="kw1">End</span><span class="kw1">Sub</span>
 <br>
 <br>
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; Sub RenderAjax<br> &nbsp; &nbsp; Description: Renders a HTML Page that goes nicely with Ajax<br> %END REM</span>
 <br><span class="kw1">Sub</span> RenderAjax <span class="br0">(</span>s <span class="kw1">As</span><span class="kw2">NotesSession</span>, db <span class="kw1">As</span><span class="kw2">NotesDatabase</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> out <span class="kw1">As</span><span class="kw2">NotesStream</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> script <span class="kw1">As</span><span class="kw2">NotesStream</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> url <span class="kw1">As</span><span class="kw1">String</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> curVurl <span class="kw1">As</span><span class="kw1">String</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> i <span class="kw1">As</span><span class="kw1">Integer</span>
 <br> &nbsp; &nbsp; <span class="kw1">Dim</span> v <span class="kw1">As</span><span class="kw2">NotesView</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">If</span> db. <span class="me1">Httpurl</span> = <span class="st0">""</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; url = <span class="st0">"http://localhost/__"</span>+db. <span class="me1">Replicaid</span>+ <span class="st0">".nsf/"</span>
 <br> &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; url = db. <span class="me1">Httpurl</span>+ <span class="st0">"/"</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> out = s. <span class="me1">Createstream</span><span class="br0">(</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Set</span> script = s. <span class="me1">Createstream</span><span class="br0">(</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> script. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;script language="JavaScript" type="text/javascript"&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> addJSFunctions <span class="br0">(</span>script <span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">"&lt;h1&gt;Auto Refresh for "</span>+db. <span class="me1">Filepath</span> + <span class="st0">"&lt;/h1&gt;"</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;h2&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span>url,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;/h2&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;div id="result"&gt;Result&lt;/div&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;ol&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; i = <span class="nu0">0</span>
 <br> &nbsp; &nbsp; <span class="kw1">ForAll</span> curV <span class="kw1">In</span> db. <span class="me1">Views</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Set</span> v = curV 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">Not</span> v. <span class="me1">Isfolder</span><span class="kw1">Then</span><span class="co1">'No point updating folders</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'This is just for the Show</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;li&gt;&lt;a href="|</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span><span class="kw1">IsArray</span><span class="br0">(</span>v. <span class="me1">Aliases</span><span class="br0">)</span><span class="kw1">then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">If</span> v. <span class="me1">Aliases</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span> &lt;&gt; <span class="st0">""</span><span class="kw1">Then</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curVurl = url + v. <span class="me1">Aliases</span><span class="br0">(</span><span class="nu0">0</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curVurl = url + v. <span class="kw1">Name</span>&nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Else</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; curVurl = url + v. <span class="kw1">Name</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span>curVurl <span class="br0">)</span> &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|?Open"&gt;|</span>+v. <span class="kw1">Name</span>+ <span class="st0">|&lt;/a&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;/li&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'This is the real work</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">Call</span> script. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|views[|</span>+ <span class="kw1">CStr</span><span class="br0">(</span>i <span class="br0">)</span>+ <span class="st0">|] = "|</span>+curVurl+ <span class="st0">|";|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="co1">'Increment</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; i = i + <span class="nu0">1</span>
 <br> &nbsp; &nbsp; &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">If</span>
 <br> &nbsp; &nbsp; <span class="kw1">End</span><span class="kw1">ForAll</span>
 <br>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> script. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|callAllViews(0)|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> script. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;/script&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; <span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|&lt;/ol&gt;|</span>,EOL_PLATFORM <span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br> &nbsp; &nbsp; <span class="co1">'Now write out</span>
 <br> &nbsp; &nbsp; out. <span class="me1">Position</span> = <span class="nu0">0</span>
 <br> &nbsp; &nbsp; <span class="kw1">Print</span> out. <span class="me1">Readtext</span><span class="br0">(</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; script. <span class="me1">Position</span> = <span class="nu0">0</span>
 <br> &nbsp; &nbsp; <span class="kw1">Print</span> script. <span class="me1">Readtext</span><span class="br0">(</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br><span class="kw1">End</span><span class="kw1">Sub</span>
 <br>
 <br>
 <br><span class="coMULTI">%REM<br> &nbsp; &nbsp; Sub addJSFunctions<br> &nbsp; &nbsp; Description: Adds all the JavaScript needed<br> %END REM</span>
 <br><span class="kw1">Sub</span> addJSFunctions <span class="br0">(</span>out <span class="kw1">As</span><span class="kw2">NotesStream</span><span class="br0">)</span>
 <br> &nbsp; &nbsp; 
 <br><span class="kw1">Call</span> out. <span class="me1">Writetext</span><span class="br0">(</span><span class="st0">|<br> &nbsp; &nbsp; var views = [];<br> &nbsp; &nbsp; function callAllViews(curIndex) {<br> &nbsp; &nbsp; &nbsp; &nbsp; var r = createRequest();<br> &nbsp; &nbsp; &nbsp; &nbsp; r.open("GET",views[curIndex],false);<br> &nbsp; &nbsp; &nbsp; &nbsp; r.send(null);<br> &nbsp; &nbsp; &nbsp; &nbsp; var resultEle = document.getElementsByTagName("LI"); <br> &nbsp; &nbsp; &nbsp; &nbsp; resultEle[curIndex].innerHTML += " - done";<br> &nbsp; &nbsp; &nbsp; &nbsp; curIndex++;<br> &nbsp; &nbsp; &nbsp; &nbsp; if (curIndex &lt; views.length) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; window.setTimeout(callAllViews(curIndex),10000);<br> &nbsp; &nbsp; &nbsp; &nbsp; } else {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; // Here would be a check if that thing needs to run again<br> &nbsp; &nbsp; &nbsp; &nbsp; }<br> &nbsp; &nbsp; }<br> <br> &nbsp; &nbsp; function createRequest() {<br> &nbsp; &nbsp; &nbsp; &nbsp; var request;<br> &nbsp; &nbsp; &nbsp; &nbsp; try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request = new XMLHttpRequest();<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (trymicrosoft) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request = new ActiveXObject("Msxml2.XMLHTTP");<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (othermicrosoft) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; try {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request = new ActiveXObject("Microsoft.XMLHTTP");<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; } catch (failed) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; request = false;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }<br> <br> &nbsp; &nbsp; &nbsp; &nbsp; if (!request) {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; alert("Error initializing XMLHttpRequest!");<br> &nbsp; &nbsp; &nbsp; &nbsp; }<br> <br> &nbsp; &nbsp; &nbsp; &nbsp; return request;<br> &nbsp; &nbsp; <br> &nbsp; &nbsp; }<br> <br> |</span>,EOL_PLATFORM <span class="br0">)</span>
 <br><span class="kw1">End</span><span class="kw1">Sub</span>
</div></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 23 November 2010
<span class="divider">|</span>
<a href="/blog/2010/11/update-all-views-in-a-database-web-style.html#comments">Comments (1)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2010/11/update-all-views-in-a-database-web-style.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_279FAF00A229AB7B4825771C0011B4E3" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_279FAF00A229AB7B4825771C0011B4E3"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Erik Brooks</b> on <i>Wednesday 24 November 2010 AD</i>:<br /> 
  Wow, this kinda stinks. Is there an SPR open for this? It seems like this should be fixed, or at least turned into an INI setting, e.g. UPDATE_UPDATE_HIDDEN_VIEWS=1 
  <br /> 
  <br />
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/11/firefox-takes-a-page-from-the-notes-ui.html"><i class="icon-hand-left"></i>Firefox takes a page from the Notes UI</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/12/loading-html-or-xml-content-in-lotusscript-over-http.html">Loading HTML or XML Content in LotusScript over HTTP<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/11/">November</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/showntellthursday.html">Show-N-Tell Thursday</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8585SX" title="originally published at /blog/d6plinks/SHWL-8585SX">SHWL-8585SX</a>
	</li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
						<li><a href="https://www.stickermule.com/unlock?ref_id=7600480701&utm_medium=link&utm_source=invite">Stickers by Stickermule</a></li>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2022 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2010/11/update-all-views-in-a-database-web-style.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "279FAF00A229AB7B4825771C0011B4E3");
 		};
	</script>

</body>
</html>
