<!DOCTYPE html>
<html lang="en">
<head>
<title>XPages and Form Fomulas - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - XPages and Form Fomulas" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2010/04/xpages-and-form-fomulas.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - XPages and Form Fomulas" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="XPages and Form Fomulas - One of the unique features in Notes and Domino are form formulas. On a view you can specify a formula that alters the form used to show a form. This is very handy to show the same document reformatted for different stake holders, so they can focus on what is important to them Form formulas are a tri" />
<meta name="Keywords"
	content="XPages," />
<meta name="Abstract"
	content="XPages and Form Fomulas - One of the unique features in Notes and Domino are form formulas. On a view you can specify a formula that alters the form used to show a form. This is very handy to show the same document reformatted for different stake holders, so they can focus on what is important to them Form formulas are a tri" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <script> 
var $buoop = {notify:{e:-0.01,f:-0.01,o:-0.01,s:-0.01,c:-0.01},insecure:true,unsupported:true,api:5}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.min.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script>

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/04/">April</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/04/i-love-hotel-wifi.html"><i class="icon-hand-left"></i>I love Hotel WIFI</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/04/communicating-with-ibmers-and-lotus-professionals-using-sametime.html">Communicating with IBMers and Lotus professionals using Sametime<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>XPages and Form Fomulas</small></h1>
					<hr />
					<div>One of the unique features in Notes and Domino are form formulas. On a view you can specify a formula that alters the form used to show a form. This is very handy to show the same document reformatted for different stake holders, so they can focus on what is important to them 
<br> 
<img src="/blog/images/2010/formformula.png" border="0" alt="Form Formulas in Notes Views"> 
<br> Form formulas are a tried and tested solution. So I was wondering what happens when you bring XPages into the mix.In the propeller head properties of a form a developer can specify that an XPage should be opened instead of the form itself. One can specify an XPage for web access and/or client access. So I created and empty form and specified to use XPages instead. 
<br> 
<img src="/blog/images/2010/usexpageinstead.png" border="0" alt="Advanced Form Properties"> 
<br> It turns out that both the Notes client and the classic web views honor the form formula. So you have a new tool for upgrading existing applications and complex forms. If there is a subset a specific group needs to use you can XPage enable the form based on conditions in the document by providing a form formula and an empty form linked to an XPage. Unfortunately the form formula is ignored when you use a view control inside an XPage. Here you need to determine the Page to use in JavaScript. That's a little more complex but also way more flexible. To compute the page name on a per document basis you need to specify a row variable. 
<br> 
<img src="/blog/images/2010/rowVariable.png" border="0" alt="The row variable for a view control"> The variable is hidden in the All Properties panel. For every row of the view the variable will hold an instance of <code>NotesXspViewEntry</code>. You can either use <code>.getColumnValue("columnname")</code> to get a specific column value or <code>.getDocument()</code> to get to the NotesDocument object. You then can use <a href="http://www.google.com/images?q=Barney">your imagination</a> what to compute. Change forms based on workflow status, authenticated user etc. A formula could look like this: 
<div class="javascript"> 
 <ol> 
  <li class="li1"> 
   <div class="de1"> <span class="kw2">var</span> curTaste <span class="sy0">=</span> myRow. <span class="me1">getColumnValue</span> <span class="br0">(</span> <span class="st0">"Taste"</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1"> <span class="kw1">return</span> <span class="br0">(</span>curTaste <span class="sy0">==</span> <span class="st0">"Sweet"</span> <span class="br0">)</span> <span class="sy0">?</span> <span class="st0">"FruitWithSugarWarning.xsp"</span> <span class="sy0">:</span> <span class="st0">"Fruit.xsp"</span> <span class="sy0">;</span> 
   </div></li> 
 </ol> 
</div> What you can't do: open a classic form using this approach. But nothing stops you to add a column where you point to a document in a view in the form database.nsf/viewname/key_or_unid and then the form formula will work. 
<br> As usual: YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 15 April 2010
<span class="divider">|</span>
<a href="/blog/2010/04/xpages-and-form-fomulas.html#comments">Comments (6)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/xpages.html">XPages</a> 

						<div class="shariff" data-lang="en" data-url="https://www.wissel.net/blog/2010/04/xpages-and-form-fomulas.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]" data-title="XPages and Form Fomulas" data-twitter-via="@notessensei"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2010/04/xpages-and-form-fomulas.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_EFED830CAD96B6FA482577060064283B" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_EFED830CAD96B6FA482577060064283B"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Wayne Allen</b> on <i>Wednesday 22 December 2010 AD</i>:<br /> 
  Stephan, 
  <br /> 
  <br />In a similar vein, I have an XPage where several controls use the same server side Javascript to determine whether or not they are visible. I would like to write the routine once (presumably as a Javascript function) then call it from a number of different places on the XPage. Where should I put my Javascript function so that I can call it from the multiple &quot;Visible&quot; properties? 
  <br /> 
  <br />Cheers, 
  <br />Wayne
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Wednesday 22 December 2010 AD</i>:<br /> 
  @Wayne: Into a SSJS script library.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>bobb</b> on <i>Saturday 17 September 2011 AD</i>:<br /> 
  I don't understand where I should put myRow? Where I define this value and how?
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Sunday 18 September 2011 AD</i>:<br /> 
  @Bobb: read carefully: 
  <br />&quot;To compute the page name on a per document basis you need to specify a row variable. The variable is hidden in the All Properties panel&quot; 
  <br />.. and look at the picture. There is a red box that highlights the property you need to fill in. You define the value by typing it in. 
  <br />The big step: The name of the property that defines the row variable is &quot;var&quot;. The value of of the property &quot;var&quot; is the name you can use to deal with the current row of data.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>David Newman</b> on <i>Wednesday 01 May 2013 AD</i>:<br /> 
  I am using a xpages shell application to read and write to a completely different database. The view in the xpages app points to the correct document but I get an error when trying to open the doc even though I have created an xpage with the data componet set to that document/form. So I have an xpage for the form formula name but it won't open. thoughts?
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H Wissel </b> on <i>Wednesday 01 May 2013 AD</i>:<br /> 
  David, 
  <br />post that question on Stackoverflow including the full source and the exact error. 
  <br />I would in any case code the XPages name in SSJS when an external nsf is used
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/04/i-love-hotel-wifi.html"><i class="icon-hand-left"></i>I love Hotel WIFI</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/04/communicating-with-ibmers-and-lotus-professionals-using-sametime.html">Communicating with IBMers and Lotus professionals using Sametime<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/04/">April</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2020 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2010/04/xpages-and-form-fomulas.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
    <script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "EFED830CAD96B6FA482577060064283B");
 		};
	</script>

</body>
</html>
