<!DOCTYPE html>
<html lang="en">
<head>
<title>Rendering ODF documents in your XPages - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Rendering ODF documents in your XPages" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2010/01/rendering-odf-documents-in-your-xpages.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Rendering ODF documents in your XPages" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2022 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Rendering ODF documents in your XPages - In Tim&#39;s and my Lotusphere session AD111 we rendered data from an XPage into a ODT document. Once you get the hang of it and it is easy to implement export to text, spreadsheet or presentations. One nice aspect: no server side OpenOffice or Symphony code is needed. Here is how you do it: In DDE use " />
<meta name="Keywords"
	content="XPages," />
<meta name="Abstract"
	content="Rendering ODF documents in your XPages - In Tim&#39;s and my Lotusphere session AD111 we rendered data from an XPage into a ODT document. Once you get the hang of it and it is easy to implement export to text, spreadsheet or presentations. One nice aspect: no server side OpenOffice or Symphony code is needed. Here is how you do it: In DDE use " />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/prism.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body class="line-numbers">
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

     
    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8248MT" title="originally published at /blog/d6plinks/SHWL-8248MT">SHWL-8248MT</a>
	</li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/01/peek-a-boo-into-the-xpages-classes.html"><i class="icon-hand-left"></i>Peek-a-boo into the XPages classes</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/01/netgear-support-hell-reloaded.html">Netgear support hell reloaded<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Rendering ODF documents in your XPages</small></h1>
					<hr />
					<div>In <a href="http://www.timtripcony.com/">Tim's</a> and my Lotusphere session AD111 we rendered data from an XPage into a ODT document. Once you get the hang of it and it is easy to implement export to text, spreadsheet or presentations. One nice aspect: no server side OpenOffice or Symphony code is needed. Here is how you do it: 
<ol>
 <li>In DDE use <u>W</u>indow, Show Eclipse Views, Other (Alt+Shift+Q Q) and select "Navigator"</li>
 <li>Locate the WebContent/WEB-INF folder and add 2 directories: <b>src</b> and <b>lib</b></li>
 <li>Download the Java toolkit from <a href="http://odftoolkit.org/">ODF Toolkit</a> and add odfdom.jar to your <i>WebContent/WEB-INF/lib</i> directory</li>
 <li>Right click on your NSF and select Project Properties. Then select Java Build Path. In the source tab add the src folder you created in step 2. In the Libraries tab add the odfdom.jar you copied in step 3</li>
 <li>Create the class you want to use for rendering the content (rendering logic goes there). It should have a method that takes an OutputStream as parameter (I called it render)</li>
 <li>Optional: define your new class to be a managed bean. Once you do that it can be used as if it is a native global variable. To do this locate the faces-config.xml in the WEB-INF directory and add a bean definition. Could look like this:<br><code></code>
  <pre><code>&lt;faces-config&gt;
  &lt;managed-bean&gt;
    &lt;managed-bean-name&gt;stuff&lt;/managed-bean-name&gt;
    &lt;managed-bean-class&gt;com.lotusphere2010.ad111.Sample&lt;/managed-bean-class&gt;
    &lt;managed-bean-scope&gt;session&lt;/managed-bean-scope&gt;
  &lt;/managed-bean&gt;
&lt;faces-config&gt;
</code></pre></li>
 <li>Create a new XPage, go to the page properties, basics and set rendered=false. You can see in the XSP source<br><code>&lt;xp:view xmlns:xp="http://www.ibm.com/xsp/core" rendered="<b>false</b>"&gt;</code></li>
 <li>Add code (see below) in the beforeRenderResponse event. It is important to use this event, so you can get hand on the OutputStream rather than the writer</li>
 <li>The ODFToolkit requires one additional setting for security, so locate [NotesInstallDir]/jvm/lib/security/java.policy file (you need to do that on the server too) and add:<br><code> grant { permission java.lang.RuntimePermission "shutdownHooks"; }; </code></li>
 <li>You are all set. Enjoy. As usual YMMV</li>
</ol>The SSJS code to use in the beforeRenderResponse event would look like this: 
<br><code> <font color="#3f7f5f">//&nbsp;Get&nbsp;the&nbsp;output&nbsp;stream</font><br><font color="#000000">var&nbsp;exCon&nbsp;=&nbsp;facesContext.getExternalContext</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#000000">var&nbsp;response&nbsp;=&nbsp;exCon.getResponse</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#000000">var&nbsp;out&nbsp;=&nbsp;response.getOutputStream</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff"></font><br><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">out==</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">print</font><font color="#000000">(</font><font color="#2a00ff">"The&nbsp;freakn'&nbsp;stream&nbsp;isn't&nbsp;there"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">print</font><font color="#000000">(</font><font color="#2a00ff">"All&nbsp;good&nbsp;with&nbsp;the&nbsp;stream"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#000000">}</font><br><font color="#ffffff"></font><br><font color="#3f7f5f">//&nbsp;Set&nbsp;the&nbsp;MIME&nbsp;Type&nbsp;to&nbsp;ODF&nbsp;=&nbsp;application/x-vnd.oasis.opendocument.text</font><br><font color="#000000">response.setContentType</font><font color="#000000">(</font><font color="#2a00ff">"application/x-vnd.oasis.opendocument.text"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#000000">response.setHeader</font><font color="#000000">(</font><font color="#2a00ff">"Content-disposition"</font><font color="#000000">,</font><font color="#2a00ff">"attachment;&nbsp;filename=sample.odt"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#000000">response.setHeader</font><font color="#000000">(</font><font color="#2a00ff">"Cache-Control"</font><font color="#000000">,&nbsp;</font><font color="#2a00ff">"no-cache"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff"></font><br><font color="#3f7f5f">//&nbsp;Here&nbsp;would&nbsp;be&nbsp;the&nbsp;business&nbsp;logic&nbsp;adding&nbsp;to&nbsp;stuff</font><br><font color="#ffffff"></font><br><font color="#3f7f5f">//Get&nbsp;the&nbsp;document&nbsp;out&nbsp;to&nbsp;the&nbsp;screen</font><br><font color="#000000">stuff.render</font><font color="#000000">(</font><font color="#000000">out</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff"></font><br><font color="#3f7f5f">//&nbsp;Stop&nbsp;the&nbsp;page&nbsp;from&nbsp;further&nbsp;processing;</font><br><font color="#000000">facesContext.responseComplete</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#000000">out.close</font><font color="#000000">()</font><font color="#000000">;</font></code>
<br>
<br>
A sample class writing out a text document would look like this: 
<br><code> <font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">com.lotusphere2010.ad111;</font><br><font color="#ffffff"></font><br><font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.File;</font><br><font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.FileOutputStream;</font><br><font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.IOException;</font><br><font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.OutputStream;</font><br><font color="#ffffff"></font><br><font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.odftoolkit.odfdom.doc.OdfTextDocument;</font><br><font color="#ffffff"></font><br><font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">Sample&nbsp;</font><font color="#000000">{</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Creates&nbsp;the&nbsp;unavoidable&nbsp;HelloWorld&nbsp;application</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;data</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">args</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">IOException&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">main</font><font color="#000000">(</font><font color="#000000">String</font><font color="#000000">[]&nbsp;</font><font color="#000000">args</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">IOException&nbsp;</font><font color="#000000">{</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">File&nbsp;resultFile&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">File</font><font color="#000000">(</font><font color="#2a00ff">"result.odt"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">resultFile.exists</font><font color="#000000">())&nbsp;{</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">resultFile.delete</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">FileOutputStream&nbsp;out&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">FileOutputStream</font><font color="#000000">(</font><font color="#000000">resultFile</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">Sample&nbsp;sample&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">Sample</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">sample.render</font><font color="#000000">(</font><font color="#000000">out</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">out.close</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"Done!"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">}</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Write&nbsp;the&nbsp;completed&nbsp;doc&nbsp;out&nbsp;into&nbsp;the&nbsp;output&nbsp;stream</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">out</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;stream&nbsp;to&nbsp;write&nbsp;to</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">render</font><font color="#000000">(</font><font color="#000000">OutputStream&nbsp;out</font><font color="#000000">)&nbsp;{</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;We&nbsp;create&nbsp;the&nbsp;document&nbsp;into&nbsp;the&nbsp;stream</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">OdfTextDocument&nbsp;odfDoc;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">odfDoc&nbsp;=&nbsp;OdfTextDocument.newTextDocument</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">odfDoc.addText</font><font color="#000000">(</font><font color="#2a00ff">"Hello&nbsp;World"</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Now&nbsp;we&nbsp;render&nbsp;it&nbsp;out</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">odfDoc.save</font><font color="#000000">(</font><font color="#000000">out</font><font color="#000000">)</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Don't&nbsp;do&nbsp;that&nbsp;in&nbsp;production&nbsp;quality&nbsp;code!</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">e.printStackTrace</font><font color="#000000">()</font><font color="#000000">;</font><br><font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;</font><font color="#000000">}</font><br><font color="#ffffff"></font><br><font color="#ffffff">&nbsp;&nbsp;</font><br><font color="#000000">}</font></code>
<br><b>Update</b>: Other posts on rendering your own output in XPages: 
<ul>
 <li><a href="/blog/2010/12/rendering-your-own-output-in-xpages-revisited.html" title="Rendering your own output in XPages revisited">Rendering your own output in XPages revisited</a></li>
 <li><a href="/blog/2008/12/xagents-web-agents-xpages-style.html" title="Web Agents XPages style">Web Agents XPages style</a></li>
</ul></div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 27 January 2010
<span class="divider">|</span>
<a href="/blog/2010/01/rendering-odf-documents-in-your-xpages.html#comments">Comments (2)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/xpages.html">XPages</a> 

						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2010/01/rendering-odf-documents-in-your-xpages.html";
						</script>
					</p>
				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_0837C7E9F6146ACB482576B8001F0467" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_0837C7E9F6146ACB482576B8001F0467"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Karsten Lehmann</b> on <i>Wednesday 27 January 2010 AD</i>:<br /> 
  Changing the java.policy on the user's workstation is *BAD*. 
  <img alt="Emoticon smile.gif" src="/blog/images/emoticons/smile.gif" border="0" /> 
  <br />Will this work in 8.5.2 without changing this file? I heard they were working on the security mapping between Java and the Notes Client's ECL system.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Raphael Costa</b> on <i>Tuesday 22 June 2010 AD</i>:<br /> 
  Great article! 
  <br />But, I couldn't put this to work. 
  <br />I follow every step, but end up with a message: 
  <br /> HTTP JVM: All good with the stream 
  <br />21/06/2010 20:20:55 HTTP JVM: SEVERE: Could not find resource: /OdfTextDocument.odt 
  <br />21/06/2010 20:20:55 HTTP JVM: java.lang.NullPointerException 
  <br />21/06/2010 20:20:55 HTTP JVM: at org.odftoolkit.odfdom.doc.OdfDocument.loadTemplate(OdfDocument.java:287) 
  <br />21/06/2010 20:20:55 HTTP JVM: at org.odftoolkit.odfdom.doc.OdfTextDocument.newTextDocument(OdfTextDocument.java:99) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.petrobras.odf.TesteODF.render(TesteODF.java:45) 
  <br />21/06/2010 20:20:55 HTTP JVM: at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
  <br />21/06/2010 20:20:55 HTTP JVM: at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) 
  <br />21/06/2010 20:20:55 HTTP JVM: at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37) 
  <br />21/06/2010 20:20:55 HTTP JVM: at java.lang.reflect.Method.invoke(Method.java:599) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.types.JavaAccessObject.call(JavaAccessObject.java:309) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.types.FBSObject.call(FBSObject.java:153) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.ASTTree.ASTCall.interpret(ASTCall.java:171) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.ASTTree.ASTProgram.interpretEx(ASTProgram.java:102) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression._interpretExpression(JSExpression.java:438) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression.access$1(JSExpression.java:427) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression$2.run(JSExpression.java:417) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression$2.run(JSExpression.java) 
  <br />21/06/2010 20:20:55 HTTP JVM: at java.security.AccessController.doPrivileged(AccessController.java:284) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression.interpretExpression(JSExpression.java:415) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression.evaluateValue(JSExpression.java:250) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.jscript.JSExpression.evaluateValue(JSExpression.java:233) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.javascript.JavaScriptInterpreter.interpret(JavaScriptInterpreter.java:193) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.binding.javascript.JavaScriptMethodBinding.invoke(JavaScriptMethodBinding.java:111) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.component.UIViewRootEx.invokePhaseMethodBinding(UIViewRootEx.java:1419) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.controller.FacesControllerImpl.invokePhaseMethodBinding(FacesControllerImpl.java:440) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.controller.FacesControllerImpl.access$0(FacesControllerImpl.java:431) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.controller.FacesControllerImpl$ViewPhaseListener.beforePhase(FacesControllerImpl.java:492) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.sun.faces.lifecycle.LifecycleImpl.phase(LifecycleImpl.java:172) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:120) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.controller.FacesControllerImpl.render(FacesControllerImpl.java:257) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.webapp.FacesServlet.serviceView(FacesServlet.java:198) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.webapp.FacesServletEx.serviceView(FacesServletEx.java:187) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.webapp.FacesServlet.service(FacesServlet.java:138) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.webapp.FacesServletEx.service(FacesServletEx.java:131) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.xsp.webapp.DesignerFacesServlet.service(DesignerFacesServlet.java:85) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.ComponentModule.invokeServlet(ComponentModule.java:464) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.domino.xsp.module.nsf.NSFComponentModule.invokeServlet(NSFComponentModule.java:673) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.ComponentModule$AdapterInvoker.invokeServlet(ComponentModule.java:730) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.ComponentModule$ServletInvoker.doService(ComponentModule.java:684) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.ComponentModule.doService(ComponentModule.java:453) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.domino.xsp.module.nsf.NSFComponentModule.doService(NSFComponentModule.java:657) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.domino.xsp.module.nsf.NSFService.doService(NSFService.java:254) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.LCDEnvironment.doService(LCDEnvironment.java:259) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.designer.runtime.domino.adapter.LCDEnvironment.service(LCDEnvironment.java:216) 
  <br />21/06/2010 20:20:55 HTTP JVM: at com.ibm.domino.xsp.bridge.http.engine.XspCmdManager.service(XspCmdManager.java:279) 
  <br /> 
  <br />Seems like my code cant reach the resources inside the .jar 
  <br />Do you have any idea to solve this?
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/01/peek-a-boo-into-the-xpages-classes.html"><i class="icon-hand-left"></i>Peek-a-boo into the XPages classes</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/01/netgear-support-hell-reloaded.html">Netgear support hell reloaded<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/01/">January</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
	<li class="pull-right">
	<span class="divider">|</span><a href="/blog/d6plinks/SHWL-8248MT" title="originally published at /blog/d6plinks/SHWL-8248MT">SHWL-8248MT</a>
	</li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmer">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a rel="me" href="https://chaos.social/@stw">Chat on Mastodon</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://notessensei.myspreadshop.com">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="https://www.stickermule.com/u/43c09fe6343315f">Stickers from Stickermule</a></li>
						<li><a href="https://github.com/Stwissel">GitHub</a></li>
						<li><a href="https://bitbucket.org/stwissel/">Bitbucket</a></li>
						<li><a href="https://bsky.app/profile/stwissel.bsky.social">Bluesky</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2025 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2010/01/rendering-odf-documents-in-your-xpages.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-3.6.0.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/prism.js"></script>
	<script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "0837C7E9F6146ACB482576B8001F0467");
 		};
	</script>

</body>
</html>
