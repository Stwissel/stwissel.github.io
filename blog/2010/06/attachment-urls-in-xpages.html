<!DOCTYPE html>
<html lang="en">
<head>
<title>Attachment URLs in XPages - NotesSensei's Blog</title>
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-72033-1', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible"  content="chrome=1" />
<meta http-equiv="Content-Language" content="en" />
<meta rel="meta" link="application/rdf+xml" content="/foaf.rdf" />
<meta property="og:title"     content="wissel.net - Attachment URLs in XPages" />
<meta property="og:type"      content="blog" />
<meta property="og:url"       content="https://wissel.net/blog/2010/06/attachment-urls-in-xpages.html" />
<meta property="og:image"     content="//www.wissel.net/blog/img/wisselnet.gif" />
<meta property="og:site_name" content="wissel.net" />
<meta name="viewport"         content="width=device-width, initial-scale=1.0" />
<meta name="ROBOTS"           content="FOLLOW, NOIMAGEINDEX" />
<meta name="DC.Title"         content="NotesSensei's Weblog - Attachment URLs in XPages" />
<meta name="Author"           content="Stephan H. Wissel" />
<meta name="ICBM"             content="1.2994, 103.8425" />
<meta name="Copyright"        content="2002,2020 Stephan H. Wissel - Creative commons licence" />
<meta name="twitter:site"     content="@notessensei" />
<meta name="twitter:card"     content="summary" />
<meta name="xing:author"      content="https://www.xing.com/profile/StephanH_Wissel" />
<meta name="description"
	content="Attachment URLs in XPages - In classic Domino applications directly addressing attachments is well known and simple. Your URL has the format: http(s)://[yourserver]/[application.nsf]/[viewname|0]/[UNID| ViewKey]/$File/[AttachmentName]?Open While this will continue to work on the Domino server for the forseeable future you want" />
<meta name="Keywords"
	content="XPages," />
<meta name="Abstract"
	content="Attachment URLs in XPages - In classic Domino applications directly addressing attachments is well known and simple. Your URL has the format: http(s)://[yourserver]/[application.nsf]/[viewname|0]/[UNID| ViewKey]/$File/[AttachmentName]?Open While this will continue to work on the Domino server for the forseeable future you want" />
<!--[if lt IE 9]>
		<script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<link rel="stylesheet" type="text/css" href="/blog/style/bootstrap.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/responsive.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/wisselblog.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/main.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shCore.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shThemeMidnight.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/blogcodedisplay.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/shariff.complete.css" />
<link rel="stylesheet" type="text/css" href="/blog/style/markdown.css" />
<link rel="stylesheet" type="text/css" href="/blog/css/admonition.css" />
<link href='//fonts.googleapis.com/css?family=Montserrat' rel='stylesheet' type='text/css' />
<link href='//fonts.googleapis.com/css?family=Ubuntu:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css' />
<link rel="icon" type="image/png" href="/blog/img/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/blog/img/favicon-16x16.png" sizes="16x16" />


<link rel="alternate" type="application/rss+xml" title="RSS News Feed" href="https://feeds.feedburner.com/Wisselnetfeed" />

<meta name="Revisit-After" content="90 Days" />
</head>
<body>
	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<a class="btn btn-navbar" data-toggle="collapse"
				data-target=".nav-collapse"> <span class="icon-bar"></span> <span
				class="icon-bar"></span> <span class="icon-bar"></span>
			</a> <a class="brand" href="/">wissel.net</a>
			<div class="nav-collapse">
				<ul class="nav">
					<li><a href="/index.html">Home</a></li>
					<li class="active"><a href="/blog/">Blog</a></li>
					<li><a href="/blog/series.html">Series</a></li>
					<li><a href="/blog/downloads/">Downloads</a></li>
					<li><a href="https://stwissel.github.io/presentations/" title="Presentations maintained on GitHub">Presentations</a></li>
					<li><a href="/blog/imprint.html">About / Imprint</a></li>
				</ul>
				<form action="//www.google.com/cse" id="cse-search-box"
					class="navbar-search pull-right">
					<div>
						<input type="hidden" name="cx"
							value="partner-pub-4562257798204150:muo14ionenw" /> <input
							type="hidden" name="ie" value="ISO-8859-1" /> <input type="text"
							name="q" class="search-query span2" placeholder="Search" />
						<!-- input type="submit" name="sa" value="Search" class="btn btn-small"/-->
					</div>
				</form>
			</div>
		</div>
	</div>
<div class="navbar-spacer"></div>

	<div class="container">
    		<br />
		<header>
			<div id="mainsmall"  class="hero-unit">
				<h2>wissel.net</h2>
				<p>Usability - Productivity - Business - The web - Singapore &amp; Twins</p>
			</div>
		</header>

    <script> 
var $buoop = {notify:{e:-0.01,f:-0.01,o:-0.01,s:-0.01,c:-0.01},insecure:true,unsupported:true,api:5}; 
function $buo_f(){ 
 var e = document.createElement("script"); 
 e.src = "//browser-update.org/update.min.js"; 
 document.body.appendChild(e);
};
try {document.addEventListener("DOMContentLoaded", $buo_f,false)}
catch(e){window.attachEvent("onload", $buo_f)}
</script>

    <ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/06/">June</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

		<div class="row-fluid">
			<div class="span12">
				
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/06/virtues-of-document-databases.html"><i class="icon-hand-left"></i>Virtues of Document Databases</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/06/theres-a-storm-coming-harry.html">There&apos;s a storm coming, Harry<i class="icon-hand-right"></i></a>
					</li>
				</ul>

				<article class="well well-raised">
					<h1><small>Attachment URLs in XPages</small></h1>
					<hr />
					<div>In classic Domino applications directly addressing attachments is well known and simple. Your URL has the format: 
<br> <code>http(s)://[yourserver]/[application.nsf]/[viewname|0]/[UNID| ViewKey]/$File/[AttachmentName]?Open</code> 
<br> While this will continue to work on the Domino server for the forseeable future you want to learn about the XPages syntax. The very obvious reason: the classic Domino URL doesn't work in the Notes client (XPiNC) and you want to make your applications work cross-platform don't you? Also we don't know what additional options handling attachments via XPages might bring in the future. the syntax is a litte more complex.: 
<br> <code>http(s)://[yourserver]/[application.nsf]<b> /xsp/.ibmmodres/domino/OpenAttachment/ [application.nsf]</b>/[UNID|/$File/[AttachmentName]?Open</code> 
<br> A few remarks: 
<ul> 
 <li>The URL contains the application location twice. From my tests it looks like the <code>/__[ReplicaID].nsf/</code> doesn't work for here. I haven't tested what happens when you specify 2 different applications in the front and the back</li> 
 <li>Since there is no view involved in the URL addressing attachments using an attachment key won't work. You have to use the UNID. This requires extra care when you build applications where the attachment URL is supposed to be shared (like send in a chat or an eMail). Deleting a document and recreating with an updated attachment will alter the URL. So ou want to cater for that case with a specific XPage rather than a raw URL.</li> 
 <li>When you attachment is stored inside a RT field (e.g. using the upload control where you target a field) you can replace "/$File/" with the field name e.g. "/Body/"</li> 
</ul> To make my life easier I use 2 functions so I get an attachment URL with a single call:<div class="javascript"> 
 <ol> 
  <li class="li1"> 
   <div class="de1"> <span class="kw2">function</span> getAttachmentURL <span class="br0">(</span>docID <span class="sy0">:</span>java. <span class="me1">lang</span>. <span class="me1">String</span> <span class="sy0">,</span> attachmentName <span class="sy0">:</span>java. <span class="me1">lang</span>. <span class="me1">String</span> <span class="br0">)</span> <span class="br0">{</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> base <span class="sy0">=</span> getBaseURL <span class="br0">(</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> middle <span class="sy0">=</span> <span class="st0">"/xsp/.ibmmodres/domino/OpenAttachment"</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw1">if</span> <span class="br0">(</span>base. <span class="me1">substr</span> <span class="br0">(</span> <span class="nu0">0</span> <span class="sy0">,</span> <span class="nu0">4</span> <span class="br0">)</span> <span class="sy0">==</span> <span class="st0">"/xsp"</span> <span class="br0">)</span> <span class="br0">{</span> 
   </div></li> 
  <li class="li2"> 
   <div class="de2">
     &nbsp; &nbsp; &nbsp; &nbsp; middle <span class="sy0">+=</span> base. <span class="me1">substr</span> <span class="br0">(</span> <span class="nu0">4</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="br0">}</span> <span class="kw1">else</span> <span class="br0">{</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; &nbsp; &nbsp; middle <span class="sy0">+=</span> base <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="br0">}</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> result <span class="sy0">=</span> base <span class="sy0">+</span> middle <span class="sy0">+</span> <span class="st0">"/"</span> <span class="sy0">+</span> docID <span class="sy0">+</span> <span class="st0">"/$File/"</span> <span class="sy0">+</span> attachmentName <span class="sy0">+</span> <span class="st0">"?Open"</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li2"> 
   <div class="de2">
     &nbsp; &nbsp; <span class="kw1">return</span> result <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1"> <span class="br0">}</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; 
   </div></li> 
  <li class="li1"> 
   <div class="de1"> <span class="kw2">function</span> getBaseURL <span class="br0">(</span> <span class="br0">)</span> <span class="br0">{</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> curURL <span class="sy0">=</span> context. <span class="me1">getUrl</span> <span class="br0">(</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li2"> 
   <div class="de2">
     &nbsp; &nbsp; <span class="kw2">var</span> curAdr <span class="sy0">=</span> curURL. <span class="me1">getAddress</span> <span class="br0">(</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> rel <span class="sy0">=</span> curURL. <span class="me1">getSiteRelativeAddress</span> <span class="br0">(</span>context <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> step1 <span class="sy0">=</span> curAdr. <span class="me1">substr</span> <span class="br0">(</span> <span class="nu0">0</span> <span class="sy0">,</span>curAdr. <span class="me1">indexOf</span> <span class="br0">(</span>rel <span class="br0">)</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="co1">// Now cut off the http</span> 
   </div></li> 
  <li class="li2"> 
   <div class="de2">
     &nbsp; &nbsp; <span class="kw2">var</span> step2 <span class="sy0">=</span> step1. <span class="me1">substr</span> <span class="br0">(</span>step1. <span class="me1">indexOf</span> <span class="br0">(</span> <span class="st0">"//"</span> <span class="br0">)</span> <span class="sy0">+</span> <span class="nu0">2</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw2">var</span> result <span class="sy0">=</span> step2. <span class="me1">substr</span> <span class="br0">(</span>step2. <span class="me1">indexOf</span> <span class="br0">(</span> <span class="st0">"/"</span> <span class="br0">)</span> <span class="br0">)</span> <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="kw1">return</span> result <span class="sy0">;</span> 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; 
   </div></li> 
  <li class="li1"> 
   <div class="de1">
     &nbsp; &nbsp; <span class="br0">}</span> 
   </div></li> 
 </ol> 
</div> As usual YMMV</div>
					<hr />
					<p>
						Posted by <a rel="author" href="https://plus.google.com/u/0/+StephanWissel">
Stephan H Wissel</a> on 24 June 2010
<span class="divider">|</span>
<a href="/blog/2010/06/attachment-urls-in-xpages.html#comments">Comments (1a)</a>
<span class="divider">|</span>
categories:  <a href="/blog/categories/xpages.html">XPages</a> 

						<div class="shariff" data-lang="en" data-url="https://www.wissel.net/blog/2010/06/attachment-urls-in-xpages.html" data-services="[&quot;whatsapp&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;mail&quot;]" data-title="Attachment URLs in XPages" data-twitter-via="@notessensei"></div>
						<script type="text/javascript">
							var permaLink = "https://wissel.net/blog/2010/06/attachment-urls-in-xpages.html";
						</script>
					</p>

				</article>
				<a name="comments"></a>
				<div class="well well-raised" style="text-align : center">
				<button class="btn btn-lg btn-info" data-toggle="collapse" data-target="#commentform_9E354123ED1CC0214825774C0052B430" type="button">
		            Add your comment...&nbsp;&nbsp;<span class="glyphicon glyphicon-comment"></span>
	            </button>
	            </div>
				<div id="commentform_9E354123ED1CC0214825774C0052B430"  class="collapse"></div>
				<div class="well well-raised">
					<h4>Comments</h4>
					<ol id="commentList">
						<li>
							posted by <b>Peter Presnell</b> on <i>Friday 25 June 2010 AD</i>:<br /> 
  Thx for taking the time to point this out Stephan. I don't recall my XPage Kindergarten teacher ever covering this!
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Glen Mitchell</b> on <i>Saturday 26 June 2010 AD</i>:<br /> 
  That's cool, if only there was a way to get the Notes client to open a file automatically, rather than only asking to save it.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Fredrik Sj??str??m</b> on <i>Saturday 26 June 2010 AD</i>:<br /> 
  Great post, Stephan!
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Mark Leusink</b> on <i>Monday 30 August 2010 AD</i>:<br /> 
  Note that with the XPage syntax for attachments, the server adds a Content-Disposition header that will force the browser to offer the user the choice of directly opening or saving the attachment. 
  <br /> 
  <br />In the classic format the server doesn't add the header which causes the attachment to be &quot;launched&quot;: if you have Adobe Reader installed and click a link to a PDF, the PDF will be shown directly in the browser window (in IE) 
  <br /> 
  <br />I wonder if it's possible to override this behaviour in the new syntax. Perhaps by adding an extra parameter? 
  <br /> 
  <br />Mark
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>ljubisa</b> on <i>Wednesday 15 February 2012 AD</i>:<br /> 
  Excuse me for this dumb question, but how do i make use of this in my project?
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Wednesday 15 February 2012 AD</i>:<br /> 
  Stuff it into a SSJS lib and call it from your XPage where you e.g. use a view or a repeat control to compute the content. Like this: 
  <div class="xml"> 
   <span class="sc3"><span class="re1">&lt;?xml</span> <span class="re0">version</span>=<span class="st0">&quot;1.0&quot;</span> <span class="re0">encoding</span>=<span class="st0">&quot;UTF-8&quot;</span><span class="re2">?&gt;</span></span> 
   <br /> 
   <span class="sc3"><span class="re1">&lt;xp:view</span> <span class="re0">xmlns:xp</span>=<span class="st0">&quot;http://www.ibm.com/xsp/core&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:this.resources<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:script</span> <span class="re0">src</span>=<span class="st0">&quot;/AttachmentTools.jss&quot;</span> <span class="re0">clientSide</span>=<span class="st0">&quot;false&quot;</span><span class="re2">&gt;</span><span class="re1">&lt;/xp:script<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:this.resources<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:viewPanel</span> <span class="re0">rows</span>=<span class="st0">&quot;30&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;viewPanel1&quot;</span> <span class="re0">viewStyle</span>=<span class="st0">&quot;width:40.0%&quot;</span></span> 
   <br /> 
   <span class="sc3">&nbsp; &nbsp; &nbsp; &nbsp; <span class="re0">var</span>=<span class="st0">&quot;curRow&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:this.facets<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:pager</span> <span class="re0">partialRefresh</span>=<span class="st0">&quot;true&quot;</span> <span class="re0">layout</span>=<span class="st0">&quot;Previous Group Next&quot;</span></span> 
   <br /> 
   <span class="sc3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="re0">xp:key</span>=<span class="st0">&quot;headerPager&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;pager1&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:pager<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:this.facets<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:this.data<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:dominoView</span> <span class="re0">var</span>=<span class="st0">&quot;view1&quot;</span> <span class="re0">viewName</span>=<span class="st0">&quot;withAttachments&quot;</span><span class="re2">&gt;</span><span class="re1">&lt;/xp:dominoView<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:this.data<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:viewColumn</span> <span class="re0">columnName</span>=<span class="st0">&quot;$120&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;viewColumn1&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:viewColumnHeader</span> <span class="re0">value</span>=<span class="st0">&quot;Topic&quot;</span> <span class="re0">id</span>=<span class="st0">&quot;viewColumnHeader1&quot;</span><span class="re2">&gt;</span><span class="re1">&lt;/xp:viewColumnHeader<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:viewColumn<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:viewColumn</span> <span class="re0">id</span>=<span class="st0">&quot;viewColumn2&quot;</span> <span class="re0">contentType</span>=<span class="st0">&quot;HTML&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:this.facets<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:viewColumnHeader</span> <span class="re0">xp:key</span>=<span class="st0">&quot;header&quot;</span></span> 
   <br /> 
   <span class="sc3">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="re0">id</span>=<span class="st0">&quot;viewColumnHeader2&quot;</span> <span class="re0">value</span>=<span class="st0">&quot;Attachments&quot;</span><span class="re2">&gt;</span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:viewColumnHeader<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:this.facets<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; &nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;xp:this.value<span class="re2">&gt;</span></span></span> 
   <span class="sc2">&lt;![CDATA[#{javascript:var id:string = curRow.getUniversalID();</span> 
   <br /> 
   <span class="sc2">var attNames = curRow.getColumnValue(&quot;AttachmentNames&quot;);</span> 
   <br /> 
   <span class="sc2">var u = getAttachmentURL(id,attNames);</span> 
   <br /> 
   <span class="sc2">return &quot;&lt;a href=\&quot;&quot;+u+&quot;\&quot;&gt;&quot;+attNames+&quot;&lt;/a&gt;&quot;}]]&gt;</span> 
   <span class="sc3"><span class="re1">&lt;/xp:this.value<span class="re2">&gt;</span></span><span class="re1">&lt;/xp:viewColumn<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; &nbsp; 
   <span class="sc3"><span class="re1">&lt;/xp:viewPanel<span class="re2">&gt;</span></span></span> 
   <br /> 
   <span class="sc3"><span class="re1">&lt;/xp:view<span class="re2">&gt;</span></span></span> 
   <br />&nbsp; 
  </div> You need to tweak the function if you expect more than one attachment in a document. The trick is the column &quot;AttachmentNames&quot; in the view is computed as 
  <code>@AttachmentNames</code>
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>ljubisa</b> on <i>Thursday 16 February 2012 AD</i>:<br /> 
  Why, thank you good sir! :)
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Ian</b> on <i>Monday 26 March 2012 AD</i>:<br /> 
  Many thanks.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Randal Oulton</b> on <i>Tuesday 04 September 2012 AD</i>:<br /> 
  Geez, they couldn't if they'd tried have picked a syntax that Google's gonna hate more for page ranking scores, could they? I suppose they didn't even *think* of that.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Tuesday 04 September 2012 AD</i>:<br /> 
  @Randal: the web sites configuration documents are your friends. You can mask the URL to something leaner easily 
  <br /> 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Frank van der Linden</b> on <i>Friday 21 September 2012 AD</i>:<br /> 
  Thanks for the functions. Saves me lots of time. 
  <br />I transformed the SSJS functions to Java methods in my JSFUtil class, so I can use it in my beans to calculate the attachment url's
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Ryan Buening</b> on <i>Friday 02 November 2012 AD</i>:<br /> 
  Thanks for this, Stephan.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Arne Menting</b> on <i>Friday 09 November 2012 AD</i>:<br /> 
  Thanks, that nudged me in the right direction. If you want to open an attachment in another database you should pay attention which database is which, and that you can be local, and have to specify the current app as the starting point: 
  <br /> 
  <br />http(s)://127.0.0.1:[theRandomXPINCPort]/xsp/[currentServer]!![yourCurrentApplication.nsf] /xsp/.ibmmodres/domino/OpenAttachment/[yourTargetServer]!![yourTargetapplication.nsf]/[UNID]/$File/[AttachmentName]?Open
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Randal Oulton</b> on <i>Friday 30 November 2012 AD</i>:<br /> 
  &quot;@Randal: the web sites configuration documents are your friends. You can mask the URL to something leaner easily&quot; 
  <br /> 
  <br />Oh I get that, believe me I know substitutions and redirections up the whazoo and all their failings. I'm just saying, someone at the very start shoulda thunk and went, this is so not gonna fly with anyone who cares about SEO (which would be everyone lol.) 
  <br /> 
  <br />SEO and look is what people care about now on websites, SEO and look. If you can't sell that, you ain't gonna be programing a website in *any* language.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Rakesh Lakshmanan</b> on <i>Thursday 17 January 2013 AD</i>:<br /> 
  Hi, 
  <br /> 
  <br />I have tried the above method its opening the attachment URL but its not prompting for the attachment download.I am using IE8.I enabled alllow the pop-up still not working 
  <img alt="Emoticon sad.gif" src="/blog/images/emoticons/sad.gif" border="0" /> .. any idea why its not working..??
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Thursday 17 January 2013 AD</i>:<br /> 
  @Rakesh, 
  <br />post that question on stackoverflow, include your sample. Test with wget or curl to exclude a network issue. Make sure that you state the error message you get. If the download contol works, this works in all cases when done correctly.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Rakesh Lakshmanan</b> on <i>Friday 18 January 2013 AD</i>:<br /> 
  @Stephan, 
  <br />Thanks for the reply.my code sample is: 
  <br /> 
  <b>view.postScript(&quot;window.open('http://localhost/learning.nsf/0/&quot;+ID+&quot;/$FILE/export&quot;+sessID+&quot;.xls')&quot;);</b> 
  <br /> 
  <br />link generated : 
  <b>http://localhost/learning.nsf/3acc399c5fa49b8065257ae300646bc2/73c6511b3295fb0365257af60047977b/$FILE/exportDDIT2L2F58.xls</b> 
  <br /> 
  <br />I can download the attachment from notes client not from browser..
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Friday 18 January 2013 AD</i>:<br /> 
  @Rakesh: This is not Stackoverflow. Also who produces popups, distributes popups or makes popups available to others shall be punished with the requirement to code for IE6 in HTML5. 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" /> 
  <br /> 
  <br />1) Do not use popups, don't, never!! 
  <br />2) Do not use popups, don't, never!! 
  <br /> 
  <br />In case you ignore 1 or 2, the popup blocker will teach you. 
  <br /> 
  <br />Also the link generated can't be from your formula since it doesn't contain the /0/ and it isn't XPages related - see article.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>andy</b> on <i>Thursday 31 January 2013 AD</i>:<br /> 
  I've got it to work when I hard code the UNID, but I don't know how to get the UNID in a Repeat Control? My Collection name is: reportData. 
  <br /> 
  <br />How to I get the backend doc unid where the attachment is saved? 
  <br /> 
  <br />I'm using a link to launch my attachment with this client side javascript: 
  <br /> 
  <br />return location.href = url; 
  <br /> 
  <br />Please help! 
  <br /> 
  <br />p.s I hate XPages 
  <br /> 
  <br />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Stephan H. Wissel</b> on <i>Thursday 31 January 2013 AD</i>:<br /> 
  @Andy: there are nice books about PHP, go and have fun. Just explain the logic to me: you have a problem with a technology, failed to RTFM to find the getUniversalId() function, state that you hate the technology and still expect an expert (who probably became an expert since he likes the technology) to bail you out? 
  <br /> 
  <img alt="Emoticon angry.gif" src="/blog/images/emoticons/angry.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>andy</b> on <i>Friday 01 February 2013 AD</i>:<br /> 
  I have a repeat control that displays response documents. That's working. There is one attachment per response document that has been created by an agent. There's no file upload control involved. I want to display a link called 'Open' for each response, and I want to give users the option of opening/saving the attachment when they click on it. 
  <br /> 
  <br />I got this working by hard coding a UNID in the Client side OnClick event of the link Control. 
  <br /> 
  <br />var url = &quot;{ 
  <a href="https://nicor6.nicor.org.uk/ADONALD/AdHocReports.nsf/xsp/.ibmmodres/domino/OpenAttachment/ADONALD/AdHocReports.nsf/5C9B006D4B9BAEB980257AFD0059F57C/$File/buttons.jpg?Open" ;"="" rel="nofollow" target="blank">Link</a> } 
  <br />return location.href = url; 
  <br /> 
  <br />I have the above urls in a column in a view, but I just can't get it to work? I doubt getUniversalId() works in client side? 
  <img alt="Emoticon huh.gif" src="/blog/images/emoticons/huh.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>andy</b> on <i>Friday 01 February 2013 AD</i>:<br /> 
  I have a repeat control that displays response documents. That's working. There is one attachment per response document that has been created by an agent. There's no file upload control involved. I want to display a link called 'Open' for each response, and I want to give users the option of opening/saving the attachment when they click on it.&lt;br /&gt;&lt;br /&gt;I got this working by hard coding a UNID in the Client side OnClick event of the link Control.&lt;br /&gt;&lt;br /&gt;var url = &quot;{ &lt;a href=&quot;{ 
  <a href="https://nicor6.nicor.org.uk/ADONALD/AdHocReports.nsf/xsp/.ibmmodres/domino/OpenAttachment/ADONALD/AdHocReports.nsf/5C9B006D4B9BAEB980257AFD0059F57C/$File/buttons.jpg?Open" ;""="" rel="nofollow" target="blank">Link</a> } rel=&quot;nofollow&quot; target =&quot;blank&quot;&gt;Link&lt;/a&gt; }&lt;br /&gt;return location.href = url;&lt;br /&gt;&lt;br /&gt;I have the above urls in a column in a view, but I just can't get it to work? I doubt getUniversalId() works in client side? 
  <img alt="Emoticon huh.gif" src="/blog/images/emoticons/huh.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Jairo</b> on <i>Thursday 11 July 2013 AD</i>:<br /> 
  found this very short code to get the same link for the attachment: 
  <br /> 
  <br />doc.getAttachmentList(&quot;fieldName&quot;).get(0).getHref() 
  <br /> 
  <br />doc : NotesDocument 
  <br />&quot;fieldName&quot; : field name 
  <br /> 
  <br />this is from 
  <br />{ 
  <a href="http://stackoverflow.com/questions/9291779/getting-attachments-from-document" rel="nofollow" target="blank">Link</a> } , answer by Grant Lindsay 
  <br />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Bill Fox</b> on <i>Saturday 27 September 2014 AD</i>:<br /> 
  I have a situation where the database where the code is run from is different than the database where the data resides. In your example I believe the first reference is to the DB where the code is run and the second refers to the database where the data resides. I copied the link for the save and it looks like this: 
  <br />{ 
  <a href="http://192.168.2.251/Client%20Apps/LGI/XPages/LGIApprovalMaster.nsf/xsp/.ibmmodres/domino/OpenAttachment/Client%20Apps/LGI/XPages/LGIContracts-Leases.nsf/212802D96DAB345987257D5B00523922/Attachments/GST%20Calculation.ods" rel="nofollow" target="blank">Link</a> } 
  <br /> 
  <br />So I suspect that I will need to modify your code to cover where the code and the data reside in different DBs. I have not got this working yet but believe that is why the database is stated twice.
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>alan harris</b> on <i>Wednesday 14 October 2015 AD</i>:<br /> 
  truly exceptional. no need for the dumba$$ download control EVER again. 
  <img alt="Emoticon biggrin.gif" src="/blog/images/emoticons/biggrin.gif" border="0" />
 
							<hr style="clear : both" />
						</li> 						<li>
							posted by <b>Patrick Kwinten</b> on <i>Tuesday 06 September 2016 AD</i>:<br /> 
  how do calculate the path in java classes?
 
							<hr style="clear : both" />
						</li> 					</ol>
				</div>
				<ul class="breadcrumb pull-centre">
					<li><a href="/blog/2010/06/virtues-of-document-databases.html"><i class="icon-hand-left"></i>Virtues of Document Databases</a>
						<span class="divider">|</span></li>
					<li><a href="/blog/"><i class="icon-hand-up"></i>Main</a></li>
					<span class="divider">|</span>
					<li><a href="/blog/2010/06/theres-a-storm-coming-harry.html">There&apos;s a storm coming, Harry<i class="icon-hand-right"></i></a>
					</li>
				</ul>

			</div>
		</div>
		<ul class="breadcrumb">
  <li><a href="/blog/">Blog</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/">2010</a> <span class="divider">/</span></li>
  <li><a href="/blog/2010/06/">June</a></li>
  <li class="pull-right">
    <span class="divider">|</span><a href="/blog/categories/xpages.html">XPages</a>
  </li>
</ul>

	</div>
	<footer>
		<div class="container">
			<div class="row">
				<div class="span2">
					<h4>About Me</h4>
					<p>
						I work as "Solution Director Innovation" for HCL Software. I'm based in Singapore.
						<g:plusone size="small" href="https://wissel.net/blog/"></g:plusone>
					</p>
					<a href="//stackoverflow.com/users/131021/stwissel">
					<img src="//stackoverflow.com/users/flair/131021.png" width="208" height="58" alt="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers" title="profile for stwissel at Stack Overflow, Q&amp;A for professional and enthusiast programmers">
				</a>
				</div>
				<div class="span2">
					<h4>Contact</h4>
					<ul>
						<li><a href="https://www.twitter.com/notessensei">Twitter</a></li>
						<li><a href="https://sg.linkedin.com/in/notessensei">LinkedIn</a></li>
						<li><a href="https://www.xing.com/profile/StephanH_Wissel">XING</a></li>
						<li><a href="https://astore.amazon.com/wissenetblog-20">Amazon Store</a></li>
						<li><a href="https://kindle.amazon.com/profile/Stephan-H--Wissel/1659300">Amazon Kindle</a></li>
						<li><a href="http://notessensei.spreadshirt.com/">NotesSensei's Spreadshirt shop</a></li>
						<li><a href="http://about.me/stephan.wissel/#" title="Another identity site, nothing much here">About Me</a></li>
					</ul>
				</div>
				<div class="span8">
					<h4>Disclaimer</h4>
					<p>This site is in no way affiliated, endorsed, sanctioned,
						supported, nor enlightened by my current or previous employers.
						I may be an employee, but the opinions, theories, facts, etc.
						presented here are my own and are in now way given in any official
						capacity. In short, these are my words and this is my site, not
						my current or former employers' - and don't even begin to think otherwise.</p>
					<p>
						<b>&copy; 2003 - 2021 Stephan H. Wissel - some rights reserved</b> as
						listed here: <a rel="license"
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"><img
							alt="Creative Commons License" style="border-width: 0"
							src="//licensebuttons.net/l/by-nc-sa/3.0/88x31.png" /></a>
						Unless otherwise labeled by its originating author, the content
						found on this site is made available under the terms of an <a
							href="//creativecommons.org/licenses/by-nc-sa/3.0/"
							target="_blank"
							title="Learn more about the creative commons  Attribution-ShareAlike License">Attribution/NonCommercial/ShareAlike
							Creative Commons License</a>, with the exception that no rights are
						granted -- since they are not mine to grant -- in any logo,
						graphic design, trademarks or trade names of any type. Code
						samples and code downloads on this site are, unless otherwise
						labeled, made available under an <a
							href="//www.apache.org/licenses/LICENSE-2.0.html">Apache
							2.0</a> license. Other license models are available on written
						request and written confirmation.
					</p>
				</div>
			</div>
		</div>
	</footer>

	<script type="text/javascript">
		var permaLink = "https://wissel.net/blog/2010/06/attachment-urls-in-xpages.html";
	</script>
		<script type="text/javascript" src="/blog/js/jquery-1.8.2.min.js"></script>
	<script type="text/javascript" src="/blog/js/shariff.min.js"></script>
	<script type="text/javascript" src="/blog/js/bootstrap.js"></script>
	<script type="text/javascript" src="/blog/js/blogmain.js"></script>
    <script type="text/javascript" src="/blog/js2/shCore.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJava.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushJScript.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushXml.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushBash.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushPlain.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushVb.js"></script>
    <script type="text/javascript" src="/blog/js2/shBrushCss.js"></script>
    <script type="text/javascript" src="/blog/js2/admonition.js"></script>
	<script src="//www.google-analytics.com/urchin.js" type="text/javascript"></script>
	<script type="text/javascript">
		_uacct = "UA-72033-1";
		urchinTracker();
	</script>
	<script type="text/javascript" src="//feeds.feedburner.com/~s/Wisselnet?i=https://wissel.net/blog" charset="utf-8"></script>
    <script type="text/javascript">
    $(document).ready(function() {
            SyntaxHighlighter.all();
    });
    </script>

		<script src="/blog/js2/mustache.js"></script>
	<script src="/blog/js2/blogcomments.js"></script>
	<script type="text/javascript" src="/blog/js2/Markdown.Converter.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="/blog/js2/Markdown.Editor.js"></script>
	<script type="text/javascript" src="//www.google.com/recaptcha/api.js"></script>
	<script src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&render=explicit" async defer></script>
	<script type="text/javascript">
		var onloadCallback = function() {
    		renderComment("6LcBxUEUAAAAACzKM8YKb-RVVaIZ3MN6F1Z8FB_4", "9E354123ED1CC0214825774C0052B430");
 		};
	</script>

</body>
</html>
